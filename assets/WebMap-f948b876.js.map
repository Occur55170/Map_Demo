{"version":3,"file":"WebMap-f948b876.js","sources":["../../node_modules/ol/Overlay.js","../../node_modules/ol/source/Cluster.js","../../node_modules/ol/source/OSM.js","../../node_modules/html-to-image/es/util.js","../../node_modules/html-to-image/es/clone-pseudos.js","../../node_modules/html-to-image/es/mimes.js","../../node_modules/html-to-image/es/dataurl.js","../../node_modules/html-to-image/es/clone-node.js","../../node_modules/html-to-image/es/embed-resources.js","../../node_modules/html-to-image/es/embed-images.js","../../node_modules/html-to-image/es/apply-style.js","../../node_modules/html-to-image/es/embed-webfonts.js","../../node_modules/html-to-image/es/index.js","../../src/assets/img/icon/currentPosition.svg","../../src/components/AreaImg.vue","../../src/assets/img/icon/vector.svg","../../src/components/AreaData.vue","../../src/assets/logo.svg","../../src/assets/img/icon/2D-m.svg","../../src/assets/img/icon/3D-m.svg","../../src/assets/img/icon/vector-m.svg","../../src/assets/img/icon/selectVector-m.svg","../../src/assets/img/icon/singleWindow-m.svg","../../src/assets/img/icon/doubleWindow-m.svg","../../src/components/MNavbar.vue","../../src/assets/img/icon/lockOpen.svg","../../src/assets/img/icon/deleteLayer.svg","../../src/assets/img/icon/arrow_up.svg","../../src/assets/img/icon/arrow_down.svg","../../src/assets/img/icon/eyes.svg","../../src/components/LayerSelector.vue","../../src/components/OverLayer.vue","../../src/components/Condition.vue","../../src/assets/img/icon/2D.svg","../../src/assets/img/icon/3D.svg","../../src/assets/img/icon/baseLayer.svg","../../src/assets/img/icon/singleWindow.svg","../../src/assets/img/icon/doubleWindows.svg","../../src/components/SearchBar.vue","../../src/components/MapSourceOption.vue","../../src/assets/img/icon/zoomIn.svg","../../src/assets/img/icon/zoomOut.svg","../../src/assets/img/icon/compass.svg","../../src/assets/img/icon/location.svg","../../src/assets/img/icon/zoom.svg","../../src/components/AsideTool.vue","../../node_modules/ol/interaction/Select.js","../../node_modules/ol/control/ScaleLine.js","../../node_modules/olcs/AutoRenderLoop.js","../../node_modules/olcs/math.js","../../node_modules/olcs/Camera.js","../../node_modules/olcs/AbstractSynchronizer.js","../../node_modules/olcs/RasterSynchronizer.js","../../node_modules/olcs/core/VectorLayerCounterpart.js","../../node_modules/olcs/FeatureConverter.js","../../node_modules/olcs/VectorSynchronizer.js","../../node_modules/olcs/SynchronizedOverlay.js","../../node_modules/olcs/OverlaySynchronizer.js","../../node_modules/olcs/OLCesium.js","../../src/view/WebMap.vue"],"sourcesContent":["/**\n * @module ol/Overlay\n */\nimport BaseObject from './Object.js';\nimport MapEventType from './MapEventType.js';\nimport {CLASS_SELECTABLE} from './css.js';\nimport {containsExtent} from './extent.js';\nimport {listen, unlistenByKey} from './events.js';\nimport {outerHeight, outerWidth, removeChildren, removeNode} from './dom.js';\n\n/**\n * @typedef {'bottom-left' | 'bottom-center' | 'bottom-right' | 'center-left' | 'center-center' | 'center-right' | 'top-left' | 'top-center' | 'top-right'} Positioning\n * The overlay position: `'bottom-left'`, `'bottom-center'`,  `'bottom-right'`,\n * `'center-left'`, `'center-center'`, `'center-right'`, `'top-left'`,\n * `'top-center'`, or `'top-right'`.\n */\n\n/**\n * @typedef {Object} Options\n * @property {number|string} [id] Set the overlay id. The overlay id can be used\n * with the {@link module:ol/Map~Map#getOverlayById} method.\n * @property {HTMLElement} [element] The overlay element.\n * @property {Array<number>} [offset=[0, 0]] Offsets in pixels used when positioning\n * the overlay. The first element in the\n * array is the horizontal offset. A positive value shifts the overlay right.\n * The second element in the array is the vertical offset. A positive value\n * shifts the overlay down.\n * @property {import(\"./coordinate.js\").Coordinate} [position] The overlay position\n * in map projection.\n * @property {Positioning} [positioning='top-left'] Defines how\n * the overlay is actually positioned with respect to its `position` property.\n * Possible values are `'bottom-left'`, `'bottom-center'`, `'bottom-right'`,\n * `'center-left'`, `'center-center'`, `'center-right'`, `'top-left'`,\n * `'top-center'`, and `'top-right'`.\n * @property {boolean} [stopEvent=true] Whether event propagation to the map\n * viewport should be stopped. If `true` the overlay is placed in the same\n * container as that of the controls (CSS class name\n * `ol-overlaycontainer-stopevent`); if `false` it is placed in the container\n * with CSS class name specified by the `className` property.\n * @property {boolean} [insertFirst=true] Whether the overlay is inserted first\n * in the overlay container, or appended. If the overlay is placed in the same\n * container as that of the controls (see the `stopEvent` option) you will\n * probably set `insertFirst` to `true` so the overlay is displayed below the\n * controls.\n * @property {PanIntoViewOptions|boolean} [autoPan=false] Pan the map when calling\n * `setPosition`, so that the overlay is entirely visible in the current viewport.\n * @property {string} [className='ol-overlay-container ol-selectable'] CSS class\n * name.\n */\n\n/**\n * @typedef {Object} PanOptions\n * @property {number} [duration=1000] The duration of the animation in\n * milliseconds.\n * @property {function(number):number} [easing] The easing function to use. Can\n * be one from {@link module:ol/easing} or a custom function.\n * Default is {@link module:ol/easing.inAndOut}.\n */\n\n/**\n * @typedef {Object} PanIntoViewOptions\n * @property {PanOptions} [animation={}] The animation parameters for the pan\n * @property {number} [margin=20] The margin (in pixels) between the\n * overlay and the borders of the map when panning into view.\n */\n\n/**\n * @enum {string}\n * @protected\n */\nconst Property = {\n  ELEMENT: 'element',\n  MAP: 'map',\n  OFFSET: 'offset',\n  POSITION: 'position',\n  POSITIONING: 'positioning',\n};\n\n/**\n * @typedef {import(\"./ObjectEventType\").Types|'change:element'|'change:map'|'change:offset'|'change:position'|\n *   'change:positioning'} OverlayObjectEventTypes\n */\n\n/***\n * @template Return\n * @typedef {import(\"./Observable\").OnSignature<import(\"./Observable\").EventTypes, import(\"./events/Event.js\").default, Return> &\n *   import(\"./Observable\").OnSignature<OverlayObjectEventTypes, import(\"./Object\").ObjectEvent, Return> &\n *   import(\"./Observable\").CombinedOnSignature<import(\"./Observable\").EventTypes|OverlayObjectEventTypes, Return>} OverlayOnSignature\n */\n\n/**\n * @classdesc\n * An element to be displayed over the map and attached to a single map\n * location.  Like {@link module:ol/control/Control~Control}, Overlays are\n * visible widgets. Unlike Controls, they are not in a fixed position on the\n * screen, but are tied to a geographical coordinate, so panning the map will\n * move an Overlay but not a Control.\n *\n * Example:\n *\n *     import Overlay from 'ol/Overlay.js';\n *\n *     // ...\n *     const popup = new Overlay({\n *       element: document.getElementById('popup'),\n *     });\n *     popup.setPosition(coordinate);\n *     map.addOverlay(popup);\n *\n * @api\n */\nclass Overlay extends BaseObject {\n  /**\n   * @param {Options} options Overlay options.\n   */\n  constructor(options) {\n    super();\n\n    /***\n     * @type {OverlayOnSignature<import(\"./events\").EventsKey>}\n     */\n    this.on;\n\n    /***\n     * @type {OverlayOnSignature<import(\"./events\").EventsKey>}\n     */\n    this.once;\n\n    /***\n     * @type {OverlayOnSignature<void>}\n     */\n    this.un;\n\n    /**\n     * @protected\n     * @type {Options}\n     */\n    this.options = options;\n\n    /**\n     * @protected\n     * @type {number|string|undefined}\n     */\n    this.id = options.id;\n\n    /**\n     * @protected\n     * @type {boolean}\n     */\n    this.insertFirst =\n      options.insertFirst !== undefined ? options.insertFirst : true;\n\n    /**\n     * @protected\n     * @type {boolean}\n     */\n    this.stopEvent = options.stopEvent !== undefined ? options.stopEvent : true;\n\n    /**\n     * @protected\n     * @type {HTMLElement}\n     */\n    this.element = document.createElement('div');\n    this.element.className =\n      options.className !== undefined\n        ? options.className\n        : 'ol-overlay-container ' + CLASS_SELECTABLE;\n    this.element.style.position = 'absolute';\n    this.element.style.pointerEvents = 'auto';\n\n    /**\n     * @protected\n     * @type {PanIntoViewOptions|undefined}\n     */\n    this.autoPan = options.autoPan === true ? {} : options.autoPan || undefined;\n\n    /**\n     * @protected\n     * @type {{transform_: string,\n     *         visible: boolean}}\n     */\n    this.rendered = {\n      transform_: '',\n      visible: true,\n    };\n\n    /**\n     * @protected\n     * @type {?import(\"./events.js\").EventsKey}\n     */\n    this.mapPostrenderListenerKey = null;\n\n    this.addChangeListener(Property.ELEMENT, this.handleElementChanged);\n    this.addChangeListener(Property.MAP, this.handleMapChanged);\n    this.addChangeListener(Property.OFFSET, this.handleOffsetChanged);\n    this.addChangeListener(Property.POSITION, this.handlePositionChanged);\n    this.addChangeListener(Property.POSITIONING, this.handlePositioningChanged);\n\n    if (options.element !== undefined) {\n      this.setElement(options.element);\n    }\n\n    this.setOffset(options.offset !== undefined ? options.offset : [0, 0]);\n\n    this.setPositioning(options.positioning || 'top-left');\n\n    if (options.position !== undefined) {\n      this.setPosition(options.position);\n    }\n  }\n\n  /**\n   * Get the DOM element of this overlay.\n   * @return {HTMLElement|undefined} The Element containing the overlay.\n   * @observable\n   * @api\n   */\n  getElement() {\n    return /** @type {HTMLElement|undefined} */ (this.get(Property.ELEMENT));\n  }\n\n  /**\n   * Get the overlay identifier which is set on constructor.\n   * @return {number|string|undefined} Id.\n   * @api\n   */\n  getId() {\n    return this.id;\n  }\n\n  /**\n   * Get the map associated with this overlay.\n   * @return {import(\"./Map.js\").default|null} The map that the\n   * overlay is part of.\n   * @observable\n   * @api\n   */\n  getMap() {\n    return /** @type {import(\"./Map.js\").default|null} */ (\n      this.get(Property.MAP) || null\n    );\n  }\n\n  /**\n   * Get the offset of this overlay.\n   * @return {Array<number>} The offset.\n   * @observable\n   * @api\n   */\n  getOffset() {\n    return /** @type {Array<number>} */ (this.get(Property.OFFSET));\n  }\n\n  /**\n   * Get the current position of this overlay.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} The spatial point that the overlay is\n   *     anchored at.\n   * @observable\n   * @api\n   */\n  getPosition() {\n    return /** @type {import(\"./coordinate.js\").Coordinate|undefined} */ (\n      this.get(Property.POSITION)\n    );\n  }\n\n  /**\n   * Get the current positioning of this overlay.\n   * @return {Positioning} How the overlay is positioned\n   *     relative to its point on the map.\n   * @observable\n   * @api\n   */\n  getPositioning() {\n    return /** @type {Positioning} */ (this.get(Property.POSITIONING));\n  }\n\n  /**\n   * @protected\n   */\n  handleElementChanged() {\n    removeChildren(this.element);\n    const element = this.getElement();\n    if (element) {\n      this.element.appendChild(element);\n    }\n  }\n\n  /**\n   * @protected\n   */\n  handleMapChanged() {\n    if (this.mapPostrenderListenerKey) {\n      removeNode(this.element);\n      unlistenByKey(this.mapPostrenderListenerKey);\n      this.mapPostrenderListenerKey = null;\n    }\n    const map = this.getMap();\n    if (map) {\n      this.mapPostrenderListenerKey = listen(\n        map,\n        MapEventType.POSTRENDER,\n        this.render,\n        this\n      );\n      this.updatePixelPosition();\n      const container = this.stopEvent\n        ? map.getOverlayContainerStopEvent()\n        : map.getOverlayContainer();\n      if (this.insertFirst) {\n        container.insertBefore(this.element, container.childNodes[0] || null);\n      } else {\n        container.appendChild(this.element);\n      }\n      this.performAutoPan();\n    }\n  }\n\n  /**\n   * @protected\n   */\n  render() {\n    this.updatePixelPosition();\n  }\n\n  /**\n   * @protected\n   */\n  handleOffsetChanged() {\n    this.updatePixelPosition();\n  }\n\n  /**\n   * @protected\n   */\n  handlePositionChanged() {\n    this.updatePixelPosition();\n    this.performAutoPan();\n  }\n\n  /**\n   * @protected\n   */\n  handlePositioningChanged() {\n    this.updatePixelPosition();\n  }\n\n  /**\n   * Set the DOM element to be associated with this overlay.\n   * @param {HTMLElement|undefined} element The Element containing the overlay.\n   * @observable\n   * @api\n   */\n  setElement(element) {\n    this.set(Property.ELEMENT, element);\n  }\n\n  /**\n   * Set the map to be associated with this overlay.\n   * @param {import(\"./Map.js\").default|null} map The map that the\n   * overlay is part of. Pass `null` to just remove the overlay from the current map.\n   * @observable\n   * @api\n   */\n  setMap(map) {\n    this.set(Property.MAP, map);\n  }\n\n  /**\n   * Set the offset for this overlay.\n   * @param {Array<number>} offset Offset.\n   * @observable\n   * @api\n   */\n  setOffset(offset) {\n    this.set(Property.OFFSET, offset);\n  }\n\n  /**\n   * Set the position for this overlay. If the position is `undefined` the\n   * overlay is hidden.\n   * @param {import(\"./coordinate.js\").Coordinate|undefined} position The spatial point that the overlay\n   *     is anchored at.\n   * @observable\n   * @api\n   */\n  setPosition(position) {\n    this.set(Property.POSITION, position);\n  }\n\n  /**\n   * Pan the map so that the overlay is entirely visible in the current viewport\n   * (if necessary) using the configured autoPan parameters\n   * @protected\n   */\n  performAutoPan() {\n    if (this.autoPan) {\n      this.panIntoView(this.autoPan);\n    }\n  }\n\n  /**\n   * Pan the map so that the overlay is entirely visible in the current viewport\n   * (if necessary).\n   * @param {PanIntoViewOptions} [panIntoViewOptions] Options for the pan action\n   * @api\n   */\n  panIntoView(panIntoViewOptions) {\n    const map = this.getMap();\n\n    if (!map || !map.getTargetElement() || !this.get(Property.POSITION)) {\n      return;\n    }\n\n    const mapRect = this.getRect(map.getTargetElement(), map.getSize());\n    const element = this.getElement();\n    const overlayRect = this.getRect(element, [\n      outerWidth(element),\n      outerHeight(element),\n    ]);\n\n    panIntoViewOptions = panIntoViewOptions || {};\n\n    const myMargin =\n      panIntoViewOptions.margin === undefined ? 20 : panIntoViewOptions.margin;\n    if (!containsExtent(mapRect, overlayRect)) {\n      // the overlay is not completely inside the viewport, so pan the map\n      const offsetLeft = overlayRect[0] - mapRect[0];\n      const offsetRight = mapRect[2] - overlayRect[2];\n      const offsetTop = overlayRect[1] - mapRect[1];\n      const offsetBottom = mapRect[3] - overlayRect[3];\n\n      const delta = [0, 0];\n      if (offsetLeft < 0) {\n        // move map to the left\n        delta[0] = offsetLeft - myMargin;\n      } else if (offsetRight < 0) {\n        // move map to the right\n        delta[0] = Math.abs(offsetRight) + myMargin;\n      }\n      if (offsetTop < 0) {\n        // move map up\n        delta[1] = offsetTop - myMargin;\n      } else if (offsetBottom < 0) {\n        // move map down\n        delta[1] = Math.abs(offsetBottom) + myMargin;\n      }\n\n      if (delta[0] !== 0 || delta[1] !== 0) {\n        const center = /** @type {import(\"./coordinate.js\").Coordinate} */ (\n          map.getView().getCenterInternal()\n        );\n        const centerPx = map.getPixelFromCoordinateInternal(center);\n        if (!centerPx) {\n          return;\n        }\n        const newCenterPx = [centerPx[0] + delta[0], centerPx[1] + delta[1]];\n\n        const panOptions = panIntoViewOptions.animation || {};\n        map.getView().animateInternal({\n          center: map.getCoordinateFromPixelInternal(newCenterPx),\n          duration: panOptions.duration,\n          easing: panOptions.easing,\n        });\n      }\n    }\n  }\n\n  /**\n   * Get the extent of an element relative to the document\n   * @param {HTMLElement} element The element.\n   * @param {import(\"./size.js\").Size} size The size of the element.\n   * @return {import(\"./extent.js\").Extent} The extent.\n   * @protected\n   */\n  getRect(element, size) {\n    const box = element.getBoundingClientRect();\n    const offsetX = box.left + window.pageXOffset;\n    const offsetY = box.top + window.pageYOffset;\n    return [offsetX, offsetY, offsetX + size[0], offsetY + size[1]];\n  }\n\n  /**\n   * Set the positioning for this overlay.\n   * @param {Positioning} positioning how the overlay is\n   *     positioned relative to its point on the map.\n   * @observable\n   * @api\n   */\n  setPositioning(positioning) {\n    this.set(Property.POSITIONING, positioning);\n  }\n\n  /**\n   * Modify the visibility of the element.\n   * @param {boolean} visible Element visibility.\n   * @protected\n   */\n  setVisible(visible) {\n    if (this.rendered.visible !== visible) {\n      this.element.style.display = visible ? '' : 'none';\n      this.rendered.visible = visible;\n    }\n  }\n\n  /**\n   * Update pixel position.\n   * @protected\n   */\n  updatePixelPosition() {\n    const map = this.getMap();\n    const position = this.getPosition();\n    if (!map || !map.isRendered() || !position) {\n      this.setVisible(false);\n      return;\n    }\n\n    const pixel = map.getPixelFromCoordinate(position);\n    const mapSize = map.getSize();\n    this.updateRenderedPosition(pixel, mapSize);\n  }\n\n  /**\n   * @param {import(\"./pixel.js\").Pixel} pixel The pixel location.\n   * @param {import(\"./size.js\").Size|undefined} mapSize The map size.\n   * @protected\n   */\n  updateRenderedPosition(pixel, mapSize) {\n    const style = this.element.style;\n    const offset = this.getOffset();\n\n    const positioning = this.getPositioning();\n\n    this.setVisible(true);\n\n    const x = Math.round(pixel[0] + offset[0]) + 'px';\n    const y = Math.round(pixel[1] + offset[1]) + 'px';\n    let posX = '0%';\n    let posY = '0%';\n    if (\n      positioning == 'bottom-right' ||\n      positioning == 'center-right' ||\n      positioning == 'top-right'\n    ) {\n      posX = '-100%';\n    } else if (\n      positioning == 'bottom-center' ||\n      positioning == 'center-center' ||\n      positioning == 'top-center'\n    ) {\n      posX = '-50%';\n    }\n    if (\n      positioning == 'bottom-left' ||\n      positioning == 'bottom-center' ||\n      positioning == 'bottom-right'\n    ) {\n      posY = '-100%';\n    } else if (\n      positioning == 'center-left' ||\n      positioning == 'center-center' ||\n      positioning == 'center-right'\n    ) {\n      posY = '-50%';\n    }\n    const transform = `translate(${posX}, ${posY}) translate(${x}, ${y})`;\n    if (this.rendered.transform_ != transform) {\n      this.rendered.transform_ = transform;\n      style.transform = transform;\n    }\n  }\n\n  /**\n   * returns the options this Overlay has been created with\n   * @return {Options} overlay options\n   */\n  getOptions() {\n    return this.options;\n  }\n}\n\nexport default Overlay;\n","/**\n * @module ol/source/Cluster\n */\n\nimport EventType from '../events/EventType.js';\nimport Feature from '../Feature.js';\nimport Point from '../geom/Point.js';\nimport VectorSource from './Vector.js';\nimport {add as addCoordinate, scale as scaleCoordinate} from '../coordinate.js';\nimport {assert} from '../asserts.js';\nimport {\n  buffer,\n  createEmpty,\n  createOrUpdateFromCoordinate,\n  getCenter,\n} from '../extent.js';\nimport {getUid} from '../util.js';\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions] Attributions.\n * @property {number} [distance=20] Distance in pixels within which features will\n * be clustered together.\n * @property {number} [minDistance=0] Minimum distance in pixels between clusters.\n * Will be capped at the configured distance.\n * By default no minimum distance is guaranteed. This config can be used to avoid\n * overlapping icons. As a tradoff, the cluster feature's position will no longer be\n * the center of all its features.\n * @property {function(Feature):Point} [geometryFunction]\n * Function that takes an {@link module:ol/Feature~Feature} as argument and returns an\n * {@link module:ol/geom/Point~Point} as cluster calculation point for the feature. When a\n * feature should not be considered for clustering, the function should return\n * `null`. The default, which works when the underlying source contains point\n * features only, is\n * ```js\n * function(feature) {\n *   return feature.getGeometry();\n * }\n * ```\n * See {@link module:ol/geom/Polygon~Polygon#getInteriorPoint} for a way to get a cluster\n * calculation point for polygons.\n * @property {function(Point, Array<Feature>):Feature} [createCluster]\n * Function that takes the cluster's center {@link module:ol/geom/Point~Point} and an array\n * of {@link module:ol/Feature~Feature} included in this cluster. Must return a\n * {@link module:ol/Feature~Feature} that will be used to render. Default implementation is:\n * ```js\n * function(point, features) {\n *   return new Feature({\n *     geometry: point,\n *     features: features\n *   });\n * }\n * ```\n * @property {VectorSource} [source=null] Source.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n */\n\n/**\n * @classdesc\n * Layer source to cluster vector data. Works out of the box with point\n * geometries. For other geometry types, or if not all geometries should be\n * considered for clustering, a custom `geometryFunction` can be defined.\n *\n * If the instance is disposed without also disposing the underlying\n * source `setSource(null)` has to be called to remove the listener reference\n * from the wrapped source.\n * @api\n */\nclass Cluster extends VectorSource {\n  /**\n   * @param {Options} options Cluster options.\n   */\n  constructor(options) {\n    super({\n      attributions: options.attributions,\n      wrapX: options.wrapX,\n    });\n\n    /**\n     * @type {number|undefined}\n     * @protected\n     */\n    this.resolution = undefined;\n\n    /**\n     * @type {number}\n     * @protected\n     */\n    this.distance = options.distance !== undefined ? options.distance : 20;\n\n    /**\n     * @type {number}\n     * @protected\n     */\n    this.minDistance = options.minDistance || 0;\n\n    /**\n     * @type {number}\n     * @protected\n     */\n    this.interpolationRatio = 0;\n\n    /**\n     * @type {Array<Feature>}\n     * @protected\n     */\n    this.features = [];\n\n    /**\n     * @param {Feature} feature Feature.\n     * @return {Point} Cluster calculation point.\n     * @protected\n     */\n    this.geometryFunction =\n      options.geometryFunction ||\n      function (feature) {\n        const geometry = /** @type {Point} */ (feature.getGeometry());\n        assert(geometry.getType() == 'Point', 10); // The default `geometryFunction` can only handle `Point` geometries\n        return geometry;\n      };\n\n    /**\n     * @type {function(Point, Array<Feature>):Feature}\n     * @private\n     */\n    this.createCustomCluster_ = options.createCluster;\n\n    /**\n     * @type {VectorSource|null}\n     * @protected\n     */\n    this.source = null;\n\n    /**\n     * @private\n     */\n    this.boundRefresh_ = this.refresh.bind(this);\n\n    this.updateDistance(this.distance, this.minDistance);\n    this.setSource(options.source || null);\n  }\n\n  /**\n   * Remove all features from the source.\n   * @param {boolean} [fast] Skip dispatching of {@link module:ol/source/VectorEventType~VectorEventType#removefeature} events.\n   * @api\n   */\n  clear(fast) {\n    this.features.length = 0;\n    super.clear(fast);\n  }\n\n  /**\n   * Get the distance in pixels between clusters.\n   * @return {number} Distance.\n   * @api\n   */\n  getDistance() {\n    return this.distance;\n  }\n\n  /**\n   * Get a reference to the wrapped source.\n   * @return {VectorSource|null} Source.\n   * @api\n   */\n  getSource() {\n    return this.source;\n  }\n\n  /**\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {number} resolution Resolution.\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   */\n  loadFeatures(extent, resolution, projection) {\n    this.source.loadFeatures(extent, resolution, projection);\n    if (resolution !== this.resolution) {\n      this.resolution = resolution;\n      this.refresh();\n    }\n  }\n\n  /**\n   * Set the distance within which features will be clusterd together.\n   * @param {number} distance The distance in pixels.\n   * @api\n   */\n  setDistance(distance) {\n    this.updateDistance(distance, this.minDistance);\n  }\n\n  /**\n   * Set the minimum distance between clusters. Will be capped at the\n   * configured distance.\n   * @param {number} minDistance The minimum distance in pixels.\n   * @api\n   */\n  setMinDistance(minDistance) {\n    this.updateDistance(this.distance, minDistance);\n  }\n\n  /**\n   * The configured minimum distance between clusters.\n   * @return {number} The minimum distance in pixels.\n   * @api\n   */\n  getMinDistance() {\n    return this.minDistance;\n  }\n\n  /**\n   * Replace the wrapped source.\n   * @param {VectorSource|null} source The new source for this instance.\n   * @api\n   */\n  setSource(source) {\n    if (this.source) {\n      this.source.removeEventListener(EventType.CHANGE, this.boundRefresh_);\n    }\n    this.source = source;\n    if (source) {\n      source.addEventListener(EventType.CHANGE, this.boundRefresh_);\n    }\n    this.refresh();\n  }\n\n  /**\n   * Handle the source changing.\n   */\n  refresh() {\n    this.clear();\n    this.cluster();\n    this.addFeatures(this.features);\n  }\n\n  /**\n   * Update the distances and refresh the source if necessary.\n   * @param {number} distance The new distance.\n   * @param {number} minDistance The new minimum distance.\n   */\n  updateDistance(distance, minDistance) {\n    const ratio =\n      distance === 0 ? 0 : Math.min(minDistance, distance) / distance;\n    const changed =\n      distance !== this.distance || this.interpolationRatio !== ratio;\n    this.distance = distance;\n    this.minDistance = minDistance;\n    this.interpolationRatio = ratio;\n    if (changed) {\n      this.refresh();\n    }\n  }\n\n  /**\n   * @protected\n   */\n  cluster() {\n    if (this.resolution === undefined || !this.source) {\n      return;\n    }\n    const extent = createEmpty();\n    const mapDistance = this.distance * this.resolution;\n    const features = this.source.getFeatures();\n\n    /** @type {Object<string, true>} */\n    const clustered = {};\n\n    for (let i = 0, ii = features.length; i < ii; i++) {\n      const feature = features[i];\n      if (!(getUid(feature) in clustered)) {\n        const geometry = this.geometryFunction(feature);\n        if (geometry) {\n          const coordinates = geometry.getCoordinates();\n          createOrUpdateFromCoordinate(coordinates, extent);\n          buffer(extent, mapDistance, extent);\n\n          const neighbors = this.source\n            .getFeaturesInExtent(extent)\n            .filter(function (neighbor) {\n              const uid = getUid(neighbor);\n              if (uid in clustered) {\n                return false;\n              }\n              clustered[uid] = true;\n              return true;\n            });\n          this.features.push(this.createCluster(neighbors, extent));\n        }\n      }\n    }\n  }\n\n  /**\n   * @param {Array<Feature>} features Features\n   * @param {import(\"../extent.js\").Extent} extent The searched extent for these features.\n   * @return {Feature} The cluster feature.\n   * @protected\n   */\n  createCluster(features, extent) {\n    const centroid = [0, 0];\n    for (let i = features.length - 1; i >= 0; --i) {\n      const geometry = this.geometryFunction(features[i]);\n      if (geometry) {\n        addCoordinate(centroid, geometry.getCoordinates());\n      } else {\n        features.splice(i, 1);\n      }\n    }\n    scaleCoordinate(centroid, 1 / features.length);\n    const searchCenter = getCenter(extent);\n    const ratio = this.interpolationRatio;\n    const geometry = new Point([\n      centroid[0] * (1 - ratio) + searchCenter[0] * ratio,\n      centroid[1] * (1 - ratio) + searchCenter[1] * ratio,\n    ]);\n    if (this.createCustomCluster_) {\n      return this.createCustomCluster_(geometry, features);\n    }\n    return new Feature({\n      geometry,\n      features,\n    });\n  }\n}\n\nexport default Cluster;\n","/**\n * @module ol/source/OSM\n */\n\nimport XYZ from './XYZ.js';\n\n/**\n * The attribution containing a link to the OpenStreetMap Copyright and License\n * page.\n * @const\n * @type {string}\n * @api\n */\nexport const ATTRIBUTION =\n  '&#169; ' +\n  '<a href=\"https://www.openstreetmap.org/copyright\" target=\"_blank\">OpenStreetMap</a> ' +\n  'contributors.';\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions] Attributions.\n * @property {number} [cacheSize] Initial tile cache size. Will auto-grow to hold at least the number of tiles in the viewport.\n * @property {null|string} [crossOrigin='anonymous'] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you want to access pixel data with the Canvas renderer.\n * See https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image for more detail.\n * @property {boolean} [interpolate=true] Use interpolated values when resampling.  By default,\n * linear interpolation is used when resampling.  Set to false to use the nearest neighbor instead.\n * @property {number} [maxZoom=19] Max zoom.\n * @property {boolean} [opaque=true] Whether the layer is opaque.\n * @property {number} [reprojectionErrorThreshold=0.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {import(\"../Tile.js\").LoadFunction} [tileLoadFunction] Optional function to load a tile given a URL. The default is\n * ```js\n * function(imageTile, src) {\n *   imageTile.getImage().src = src;\n * };\n * ```\n * @property {number} [transition=250] Duration of the opacity transition for rendering.\n * To disable the opacity transition, pass `transition: 0`.\n * @property {string} [url='https://tile.openstreetmap.org/{z}/{x}/{y}.png'] URL template.\n * Must include `{x}`, `{y}` or `{-y}`, and `{z}` placeholders.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n * @property {number|import(\"../array.js\").NearestDirectionFunction} [zDirection=0]\n * Choose whether to use tiles with a higher or lower zoom level when between integer\n * zoom levels. See {@link module:ol/tilegrid/TileGrid~TileGrid#getZForResolution}.\n */\n\n/**\n * @classdesc\n * Layer source for the OpenStreetMap tile server.\n * @api\n */\nclass OSM extends XYZ {\n  /**\n   * @param {Options} [options] Open Street Map options.\n   */\n  constructor(options) {\n    options = options || {};\n\n    let attributions;\n    if (options.attributions !== undefined) {\n      attributions = options.attributions;\n    } else {\n      attributions = [ATTRIBUTION];\n    }\n\n    const crossOrigin =\n      options.crossOrigin !== undefined ? options.crossOrigin : 'anonymous';\n\n    const url =\n      options.url !== undefined\n        ? options.url\n        : 'https://tile.openstreetmap.org/{z}/{x}/{y}.png';\n\n    super({\n      attributions: attributions,\n      attributionsCollapsible: false,\n      cacheSize: options.cacheSize,\n      crossOrigin: crossOrigin,\n      interpolate: options.interpolate,\n      maxZoom: options.maxZoom !== undefined ? options.maxZoom : 19,\n      opaque: options.opaque !== undefined ? options.opaque : true,\n      reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n      tileLoadFunction: options.tileLoadFunction,\n      transition: options.transition,\n      url: url,\n      wrapX: options.wrapX,\n      zDirection: options.zDirection,\n    });\n  }\n}\n\nexport default OSM;\n","export function resolveUrl(url, baseUrl) {\n    // url is absolute already\n    if (url.match(/^[a-z]+:\\/\\//i)) {\n        return url;\n    }\n    // url is absolute already, without protocol\n    if (url.match(/^\\/\\//)) {\n        return window.location.protocol + url;\n    }\n    // dataURI, mailto:, tel:, etc.\n    if (url.match(/^[a-z]+:/i)) {\n        return url;\n    }\n    const doc = document.implementation.createHTMLDocument();\n    const base = doc.createElement('base');\n    const a = doc.createElement('a');\n    doc.head.appendChild(base);\n    doc.body.appendChild(a);\n    if (baseUrl) {\n        base.href = baseUrl;\n    }\n    a.href = url;\n    return a.href;\n}\nexport const uuid = (() => {\n    // generate uuid for className of pseudo elements.\n    // We should not use GUIDs, otherwise pseudo elements sometimes cannot be captured.\n    let counter = 0;\n    // ref: http://stackoverflow.com/a/6248722/2519373\n    const random = () => \n    // eslint-disable-next-line no-bitwise\n    `0000${((Math.random() * 36 ** 4) << 0).toString(36)}`.slice(-4);\n    return () => {\n        counter += 1;\n        return `u${random()}${counter}`;\n    };\n})();\nexport function delay(ms) {\n    return (args) => new Promise((resolve) => {\n        setTimeout(() => resolve(args), ms);\n    });\n}\nexport function toArray(arrayLike) {\n    const arr = [];\n    for (let i = 0, l = arrayLike.length; i < l; i++) {\n        arr.push(arrayLike[i]);\n    }\n    return arr;\n}\nfunction px(node, styleProperty) {\n    const win = node.ownerDocument.defaultView || window;\n    const val = win.getComputedStyle(node).getPropertyValue(styleProperty);\n    return val ? parseFloat(val.replace('px', '')) : 0;\n}\nfunction getNodeWidth(node) {\n    const leftBorder = px(node, 'border-left-width');\n    const rightBorder = px(node, 'border-right-width');\n    return node.clientWidth + leftBorder + rightBorder;\n}\nfunction getNodeHeight(node) {\n    const topBorder = px(node, 'border-top-width');\n    const bottomBorder = px(node, 'border-bottom-width');\n    return node.clientHeight + topBorder + bottomBorder;\n}\nexport function getImageSize(targetNode, options = {}) {\n    const width = options.width || getNodeWidth(targetNode);\n    const height = options.height || getNodeHeight(targetNode);\n    return { width, height };\n}\nexport function getPixelRatio() {\n    let ratio;\n    let FINAL_PROCESS;\n    try {\n        FINAL_PROCESS = process;\n    }\n    catch (e) {\n        // pass\n    }\n    const val = FINAL_PROCESS && FINAL_PROCESS.env\n        ? FINAL_PROCESS.env.devicePixelRatio\n        : null;\n    if (val) {\n        ratio = parseInt(val, 10);\n        if (Number.isNaN(ratio)) {\n            ratio = 1;\n        }\n    }\n    return ratio || window.devicePixelRatio || 1;\n}\n// @see https://developer.mozilla.org/en-US/docs/Web/HTML/Element/canvas#maximum_canvas_size\nconst canvasDimensionLimit = 16384;\nexport function checkCanvasDimensions(canvas) {\n    if (canvas.width > canvasDimensionLimit ||\n        canvas.height > canvasDimensionLimit) {\n        if (canvas.width > canvasDimensionLimit &&\n            canvas.height > canvasDimensionLimit) {\n            if (canvas.width > canvas.height) {\n                canvas.height *= canvasDimensionLimit / canvas.width;\n                canvas.width = canvasDimensionLimit;\n            }\n            else {\n                canvas.width *= canvasDimensionLimit / canvas.height;\n                canvas.height = canvasDimensionLimit;\n            }\n        }\n        else if (canvas.width > canvasDimensionLimit) {\n            canvas.height *= canvasDimensionLimit / canvas.width;\n            canvas.width = canvasDimensionLimit;\n        }\n        else {\n            canvas.width *= canvasDimensionLimit / canvas.height;\n            canvas.height = canvasDimensionLimit;\n        }\n    }\n}\nexport function canvasToBlob(canvas, options = {}) {\n    if (canvas.toBlob) {\n        return new Promise((resolve) => {\n            canvas.toBlob(resolve, options.type ? options.type : 'image/png', options.quality ? options.quality : 1);\n        });\n    }\n    return new Promise((resolve) => {\n        const binaryString = window.atob(canvas\n            .toDataURL(options.type ? options.type : undefined, options.quality ? options.quality : undefined)\n            .split(',')[1]);\n        const len = binaryString.length;\n        const binaryArray = new Uint8Array(len);\n        for (let i = 0; i < len; i += 1) {\n            binaryArray[i] = binaryString.charCodeAt(i);\n        }\n        resolve(new Blob([binaryArray], {\n            type: options.type ? options.type : 'image/png',\n        }));\n    });\n}\nexport function createImage(url) {\n    return new Promise((resolve, reject) => {\n        const img = new Image();\n        img.decode = () => resolve(img);\n        img.onload = () => resolve(img);\n        img.onerror = reject;\n        img.crossOrigin = 'anonymous';\n        img.decoding = 'async';\n        img.src = url;\n    });\n}\nexport async function svgToDataURL(svg) {\n    return Promise.resolve()\n        .then(() => new XMLSerializer().serializeToString(svg))\n        .then(encodeURIComponent)\n        .then((html) => `data:image/svg+xml;charset=utf-8,${html}`);\n}\nexport async function nodeToDataURL(node, width, height) {\n    const xmlns = 'http://www.w3.org/2000/svg';\n    const svg = document.createElementNS(xmlns, 'svg');\n    const foreignObject = document.createElementNS(xmlns, 'foreignObject');\n    svg.setAttribute('width', `${width}`);\n    svg.setAttribute('height', `${height}`);\n    svg.setAttribute('viewBox', `0 0 ${width} ${height}`);\n    foreignObject.setAttribute('width', '100%');\n    foreignObject.setAttribute('height', '100%');\n    foreignObject.setAttribute('x', '0');\n    foreignObject.setAttribute('y', '0');\n    foreignObject.setAttribute('externalResourcesRequired', 'true');\n    svg.appendChild(foreignObject);\n    foreignObject.appendChild(node);\n    return svgToDataURL(svg);\n}\nexport const isInstanceOfElement = (node, instance) => {\n    if (node instanceof instance)\n        return true;\n    const nodePrototype = Object.getPrototypeOf(node);\n    if (nodePrototype === null)\n        return false;\n    return (nodePrototype.constructor.name === instance.name ||\n        isInstanceOfElement(nodePrototype, instance));\n};\n//# sourceMappingURL=util.js.map","import { uuid, toArray } from './util';\nfunction formatCSSText(style) {\n    const content = style.getPropertyValue('content');\n    return `${style.cssText} content: '${content.replace(/'|\"/g, '')}';`;\n}\nfunction formatCSSProperties(style) {\n    return toArray(style)\n        .map((name) => {\n        const value = style.getPropertyValue(name);\n        const priority = style.getPropertyPriority(name);\n        return `${name}: ${value}${priority ? ' !important' : ''};`;\n    })\n        .join(' ');\n}\nfunction getPseudoElementStyle(className, pseudo, style) {\n    const selector = `.${className}:${pseudo}`;\n    const cssText = style.cssText\n        ? formatCSSText(style)\n        : formatCSSProperties(style);\n    return document.createTextNode(`${selector}{${cssText}}`);\n}\nfunction clonePseudoElement(nativeNode, clonedNode, pseudo) {\n    const style = window.getComputedStyle(nativeNode, pseudo);\n    const content = style.getPropertyValue('content');\n    if (content === '' || content === 'none') {\n        return;\n    }\n    const className = uuid();\n    try {\n        clonedNode.className = `${clonedNode.className} ${className}`;\n    }\n    catch (err) {\n        return;\n    }\n    const styleElement = document.createElement('style');\n    styleElement.appendChild(getPseudoElementStyle(className, pseudo, style));\n    clonedNode.appendChild(styleElement);\n}\nexport function clonePseudoElements(nativeNode, clonedNode) {\n    clonePseudoElement(nativeNode, clonedNode, ':before');\n    clonePseudoElement(nativeNode, clonedNode, ':after');\n}\n//# sourceMappingURL=clone-pseudos.js.map","const WOFF = 'application/font-woff';\nconst JPEG = 'image/jpeg';\nconst mimes = {\n    woff: WOFF,\n    woff2: WOFF,\n    ttf: 'application/font-truetype',\n    eot: 'application/vnd.ms-fontobject',\n    png: 'image/png',\n    jpg: JPEG,\n    jpeg: JPEG,\n    gif: 'image/gif',\n    tiff: 'image/tiff',\n    svg: 'image/svg+xml',\n    webp: 'image/webp',\n};\nfunction getExtension(url) {\n    const match = /\\.([^./]*?)$/g.exec(url);\n    return match ? match[1] : '';\n}\nexport function getMimeType(url) {\n    const extension = getExtension(url).toLowerCase();\n    return mimes[extension] || '';\n}\n//# sourceMappingURL=mimes.js.map","function getContentFromDataUrl(dataURL) {\n    return dataURL.split(/,/)[1];\n}\nexport function isDataUrl(url) {\n    return url.search(/^(data:)/) !== -1;\n}\nexport function makeDataUrl(content, mimeType) {\n    return `data:${mimeType};base64,${content}`;\n}\nexport async function fetchAsDataURL(url, init, process) {\n    const res = await fetch(url, init);\n    if (res.status === 404) {\n        throw new Error(`Resource \"${res.url}\" not found`);\n    }\n    const blob = await res.blob();\n    return new Promise((resolve, reject) => {\n        const reader = new FileReader();\n        reader.onerror = reject;\n        reader.onloadend = () => {\n            try {\n                resolve(process({ res, result: reader.result }));\n            }\n            catch (error) {\n                reject(error);\n            }\n        };\n        reader.readAsDataURL(blob);\n    });\n}\nconst cache = {};\nfunction getCacheKey(url, contentType, includeQueryParams) {\n    let key = url.replace(/\\?.*/, '');\n    if (includeQueryParams) {\n        key = url;\n    }\n    // font resource\n    if (/ttf|otf|eot|woff2?/i.test(key)) {\n        key = key.replace(/.*\\//, '');\n    }\n    return contentType ? `[${contentType}]${key}` : key;\n}\nexport async function resourceToDataURL(resourceUrl, contentType, options) {\n    const cacheKey = getCacheKey(resourceUrl, contentType, options.includeQueryParams);\n    if (cache[cacheKey] != null) {\n        return cache[cacheKey];\n    }\n    // ref: https://developer.mozilla.org/en/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest#Bypassing_the_cache\n    if (options.cacheBust) {\n        // eslint-disable-next-line no-param-reassign\n        resourceUrl += (/\\?/.test(resourceUrl) ? '&' : '?') + new Date().getTime();\n    }\n    let dataURL;\n    try {\n        const content = await fetchAsDataURL(resourceUrl, options.fetchRequestInit, ({ res, result }) => {\n            if (!contentType) {\n                // eslint-disable-next-line no-param-reassign\n                contentType = res.headers.get('Content-Type') || '';\n            }\n            return getContentFromDataUrl(result);\n        });\n        dataURL = makeDataUrl(content, contentType);\n    }\n    catch (error) {\n        dataURL = options.imagePlaceholder || '';\n        let msg = `Failed to fetch resource: ${resourceUrl}`;\n        if (error) {\n            msg = typeof error === 'string' ? error : error.message;\n        }\n        if (msg) {\n            console.warn(msg);\n        }\n    }\n    cache[cacheKey] = dataURL;\n    return dataURL;\n}\n//# sourceMappingURL=dataurl.js.map","import { clonePseudoElements } from './clone-pseudos';\nimport { createImage, toArray, isInstanceOfElement } from './util';\nimport { getMimeType } from './mimes';\nimport { resourceToDataURL } from './dataurl';\nasync function cloneCanvasElement(canvas) {\n    const dataURL = canvas.toDataURL();\n    if (dataURL === 'data:,') {\n        return canvas.cloneNode(false);\n    }\n    return createImage(dataURL);\n}\nasync function cloneVideoElement(video, options) {\n    if (video.currentSrc) {\n        const canvas = document.createElement('canvas');\n        const ctx = canvas.getContext('2d');\n        canvas.width = video.clientWidth;\n        canvas.height = video.clientHeight;\n        ctx === null || ctx === void 0 ? void 0 : ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n        const dataURL = canvas.toDataURL();\n        return createImage(dataURL);\n    }\n    const poster = video.poster;\n    const contentType = getMimeType(poster);\n    const dataURL = await resourceToDataURL(poster, contentType, options);\n    return createImage(dataURL);\n}\nasync function cloneIFrameElement(iframe) {\n    var _a;\n    try {\n        if ((_a = iframe === null || iframe === void 0 ? void 0 : iframe.contentDocument) === null || _a === void 0 ? void 0 : _a.body) {\n            return (await cloneNode(iframe.contentDocument.body, {}, true));\n        }\n    }\n    catch (_b) {\n        // Failed to clone iframe\n    }\n    return iframe.cloneNode(false);\n}\nasync function cloneSingleNode(node, options) {\n    if (isInstanceOfElement(node, HTMLCanvasElement)) {\n        return cloneCanvasElement(node);\n    }\n    if (isInstanceOfElement(node, HTMLVideoElement)) {\n        return cloneVideoElement(node, options);\n    }\n    if (isInstanceOfElement(node, HTMLIFrameElement)) {\n        return cloneIFrameElement(node);\n    }\n    return node.cloneNode(false);\n}\nconst isSlotElement = (node) => node.tagName != null && node.tagName.toUpperCase() === 'SLOT';\nasync function cloneChildren(nativeNode, clonedNode, options) {\n    var _a, _b;\n    let children = [];\n    if (isSlotElement(nativeNode) && nativeNode.assignedNodes) {\n        children = toArray(nativeNode.assignedNodes());\n    }\n    else if (isInstanceOfElement(nativeNode, HTMLIFrameElement) &&\n        ((_a = nativeNode.contentDocument) === null || _a === void 0 ? void 0 : _a.body)) {\n        children = toArray(nativeNode.contentDocument.body.childNodes);\n    }\n    else {\n        children = toArray(((_b = nativeNode.shadowRoot) !== null && _b !== void 0 ? _b : nativeNode).childNodes);\n    }\n    if (children.length === 0 ||\n        isInstanceOfElement(nativeNode, HTMLVideoElement)) {\n        return clonedNode;\n    }\n    await children.reduce((deferred, child) => deferred\n        .then(() => cloneNode(child, options))\n        .then((clonedChild) => {\n        if (clonedChild) {\n            clonedNode.appendChild(clonedChild);\n        }\n    }), Promise.resolve());\n    return clonedNode;\n}\nfunction cloneCSSStyle(nativeNode, clonedNode) {\n    const targetStyle = clonedNode.style;\n    if (!targetStyle) {\n        return;\n    }\n    const sourceStyle = window.getComputedStyle(nativeNode);\n    if (sourceStyle.cssText) {\n        targetStyle.cssText = sourceStyle.cssText;\n        targetStyle.transformOrigin = sourceStyle.transformOrigin;\n    }\n    else {\n        toArray(sourceStyle).forEach((name) => {\n            let value = sourceStyle.getPropertyValue(name);\n            if (name === 'font-size' && value.endsWith('px')) {\n                const reducedFont = Math.floor(parseFloat(value.substring(0, value.length - 2))) - 0.1;\n                value = `${reducedFont}px`;\n            }\n            if (isInstanceOfElement(nativeNode, HTMLIFrameElement) &&\n                name === 'display' &&\n                value === 'inline') {\n                value = 'block';\n            }\n            if (name === 'd' && clonedNode.getAttribute('d')) {\n                value = `path(${clonedNode.getAttribute('d')})`;\n            }\n            targetStyle.setProperty(name, value, sourceStyle.getPropertyPriority(name));\n        });\n    }\n}\nfunction cloneInputValue(nativeNode, clonedNode) {\n    if (isInstanceOfElement(nativeNode, HTMLTextAreaElement)) {\n        clonedNode.innerHTML = nativeNode.value;\n    }\n    if (isInstanceOfElement(nativeNode, HTMLInputElement)) {\n        clonedNode.setAttribute('value', nativeNode.value);\n    }\n}\nfunction cloneSelectValue(nativeNode, clonedNode) {\n    if (isInstanceOfElement(nativeNode, HTMLSelectElement)) {\n        const clonedSelect = clonedNode;\n        const selectedOption = Array.from(clonedSelect.children).find((child) => nativeNode.value === child.getAttribute('value'));\n        if (selectedOption) {\n            selectedOption.setAttribute('selected', '');\n        }\n    }\n}\nfunction decorate(nativeNode, clonedNode) {\n    if (isInstanceOfElement(clonedNode, Element)) {\n        cloneCSSStyle(nativeNode, clonedNode);\n        clonePseudoElements(nativeNode, clonedNode);\n        cloneInputValue(nativeNode, clonedNode);\n        cloneSelectValue(nativeNode, clonedNode);\n    }\n    return clonedNode;\n}\nasync function ensureSVGSymbols(clone, options) {\n    const uses = clone.querySelectorAll ? clone.querySelectorAll('use') : [];\n    if (uses.length === 0) {\n        return clone;\n    }\n    const processedDefs = {};\n    for (let i = 0; i < uses.length; i++) {\n        const use = uses[i];\n        const id = use.getAttribute('xlink:href');\n        if (id) {\n            const exist = clone.querySelector(id);\n            const definition = document.querySelector(id);\n            if (!exist && definition && !processedDefs[id]) {\n                // eslint-disable-next-line no-await-in-loop\n                processedDefs[id] = (await cloneNode(definition, options, true));\n            }\n        }\n    }\n    const nodes = Object.values(processedDefs);\n    if (nodes.length) {\n        const ns = 'http://www.w3.org/1999/xhtml';\n        const svg = document.createElementNS(ns, 'svg');\n        svg.setAttribute('xmlns', ns);\n        svg.style.position = 'absolute';\n        svg.style.width = '0';\n        svg.style.height = '0';\n        svg.style.overflow = 'hidden';\n        svg.style.display = 'none';\n        const defs = document.createElementNS(ns, 'defs');\n        svg.appendChild(defs);\n        for (let i = 0; i < nodes.length; i++) {\n            defs.appendChild(nodes[i]);\n        }\n        clone.appendChild(svg);\n    }\n    return clone;\n}\nexport async function cloneNode(node, options, isRoot) {\n    if (!isRoot && options.filter && !options.filter(node)) {\n        return null;\n    }\n    return Promise.resolve(node)\n        .then((clonedNode) => cloneSingleNode(clonedNode, options))\n        .then((clonedNode) => cloneChildren(node, clonedNode, options))\n        .then((clonedNode) => decorate(node, clonedNode))\n        .then((clonedNode) => ensureSVGSymbols(clonedNode, options));\n}\n//# sourceMappingURL=clone-node.js.map","import { resolveUrl } from './util';\nimport { getMimeType } from './mimes';\nimport { isDataUrl, makeDataUrl, resourceToDataURL } from './dataurl';\nconst URL_REGEX = /url\\((['\"]?)([^'\"]+?)\\1\\)/g;\nconst URL_WITH_FORMAT_REGEX = /url\\([^)]+\\)\\s*format\\(([\"']?)([^\"']+)\\1\\)/g;\nconst FONT_SRC_REGEX = /src:\\s*(?:url\\([^)]+\\)\\s*format\\([^)]+\\)[,;]\\s*)+/g;\nfunction toRegex(url) {\n    // eslint-disable-next-line no-useless-escape\n    const escaped = url.replace(/([.*+?^${}()|\\[\\]\\/\\\\])/g, '\\\\$1');\n    return new RegExp(`(url\\\\(['\"]?)(${escaped})(['\"]?\\\\))`, 'g');\n}\nexport function parseURLs(cssText) {\n    const urls = [];\n    cssText.replace(URL_REGEX, (raw, quotation, url) => {\n        urls.push(url);\n        return raw;\n    });\n    return urls.filter((url) => !isDataUrl(url));\n}\nexport async function embed(cssText, resourceURL, baseURL, options, getContentFromUrl) {\n    try {\n        const resolvedURL = baseURL ? resolveUrl(resourceURL, baseURL) : resourceURL;\n        const contentType = getMimeType(resourceURL);\n        let dataURL;\n        if (getContentFromUrl) {\n            const content = await getContentFromUrl(resolvedURL);\n            dataURL = makeDataUrl(content, contentType);\n        }\n        else {\n            dataURL = await resourceToDataURL(resolvedURL, contentType, options);\n        }\n        return cssText.replace(toRegex(resourceURL), `$1${dataURL}$3`);\n    }\n    catch (error) {\n        // pass\n    }\n    return cssText;\n}\nfunction filterPreferredFontFormat(str, { preferredFontFormat }) {\n    return !preferredFontFormat\n        ? str\n        : str.replace(FONT_SRC_REGEX, (match) => {\n            // eslint-disable-next-line no-constant-condition\n            while (true) {\n                const [src, , format] = URL_WITH_FORMAT_REGEX.exec(match) || [];\n                if (!format) {\n                    return '';\n                }\n                if (format === preferredFontFormat) {\n                    return `src: ${src};`;\n                }\n            }\n        });\n}\nexport function shouldEmbed(url) {\n    return url.search(URL_REGEX) !== -1;\n}\nexport async function embedResources(cssText, baseUrl, options) {\n    if (!shouldEmbed(cssText)) {\n        return cssText;\n    }\n    const filteredCSSText = filterPreferredFontFormat(cssText, options);\n    const urls = parseURLs(filteredCSSText);\n    return urls.reduce((deferred, url) => deferred.then((css) => embed(css, url, baseUrl, options)), Promise.resolve(filteredCSSText));\n}\n//# sourceMappingURL=embed-resources.js.map","import { embedResources } from './embed-resources';\nimport { toArray, isInstanceOfElement } from './util';\nimport { isDataUrl, resourceToDataURL } from './dataurl';\nimport { getMimeType } from './mimes';\nasync function embedProp(propName, node, options) {\n    var _a;\n    const propValue = (_a = node.style) === null || _a === void 0 ? void 0 : _a.getPropertyValue(propName);\n    if (propValue) {\n        const cssString = await embedResources(propValue, null, options);\n        node.style.setProperty(propName, cssString, node.style.getPropertyPriority(propName));\n        return true;\n    }\n    return false;\n}\nasync function embedBackground(clonedNode, options) {\n    if (!(await embedProp('background', clonedNode, options))) {\n        await embedProp('background-image', clonedNode, options);\n    }\n    if (!(await embedProp('mask', clonedNode, options))) {\n        await embedProp('mask-image', clonedNode, options);\n    }\n}\nasync function embedImageNode(clonedNode, options) {\n    const isImageElement = isInstanceOfElement(clonedNode, HTMLImageElement);\n    if (!(isImageElement && !isDataUrl(clonedNode.src)) &&\n        !(isInstanceOfElement(clonedNode, SVGImageElement) &&\n            !isDataUrl(clonedNode.href.baseVal))) {\n        return;\n    }\n    const url = isImageElement ? clonedNode.src : clonedNode.href.baseVal;\n    const dataURL = await resourceToDataURL(url, getMimeType(url), options);\n    await new Promise((resolve, reject) => {\n        clonedNode.onload = resolve;\n        clonedNode.onerror = reject;\n        const image = clonedNode;\n        if (image.decode) {\n            image.decode = resolve;\n        }\n        if (image.loading === 'lazy') {\n            image.loading = 'eager';\n        }\n        if (isImageElement) {\n            clonedNode.srcset = '';\n            clonedNode.src = dataURL;\n        }\n        else {\n            clonedNode.href.baseVal = dataURL;\n        }\n    });\n}\nasync function embedChildren(clonedNode, options) {\n    const children = toArray(clonedNode.childNodes);\n    const deferreds = children.map((child) => embedImages(child, options));\n    await Promise.all(deferreds).then(() => clonedNode);\n}\nexport async function embedImages(clonedNode, options) {\n    if (isInstanceOfElement(clonedNode, Element)) {\n        await embedBackground(clonedNode, options);\n        await embedImageNode(clonedNode, options);\n        await embedChildren(clonedNode, options);\n    }\n}\n//# sourceMappingURL=embed-images.js.map","export function applyStyle(node, options) {\n    const { style } = node;\n    if (options.backgroundColor) {\n        style.backgroundColor = options.backgroundColor;\n    }\n    if (options.width) {\n        style.width = `${options.width}px`;\n    }\n    if (options.height) {\n        style.height = `${options.height}px`;\n    }\n    const manual = options.style;\n    if (manual != null) {\n        Object.keys(manual).forEach((key) => {\n            style[key] = manual[key];\n        });\n    }\n    return node;\n}\n//# sourceMappingURL=apply-style.js.map","import { toArray } from './util';\nimport { fetchAsDataURL } from './dataurl';\nimport { shouldEmbed, embedResources } from './embed-resources';\nconst cssFetchCache = {};\nasync function fetchCSS(url) {\n    let cache = cssFetchCache[url];\n    if (cache != null) {\n        return cache;\n    }\n    const res = await fetch(url);\n    const cssText = await res.text();\n    cache = { url, cssText };\n    cssFetchCache[url] = cache;\n    return cache;\n}\nasync function embedFonts(data, options) {\n    let cssText = data.cssText;\n    const regexUrl = /url\\([\"']?([^\"')]+)[\"']?\\)/g;\n    const fontLocs = cssText.match(/url\\([^)]+\\)/g) || [];\n    const loadFonts = fontLocs.map(async (loc) => {\n        let url = loc.replace(regexUrl, '$1');\n        if (!url.startsWith('https://')) {\n            url = new URL(url, data.url).href;\n        }\n        return fetchAsDataURL(url, options.fetchRequestInit, ({ result }) => {\n            cssText = cssText.replace(loc, `url(${result})`);\n            return [loc, result];\n        });\n    });\n    return Promise.all(loadFonts).then(() => cssText);\n}\nfunction parseCSS(source) {\n    if (source == null) {\n        return [];\n    }\n    const result = [];\n    const commentsRegex = /(\\/\\*[\\s\\S]*?\\*\\/)/gi;\n    // strip out comments\n    let cssText = source.replace(commentsRegex, '');\n    // eslint-disable-next-line prefer-regex-literals\n    const keyframesRegex = new RegExp('((@.*?keyframes [\\\\s\\\\S]*?){([\\\\s\\\\S]*?}\\\\s*?)})', 'gi');\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n        const matches = keyframesRegex.exec(cssText);\n        if (matches === null) {\n            break;\n        }\n        result.push(matches[0]);\n    }\n    cssText = cssText.replace(keyframesRegex, '');\n    const importRegex = /@import[\\s\\S]*?url\\([^)]*\\)[\\s\\S]*?;/gi;\n    // to match css & media queries together\n    const combinedCSSRegex = '((\\\\s*?(?:\\\\/\\\\*[\\\\s\\\\S]*?\\\\*\\\\/)?\\\\s*?@media[\\\\s\\\\S]' +\n        '*?){([\\\\s\\\\S]*?)}\\\\s*?})|(([\\\\s\\\\S]*?){([\\\\s\\\\S]*?)})';\n    // unified regex\n    const unifiedRegex = new RegExp(combinedCSSRegex, 'gi');\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n        let matches = importRegex.exec(cssText);\n        if (matches === null) {\n            matches = unifiedRegex.exec(cssText);\n            if (matches === null) {\n                break;\n            }\n            else {\n                importRegex.lastIndex = unifiedRegex.lastIndex;\n            }\n        }\n        else {\n            unifiedRegex.lastIndex = importRegex.lastIndex;\n        }\n        result.push(matches[0]);\n    }\n    return result;\n}\nasync function getCSSRules(styleSheets, options) {\n    const ret = [];\n    const deferreds = [];\n    // First loop inlines imports\n    styleSheets.forEach((sheet) => {\n        if ('cssRules' in sheet) {\n            try {\n                toArray(sheet.cssRules || []).forEach((item, index) => {\n                    if (item.type === CSSRule.IMPORT_RULE) {\n                        let importIndex = index + 1;\n                        const url = item.href;\n                        const deferred = fetchCSS(url)\n                            .then((metadata) => embedFonts(metadata, options))\n                            .then((cssText) => parseCSS(cssText).forEach((rule) => {\n                            try {\n                                sheet.insertRule(rule, rule.startsWith('@import')\n                                    ? (importIndex += 1)\n                                    : sheet.cssRules.length);\n                            }\n                            catch (error) {\n                                console.error('Error inserting rule from remote css', {\n                                    rule,\n                                    error,\n                                });\n                            }\n                        }))\n                            .catch((e) => {\n                            console.error('Error loading remote css', e.toString());\n                        });\n                        deferreds.push(deferred);\n                    }\n                });\n            }\n            catch (e) {\n                const inline = styleSheets.find((a) => a.href == null) || document.styleSheets[0];\n                if (sheet.href != null) {\n                    deferreds.push(fetchCSS(sheet.href)\n                        .then((metadata) => embedFonts(metadata, options))\n                        .then((cssText) => parseCSS(cssText).forEach((rule) => {\n                        inline.insertRule(rule, sheet.cssRules.length);\n                    }))\n                        .catch((err) => {\n                        console.error('Error loading remote stylesheet', err);\n                    }));\n                }\n                console.error('Error inlining remote css file', e);\n            }\n        }\n    });\n    return Promise.all(deferreds).then(() => {\n        // Second loop parses rules\n        styleSheets.forEach((sheet) => {\n            if ('cssRules' in sheet) {\n                try {\n                    toArray(sheet.cssRules || []).forEach((item) => {\n                        ret.push(item);\n                    });\n                }\n                catch (e) {\n                    console.error(`Error while reading CSS rules from ${sheet.href}`, e);\n                }\n            }\n        });\n        return ret;\n    });\n}\nfunction getWebFontRules(cssRules) {\n    return cssRules\n        .filter((rule) => rule.type === CSSRule.FONT_FACE_RULE)\n        .filter((rule) => shouldEmbed(rule.style.getPropertyValue('src')));\n}\nasync function parseWebFontRules(node, options) {\n    if (node.ownerDocument == null) {\n        throw new Error('Provided element is not within a Document');\n    }\n    const styleSheets = toArray(node.ownerDocument.styleSheets);\n    const cssRules = await getCSSRules(styleSheets, options);\n    return getWebFontRules(cssRules);\n}\nexport async function getWebFontCSS(node, options) {\n    const rules = await parseWebFontRules(node, options);\n    const cssTexts = await Promise.all(rules.map((rule) => {\n        const baseUrl = rule.parentStyleSheet ? rule.parentStyleSheet.href : null;\n        return embedResources(rule.cssText, baseUrl, options);\n    }));\n    return cssTexts.join('\\n');\n}\nexport async function embedWebFonts(clonedNode, options) {\n    const cssText = options.fontEmbedCSS != null\n        ? options.fontEmbedCSS\n        : options.skipFonts\n            ? null\n            : await getWebFontCSS(clonedNode, options);\n    if (cssText) {\n        const styleNode = document.createElement('style');\n        const sytleContent = document.createTextNode(cssText);\n        styleNode.appendChild(sytleContent);\n        if (clonedNode.firstChild) {\n            clonedNode.insertBefore(styleNode, clonedNode.firstChild);\n        }\n        else {\n            clonedNode.appendChild(styleNode);\n        }\n    }\n}\n//# sourceMappingURL=embed-webfonts.js.map","import { cloneNode } from './clone-node';\nimport { embedImages } from './embed-images';\nimport { applyStyle } from './apply-style';\nimport { embedWebFonts, getWebFontCSS } from './embed-webfonts';\nimport { getImageSize, getPixelRatio, createImage, canvasToBlob, nodeToDataURL, checkCanvasDimensions, } from './util';\nexport async function toSvg(node, options = {}) {\n    const { width, height } = getImageSize(node, options);\n    const clonedNode = (await cloneNode(node, options, true));\n    await embedWebFonts(clonedNode, options);\n    await embedImages(clonedNode, options);\n    applyStyle(clonedNode, options);\n    const datauri = await nodeToDataURL(clonedNode, width, height);\n    return datauri;\n}\nexport async function toCanvas(node, options = {}) {\n    const { width, height } = getImageSize(node, options);\n    const svg = await toSvg(node, options);\n    const img = await createImage(svg);\n    const canvas = document.createElement('canvas');\n    const context = canvas.getContext('2d');\n    const ratio = options.pixelRatio || getPixelRatio();\n    const canvasWidth = options.canvasWidth || width;\n    const canvasHeight = options.canvasHeight || height;\n    canvas.width = canvasWidth * ratio;\n    canvas.height = canvasHeight * ratio;\n    if (!options.skipAutoScale) {\n        checkCanvasDimensions(canvas);\n    }\n    canvas.style.width = `${canvasWidth}`;\n    canvas.style.height = `${canvasHeight}`;\n    if (options.backgroundColor) {\n        context.fillStyle = options.backgroundColor;\n        context.fillRect(0, 0, canvas.width, canvas.height);\n    }\n    context.drawImage(img, 0, 0, canvas.width, canvas.height);\n    return canvas;\n}\nexport async function toPixelData(node, options = {}) {\n    const { width, height } = getImageSize(node, options);\n    const canvas = await toCanvas(node, options);\n    const ctx = canvas.getContext('2d');\n    return ctx.getImageData(0, 0, width, height).data;\n}\nexport async function toPng(node, options = {}) {\n    const canvas = await toCanvas(node, options);\n    return canvas.toDataURL();\n}\nexport async function toJpeg(node, options = {}) {\n    const canvas = await toCanvas(node, options);\n    return canvas.toDataURL('image/jpeg', options.quality || 1);\n}\nexport async function toBlob(node, options = {}) {\n    const canvas = await toCanvas(node, options);\n    const blob = await canvasToBlob(canvas);\n    return blob;\n}\nexport async function getFontEmbedCSS(node, options = {}) {\n    return getWebFontCSS(node, options);\n}\n//# sourceMappingURL=index.js.map","export default \"__VITE_ASSET__a1b2bb5c__\"","<script>\r\nimport { onMounted, reactive, nextTick } from 'vue'\r\n\r\nimport { Map, View, Feature } from 'ol'\r\nimport 'ol/ol.css'\r\nimport { OSM } from 'ol/source.js'\r\nimport { Tile, Tile as TileLayer, Image as ImageLayer, Vector, Vector as VectorLayer } from 'ol/layer.js'\r\n\r\nimport VectorSource from 'ol/source/Vector.js'\r\nimport { Icon, Fill, Stroke, Style } from 'ol/style.js'\r\nimport { Circle, Polygon, Point } from 'ol/geom.js'\r\nimport { toPng } from \"html-to-image\";\r\nimport currentPositionImg from '@/assets/img/icon/currentPosition.svg';\r\n\r\nexport default {\r\n    props: {\r\n        coordinate: {\r\n            type: Object,\r\n            default: {}\r\n        },\r\n    },\r\n    setup(props, { emit }) {\r\n        let map\r\n        const state = reactive({\r\n            imgSrc: 'dddd'\r\n        })\r\n        onMounted(async () => {\r\n            map = new Map({\r\n                target: 'imgMap',\r\n                layers: [\r\n                    new TileLayer({\r\n                        preload: Infinity,\r\n                        crossOrigin: \"Anonymous\",\r\n                        source: new OSM(),\r\n                    }),\r\n                    new Vector({\r\n                        source: new VectorSource({\r\n                            features: [\r\n                                new Feature({\r\n                                    geometry: new Point(props.coordinate),\r\n                                    population: 4000,\r\n                                    rainfall: 500,\r\n                                })\r\n                            ]\r\n                        }),\r\n                        style: new Style({\r\n                            image: new Icon({\r\n                                anchor: [0.5, 100],\r\n                                anchorXUnits: 'fraction',\r\n                                anchorYUnits: 'pixels',\r\n                                src: currentPositionImg,\r\n                            }),\r\n                        })\r\n                    })\r\n                ],\r\n                view: new View({\r\n                    projection: 'EPSG:4326',\r\n                    center: props.coordinate,\r\n                    zoom: 14,\r\n                }),\r\n            })\r\n            map.once('loadend', function () {\r\n                toPng(map.getTargetElement()).then(function (dataURL) {\r\n                    if(document.getElementById('imgMap') !== null ) {\r\n                        document.getElementById('imgMap').remove()\r\n                        state.imgSrc = dataURL\r\n                    }\r\n                })\r\n            })\r\n        })\r\n        return {\r\n            props,\r\n            state,\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<template>\r\n    <div class=\"position-relative\" style=\"overflow: hidden;\">\r\n        <div id=\"imgMap\" class=\"position-absolute\" style=\"width: 600px; height: 600px;\"></div>\r\n        <div :style=\"{\r\n            'background': `url('${state.imgSrc}')`,\r\n            'background-size': 'cover'\r\n        }\"\r\n        style=\"width: 100%; height: 200px;\">\r\n\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<style lang=\"sass\" scoped>\r\n#imgMap\r\n    top: 0\r\n    left: 0\r\n</style>","export default \"__VITE_ASSET__204bf141__\"","<script>\r\nimport { useSlots, onBeforeMount, onMounted, onUpdated, onBeforeUnmount, ref, reactive, computed, watch, nextTick, defineAsyncComponent, useCssModule, inject } from 'vue'\r\nimport $ from 'jquery'\r\nimport { useRouter } from 'vue-router'\r\n\r\nexport default {\r\n    props: {\r\n        popup: {\r\n            type: Object,\r\n            default: {}\r\n        },\r\n        closeMapData: {\r\n            Type: Function,\r\n            default: ()=>{}\r\n        },\r\n        maxHeight: {\r\n            Type: Number,\r\n            default: 0\r\n        },\r\n        coordinate: {\r\n            type: Object,\r\n            default: {}\r\n        },\r\n    },\r\n    setup(props, { emit }){\r\n        const router = useRouter()\r\n        const state = reactive({\r\n            type: 0,\r\n            media: 'photo',\r\n            scrollY: false,\r\n            tribeData: {\r\n                data: {}\r\n            },\r\n        })\r\n\r\n        async function getTribeData (tribeId) {\r\n            const result = await $.ajax({\r\n                url: `https://api.edtest.site/tribe?tribeCode=${tribeId}`,\r\n                method: \"GET\"\r\n            }).done(res => {\r\n                return res\r\n            }).fail(FailMethod => {\r\n                console.log('Fail', FailMethod)\r\n                state.type = 0\r\n                return false\r\n            })\r\n            return result\r\n        }\r\n\r\n        async function getDisasterData (id) {\r\n            const result = await $.ajax({\r\n                url: `https://api.edtest.site/historicalDiseaster?id=${id}`,\r\n                method: \"GET\"\r\n            }).done(res => {\r\n                return res\r\n            }).fail(FailMethod => {\r\n                console.log('Fail', FailMethod)\r\n                state.type = 0\r\n                return false\r\n            })\r\n            return result\r\n        }\r\n\r\n        async function getRainfallStation (stationName) {\r\n            const result = await $.ajax({\r\n                url: `https://api.edtest.site/rainData?stationName=${stationName}`,\r\n                method: \"GET\"\r\n            }).done(res => {\r\n                return res\r\n            }).fail(FailMethod => {\r\n                console.log('Fail', FailMethod)\r\n                state.type = 0\r\n                return false\r\n            })\r\n            return result\r\n        }\r\n\r\n        watch(props.popup, async (newVal)=>{\r\n            console.log(newVal)\r\n            //TODO: 結構優化\r\n            if (newVal.popupData == \"新竹縣原住民部落範圍\"){\r\n                getTribeData(newVal.popupId).then((result)=>{\r\n                    state.type = 1\r\n                    state.tribeData = result\r\n                })\r\n                return\r\n            }\r\n            if (props.popup.popupData == \"近年歷史災害82處部落點位\"){\r\n                getDisasterData(`近年歷史災害82處部落點位.${ props.popup.popupId }`).then((result)=>{\r\n                    state.type = 2\r\n                    state.tribeData = result.data\r\n                })\r\n                return\r\n            }\r\n            if (props.popup.popupData == \"雨量站\"){\r\n                getDisasterData(`雨量站.${ props.popup.popupId }`).then((result)=>{\r\n                    state.type = 3\r\n                    if (result.data !== null) {\r\n                        state.tribeData = result.data\r\n                    }\r\n                })\r\n                return\r\n            }\r\n        })\r\n\r\n        onMounted(async ()=>{\r\n            if (props.popup.popupData == \"新竹縣原住民部落範圍\"){\r\n                getTribeData(props.popup.popupId).then((result)=>{\r\n                    state.type = 1\r\n                    state.tribeData = result\r\n                })\r\n                return\r\n            }\r\n            if (props.popup.popupData == \"近年歷史災害82處部落點位\"){\r\n                getDisasterData(`近年歷史災害82處部落點位.${ props.popup.popupId }`).then((result)=>{\r\n                    state.type = 2\r\n                    state.tribeData = result.data\r\n                })\r\n                return\r\n            }\r\n            if (props.popup.popupData == \"雨量站\"){\r\n                getRainfallStation(`雨量站.${ props.popup.popupId }`).then((result)=>{\r\n                    state.type = 3\r\n                    if (result.data !== null) {\r\n                        state.tribeData = result.data\r\n                    }\r\n                })\r\n                return\r\n            }\r\n        })\r\n\r\n        return {\r\n            router,\r\n            props,\r\n            state,\r\n        }\r\n    }\r\n}\r\n\r\n</script>\r\n\r\n<template>\r\n    <div class=\"bg-white rounded py-2\" style=\"overflow-y: auto;\"\r\n    :style=\"{\r\n        'max-height': props.maxHeight + 'px',\r\n    }\">\r\n        <div v-if=\"state.type === 1\">\r\n            <div class=\"row mx-0 align-items-center flex-nowrap text-center p-2 fw-bold\">\r\n                <p>詳細資訊</p>\r\n                <!-- TODO: 關閉事件 -->\r\n                <div class=\"position-absolute col-auto end-0 cursor-pointer\" style=\"top: 10px;\" @click=\"props.closeMapData\">\r\n                    <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\">\r\n                        <path fill=\"currentColor\" d=\"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10s-4.477 10-10 10zm0-11.414L9.172 7.757L7.757 9.172L10.586 12l-2.829 2.828l1.415 1.415L12 13.414l2.828 2.829l1.415-1.415L13.414 12l2.829-2.828l-1.415-1.415L12 10.586z\"/>\r\n                    </svg>\r\n                </div>\r\n            </div>\r\n            <areaImg :coordinate=\"props.popup.coordinate\" :type=\"state.type\" />\r\n            <div class=\"row mx-0 align-items-center p-2 position-relative\">\r\n                <div class=\"d-flex flex-nowrap align-items-center justify-content-between my-2\">\r\n                    <span class=\"\">{{ state?.tribeData?.basicInformation?.tribeName }} </span>\r\n                    <div class=\"p-2 bg-steel w-auto text-white d-inline-block rounded-2 cursor-pointer\"\r\n                    @click=\"()=>{\r\n                        router.push({\r\n                            name: 'detail',\r\n                            params: {\r\n                                id: props.popup.popupId\r\n                            },\r\n                        })\r\n                    }\">更多資訊</div>\r\n                </div>\r\n                <p>描述: {{ state?.tribeData?.basicInformation?.description }}</p>\r\n\r\n                <p>{{ state?.tribeData?.basicInformation?.area }}</p>\r\n                <a href=\"#\">\r\n                    <img src=\"@/assets/img/icon/vector.svg\" alt=\"\">\r\n                    {{ state?.tribeData?.basicInformation?.coordinates?.WGS84?.lat}}\r\n                    ,\r\n                    {{state?.tribeData?.basicInformation?.coordinates?.WGS84?.lng }}\r\n                </a>\r\n            </div>\r\n            <div>\r\n                <div class=\"border-bottom row flex-nowrap p-2 my-3 cursor-pointer mx-0\">\r\n                    <div class=\"col-6 cursor-pointer\" @click=\"state.media = 'photo'\">相片</div>\r\n                    <div class=\"col-6 cursor-pointer\" @click=\"state.media = 'video'\">影片</div>\r\n                </div>\r\n                <div class=\"py-2 px-4\" v-if=\"state.media === 'photo'\">\r\n                    <div class=\"d-flex flex-wrap justify-content-between\">\r\n                        <div class=\"w-50 mb-4\" v-for=\"item in state?.tribeData?.culturalLandscape\">\r\n                            <p class=\"mb-0\">{{ item.name }}</p>\r\n                            <img :src=\"item.image\" alt=\"\" class=\"w-100\">\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"py-2 px-4\" v-if=\"state.media === 'video'\">\r\n                    <div>尚無影片</div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div v-if=\"state.type === 2\">\r\n            <div class=\"row mx-0 align-items-center px-2 py-4 position-relative\">\r\n                <div class=\"row mx-0 mb-2\" v-if=\"state.tribeData.event\">\r\n                    <div class=\"col-4 p-1 bg-red-light text-white d-flex justify-content-center align-items-center\">事件:</div>\r\n                    <div class=\"col-8 py-1 px-2 bg-grey-light text-start\">{{ state.tribeData.event }}</div>\r\n                </div>\r\n                <div class=\"row mx-0 mb-2\" v-if=\"state.tribeData.date\">\r\n                    <div class=\"col-4 p-1 bg-red-light text-white d-flex justify-content-center align-items-center\">發生時間:</div>\r\n                    <div class=\"col-8 py-1 px-2 bg-grey-light text-start\">{{ state.tribeData.date }}</div>\r\n                </div>\r\n                <div class=\"row mx-0 mb-2\" v-if=\"state.tribeData.township\">\r\n                    <div class=\"col-4 p-1 bg-red-light text-white d-flex justify-content-center align-items-center\">鄉鎮: </div>\r\n                    <div class=\"col-8 py-1 px-2 bg-grey-light text-start\">{{ state.tribeData.township }}</div>\r\n                </div>\r\n                <div class=\"row mx-0 mb-2\" v-if=\"state.tribeData.village\">\r\n                    <div class=\"col-4 p-1 bg-red-light text-white d-flex justify-content-center align-items-center\">地方: </div>\r\n                    <div class=\"col-8 py-1 px-2 bg-grey-light text-start\">{{ state.tribeData.village }}</div>\r\n                </div>\r\n                <div class=\"row mx-0 mb-2\" v-if=\"state.tribeData.place\">\r\n                    <div class=\"col-4 p-1 bg-red-light text-white d-flex justify-content-center align-items-center\">村落: </div>\r\n                    <div class=\"col-8 py-1 px-2 bg-grey-light text-start\">{{ state.tribeData.place }}</div>\r\n                </div>\r\n                <div class=\"row mx-0 mb-2\" v-if=\"state.tribeData.category\">\r\n                    <div class=\"col-4 p-1 bg-red-light text-white d-flex justify-content-center align-items-center\">災害種類: </div>\r\n                    <div class=\"col-8 py-1 px-2 bg-grey-light text-start\">{{ state.tribeData.category }}</div>\r\n                </div>\r\n                <div class=\"row mx-0 mb-2\" v-if=\"state.tribeData.description\">\r\n                    <div class=\"col-4 p-1 bg-red-light text-white d-flex justify-content-center align-items-center\">描述: </div>\r\n                    <div class=\"col-8 py-1 px-2 bg-grey-light text-start\">{{ state.tribeData.description }}</div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div v-if=\"state.type === 3\">\r\n            <div class=\"p-2 p-sm-3\">\r\n                <p class=\"text-start px-0 fw-bold\">雨量站</p>\r\n                <!-- {{ state.tribeData.viewStation }} -->\r\n                <hr>\r\n                <div class=\"p-0 p-sm-2\">\r\n                    <p>觀測時間: {{ state.tribeData?.viewDatetime }}</p>\r\n                    <p>單位:mm </p>\r\n                    <table class=\"rainfall border-bottom border-grey w-100\">\r\n                        <thead>\r\n                            <tr class=\"text-center\">\r\n                                <td class=\"bg-blueDeep text-white border border-white p-2\">10分鐘</td>\r\n                                <td class=\"bg-blueDeep text-white border border-white p-2\">時雨量</td>\r\n                                <td class=\"bg-blueDeep text-white border border-white p-2\">3小時</td>\r\n                                <td class=\"bg-blueDeep text-white border border-white p-2\">6小時</td>\r\n                                <td class=\"bg-blueDeep text-white border border-white p-2\">12小時</td>\r\n                                <td class=\"bg-blueDeep text-white border border-white p-2\">24小時</td>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            <tr class=\"text-center\">\r\n                                <td class=\"p-2\">{{ state.tribeData?.min_10 }}</td>\r\n                                <td class=\"p-2\">{{ state.tribeData?.hour_1 }}</td>\r\n                                <td class=\"p-2\">{{ state.tribeData?.hour_3 }}</td>\r\n                                <td class=\"p-2\">{{ state.tribeData?.hour_6 }}</td>\r\n                                <td class=\"p-2\">{{ state.tribeData?.hour_12 }}</td>\r\n                                <td class=\"p-2\">{{ state.tribeData?.hour_24 }}</td>\r\n                            </tr>\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<style lang=\"sass\" scoped>\r\n@import '@/assets/styles/all.module.scss'\r\n@media (max-width:600px)\r\n    .rainfall\r\n        td\r\n            font-size: 12px\r\n</style>\r\n","export default \"__VITE_ASSET__e22a173a__\"","export default \"__VITE_ASSET__a5f6138f__\"","export default \"__VITE_ASSET__4fd4ec4f__\"","export default \"__VITE_ASSET__2736ec62__\"","export default \"__VITE_ASSET__f256a0d2__\"","export default \"__VITE_ASSET__39236d8e__\"","export default \"__VITE_ASSET__797f4095__\"","<script>\r\nimport { useSlots, onBeforeMount, onMounted, onBeforeUnmount, ref, reactive, computed, watch, nextTick, defineAsyncComponent, useCssModule, inject } from 'vue'\r\nimport $ from 'jquery'\r\n\r\nexport default {\r\n    props: {\r\n        currentLayers: {\r\n            type: Array,\r\n            default: []\r\n        },\r\n        mapCount: {\r\n            type: Number,\r\n            default: 1\r\n        },\r\n        dimensionMapStatus: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        openConditionWrap: {\r\n            type: Function,\r\n            default: () => {}\r\n        },\r\n        openLayerSelect: {\r\n            type: Function,\r\n            default: () => {}\r\n        },\r\n        onLayerControl: {\r\n            type: Function,\r\n            default: () => {}\r\n        },\r\n        onChangeTarget: {\r\n            type: Function,\r\n            default: () => {}\r\n        },\r\n        onChangeMapCount: {\r\n            type: Function,\r\n            default: ()=>{}\r\n        },\r\n    },\r\n    setup(props, { emit }) {\r\n        const state = reactive({\r\n            toolSwitch: {\r\n                threeDimensionalBtn: false,\r\n                layerConditionBtn: false,\r\n                splitWindowBtn: false,\r\n            },\r\n            targetNum: 1,\r\n        })\r\n\r\n        function toolSwitch(target, value) {\r\n            // 其他全部關掉\r\n            Object.keys(state.toolSwitch).forEach(node => {\r\n                if (node === target) {\r\n                    if(state.toolSwitch[target]) {\r\n                        state.toolSwitch[target] = false\r\n                    } else {\r\n                        state.toolSwitch[target] = true\r\n                    }\r\n                } else {\r\n                    state.toolSwitch[node] = false\r\n                }\r\n            })\r\n        }\r\n        function onLayerControl(action, value) {\r\n            if (action === 'changeMapCount') {\r\n                state.toolSwitch['splitWindowBtn'] = false\r\n            }\r\n            props.onLayerControl({ action, value })\r\n        }\r\n\r\n        function conditionWrap() {\r\n            emit('conditionWrap')\r\n        }\r\n\r\n        // TODO: 手機板打開燈箱點擊燈箱外關閉\r\n\r\n        return {\r\n            props,\r\n            state,\r\n            toolSwitch,\r\n            onLayerControl,\r\n            conditionWrap,\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<template>\r\n    <div class=\"w-100\">\r\n        <div class=\"position-fixed top-0 w-100 px-3 d-flex justify-content-between justify-content-sm-end flex-wrap\">\r\n            <img src=\"@/assets/logo.svg\" class=\"w-50 w-lg-100\">\r\n            <div class=\"switchControl mt-2 me-0 me-sm-2 d-block rounded-4 p-2\" id=\"switchControl\" style=\"z-index: 99;\">\r\n                <div class=\"text-white rounded-pill\" :class=\"{ 'active': state.targetNum === 1 }\"\r\n                @click=\"() => {\r\n                    state.targetNum = 1\r\n                    props.onChangeTarget(1)\r\n                }\">上</div>\r\n                <div class=\"text-white rounded-pill\" :class=\"{ 'active': state.targetNum === 2 }\"\r\n                @click=\"() => {\r\n                    state.targetNum = 2\r\n                    props.onChangeTarget(2)\r\n                }\">下</div>\r\n            </div>\r\n        </div>\r\n\r\n        <ul class=\"list-unstyled d-flex align-items-center justify-content-around py-2 flex-nowrap w-100 bg-white mb-0\">\r\n            <li>\r\n                <div>\r\n                    <div class=\"navbarBtn\" v-if=\"props.dimensionMapStatus\"\r\n                    @click.prevent=\"toolSwitch('threeDimensionalBtn'), onLayerControl('changeDimensionMap', '3D')\">\r\n                        <img src=\"@/assets/img/icon/2D-m.svg\">\r\n                    </div>\r\n                    <div class=\"navbarBtn\" v-else\r\n                    @click.prevent=\"toolSwitch('threeDimensionalBtn'), onLayerControl('changeDimensionMap', '2D')\">\r\n                        <img src=\"@/assets/img/icon/3D-m.svg\">\r\n                    </div>\r\n                </div>\r\n            </li>\r\n            <li>\r\n                <div class=\"navbarBtn\" @click=\"props.openConditionWrap()\">\r\n                    <img src=\"@/assets/img/icon/vector-m.svg\">\r\n                </div>\r\n            </li>\r\n            <li>\r\n                <div class=\"navbarBtn\" @click=\"props.openLayerSelect()\">\r\n                    <img src=\"@/assets/img/icon/selectVector-m.svg\">\r\n                </div>\r\n            </li>\r\n            <li>\r\n                <div class=\"text-white\">\r\n                    <div class=\"navbarBtn\" v-if=\"props.mapCount === 1\" @click.prevent=\"props.onChangeMapCount(2)\">\r\n                        <img src=\"@/assets/img/icon/singleWindow-m.svg\">\r\n                    </div>\r\n                    <div class=\"navbarBtn\" v-if=\"props.mapCount === 2\" @click.prevent=\"props.onChangeMapCount(1)\">\r\n                        <img src=\"@/assets/img/icon/doubleWindow-m.svg\">\r\n                    </div>\r\n                </div>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n</template>\r\n\r\n<style lang=\"sass\">\r\n.switchControl\r\n    background: rgba(30, 30, 30, 0.9)\r\n    box-sizing: border-box\r\n    div\r\n        padding:5px\r\n        cursor: pointer\r\n        box-sizing: border-box\r\n    .active\r\n        background: #247BA0\r\n\r\nul\r\n    li\r\n        .navbarBtn\r\n            width: 60px\r\n            height: 60px\r\n            img\r\n                width: 100%\r\n                height: 100%\r\n        &:nth-Child(1) .navbarBtn, &:nth-Child(4) .navbarBtn\r\n            width: 50px\r\n            height: 50px\r\n</style>","export default \"__VITE_ASSET__77deec8d__\"","export default \"__VITE_ASSET__c678c661__\"","export default \"__VITE_ASSET__3744c808__\"","export default \"__VITE_ASSET__52eecc49__\"","export default \"__VITE_ASSET__083761bd__\"","<script>\r\nimport { useSlots, onBeforeMount, onMounted, onBeforeUnmount, ref, reactive, computed, watch, nextTick, defineAsyncComponent, useCssModule, inject } from 'vue'\r\nimport $ from 'jquery'\r\nimport { Layer } from 'ol/layer'\r\n\r\nexport default {\r\n    props: {\r\n        onClose: {\r\n            type: Function,\r\n            default: ()=>{}\r\n        },\r\n        onDeleteLayer: {\r\n            type: Function,\r\n            default: ()=>{}\r\n        },\r\n        onLockLayer: {\r\n            type: Function,\r\n            default: ()=>{}\r\n        },\r\n        currentLayers: {\r\n            type: Array,\r\n            default: []\r\n        },\r\n        selectLock: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        onLayerControl: {\r\n            type: Function,\r\n            default: ()=>{}\r\n        }\r\n    },\r\n    setup(props, { emit }) {\r\n        const state = reactive({})\r\n        function updateOpacity(e){\r\n            props.onLayerControl({\r\n                action: 'setOpacity',\r\n                value: {\r\n                    key: e.target.getAttribute('nodeindex'),\r\n                    value: e.target.value,\r\n                }\r\n            })\r\n            const opacity = parseFloat(Number(e.target.value))\r\n            document.getElementById(`opacityControl${ e.target.getAttribute('nodeindex') }`).innerText = opacity.toFixed(2)\r\n        }\r\n\r\n        return {\r\n            props,\r\n            state,\r\n            updateOpacity\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<template>\r\n    <div class=\"layerSelect bg-white\">\r\n        <div class=\"row mx-0 align-items-center flex-nowrap text-center p-2 fw-bold\">\r\n            <p class=\"mb-0 fs-5\">已選擇的圖層</p>\r\n            <a href=\"#\" class=\"closeBtn bg-dark text-decoration-none rounded-circle position-absolute d-flex align-items-center justify-content-center\" @click.prevent=\"props.onClose\"></a>\r\n        </div>\r\n        <hr class=\"my-0\">\r\n        <div class=\"py-3 px-4 content\" style=\"overflow-y: scroll;max-height: 40vh;\">\r\n            <div class=\"allControl d-flex align-items-center justify-content-end mb-0\">\r\n                <a href=\"\" class=\"d-flex align-items-center text-decoration-none me-3\"\r\n                :class=\"{'lockUp': props.selectLock, 'unlock': !props.selectLock}\"\r\n                @click.prevent=\"()=>{\r\n                    props.onLockLayer()\r\n                }\">\r\n                    <img src=\"../assets/img/icon/lockOpen.svg\" alt=\"\">\r\n                    鎖定圖層\r\n                </a>\r\n                <a href=\"\" class=\"d-flex align-items-center text-decoration-none\"\r\n                :class=\"{'disabled':props.currentLayers.length <= 1}\"\r\n                @click.prevent=\"()=>{\r\n                    if (props.currentLayers.length > 0) {\r\n                        props.onDeleteLayer({\r\n                            action: 'selectLayerMode',\r\n                            value: {\r\n                                layerName: 'all'\r\n                            }\r\n                        })\r\n                    }\r\n                }\">\r\n                    <img src=\"../assets/img/icon/deleteLayer.svg\" alt=\"\">\r\n                    全部取消\r\n                </a>\r\n            </div>\r\n            <ul class=\"list-unstyled d-flex flex-wrap flex-column-reverse\">\r\n                <li v-for=\"(node, nodeIndex) in props.currentLayers\">\r\n                    <div class=\"d-flex justify-content-between align-items-center border-bottom py-2 flex-wrap\" v-if=\"node.id\">\r\n                        <div>\r\n                            {{ node?.label }}\r\n                        </div>\r\n                        <div class=\"tool\">\r\n                            <a href=\"\"\r\n                            @click.prevent=\"props.onLayerControl({\r\n                                action: 'changeOrder',\r\n                                value: {\r\n                                    movement:'up',\r\n                                    id: node.id,\r\n                                    key: nodeIndex\r\n                                },\r\n                            })\">\r\n                                <img src=\"../assets/img/icon/arrow_up.svg\" alt=\"\">\r\n                            </a>\r\n                            <a href=\"\"\r\n                            @click.prevent=\"props.onLayerControl({\r\n                                action: 'changeOrder',\r\n                                value: {\r\n                                    movement: 'down',\r\n                                    id: node.id,\r\n                                    key: nodeIndex\r\n                                }\r\n                            })\">\r\n                                <img src=\"../assets/img/icon/arrow_down.svg\" alt=\"\">\r\n                            </a>\r\n                            <a href=\"\"\r\n                            :class=\"{\r\n                                'Invisible': !node?.visible\r\n                            }\"\r\n                            @click.prevent=\"()=>{\r\n                                props.onLayerControl({\r\n                                    action: 'changeLayerVisible',\r\n                                    value: {\r\n                                        key: nodeIndex,\r\n                                    }\r\n                                })\r\n                            }\">\r\n                                <img src=\"../assets/img/icon/eyes.svg\" alt=\"\">\r\n                            </a>\r\n                            <a href=\"\"\r\n                            @click.prevent=\"props.onDeleteLayer({\r\n                                action: 'selectLayerMode',\r\n                                value: {\r\n                                    id: node?.id,\r\n                                }\r\n                            })\">\r\n                                <img src=\"../assets/img/icon/deleteLayer.svg\" alt=\"\">\r\n                            </a>\r\n                        </div>\r\n                        <label class=\"w-100 mt-2 d-flex align-items-center\">\r\n                            <input id=\"opacity-input\" class=\"w-75 me-2\" type=\"range\" min=\"0\" max=\"1\" step=\"0.01\" value=\"1\" :nodeIndex=\"nodeIndex\" @input=\"updateOpacity\" />\r\n                            <span :id=\"`opacityControl${ nodeIndex }`\">1</span>\r\n                        </label>\r\n                    </div>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<style lang=\"sass\" scoped>\r\n@import '@/assets/styles/all.module.scss'\r\n.layerSelect\r\n    border-radius: 10px\r\n.closeBtn\r\n    right:10px\r\n    width: 20px\r\n    height: 20px\r\n    padding: 0\r\n    &::after\r\n        content: ''\r\n        background: #fff\r\n        height: 2px\r\n        width: 60%\r\n        display: block\r\n.content\r\n    .title\r\n        cursor: pointer\r\n        svg\r\n            transform: rotateZ(0)\r\n        .openTitle\r\n            transform: rotateZ(90deg)\r\n    svg, img\r\n        width: 28px\r\n        height: 28px\r\n.tool\r\n    a\r\n        padding: 5px 0\r\n    .visible\r\n        color: red\r\n    .Invisible\r\n        color: blue\r\n        position: relative\r\n        &::after\r\n            content: ''\r\n            position: absolute\r\n            top: 55%\r\n            left: 20%\r\n            width: 60%\r\n            height: 2px\r\n            background: $grey\r\n            transform-origin: 50% 50%\r\n            transform: rotateZ(45deg)\r\n            display: block\r\n.allControl\r\n    a\r\n        color: $grey\r\n    .lockUp\r\n        color: #247BA0\r\n    .unlock\r\n        color: $grey\r\n\r\n@media (max-width: 600px)\r\n    .layerSelect\r\n        border-radius: 0\r\n</style>\r\n","<script>\r\nimport { useSlots, onBeforeMount, onMounted, onBeforeUnmount, ref, reactive, computed, watch, nextTick, defineAsyncComponent, useCssModule, inject } from 'vue'\r\nimport $ from 'jquery'\r\nimport router from '@/router/index.js'\r\nimport { useStore } from 'vuex'\r\n\r\nexport default {\r\n    props: {\r\n        text: {\r\n            type: String,\r\n            default: '測試'\r\n        },\r\n        styles: {\r\n            type: String,\r\n            default: ''\r\n        },\r\n        status: {\r\n            type: Boolean,\r\n            default: true\r\n        }\r\n    },\r\n    setup(props, { emit }) {\r\n        const store = useStore()\r\n        const route = router\r\n\r\n        // 透過ref綁定此元件，元件再以position的方式黏貼在父層上，在抓取此元件寬高做出白邊線效果\r\n        const overLayCom = ref(null)\r\n\r\n        const state = reactive({\r\n            overLayerHeight: computed(()=>{\r\n                return overLayCom?.value?.offsetHeight + 10\r\n            }),\r\n            overLayerWidth: computed(()=>{\r\n                return overLayCom?.value?.offsetWidth + 10\r\n            }),\r\n            accordionListRef: null,\r\n            accordionListRefHeight: computed(()=>{\r\n                return state.accordionListRef?.offsetHeight\r\n            }),\r\n            accordionListRefWidth: computed(()=>{\r\n                return state.accordionListRef?.offsetWidth\r\n            })\r\n        })\r\n\r\n        onMounted(()=>{\r\n            $('.initOverLay').parent().addClass('position-relative')\r\n        })\r\n        return {\r\n            state,\r\n            props,\r\n            store,\r\n            route,\r\n            overLayCom,\r\n        }\r\n    }\r\n}\r\n</script>\r\n<template>\r\n    <div class=\"initOverLay\"\r\n    v-if=\"store.state.isInit\"\r\n    @click=\"store.dispatch('updateLayerStatus', false)\"\r\n    :style=\"{\r\n        height: state.overLayerHeight + 'px',\r\n        width: state.overLayerWidth + 'px',\r\n    }\"\r\n    :ref=\"(e) => {\r\n        state.accordionListRef = e\r\n    }\">\r\n        <div class=\"tipText text-white fw-bold fs-3\"\r\n        :style=\"props.styles\"\r\n        >{{ props.text }}</div>\r\n    </div>\r\n</template>\r\n<style lang=\"sass\">\r\n.initOverLay\r\n    position: absolute\r\n    top: -5px\r\n    left: -5px\r\n    width: calc(100% + 10px)\r\n    height: calc(100% + 10px)\r\n    border: 3px solid #fff\r\n    z-index: 99999\r\n.tipText\r\n    position: absolute\r\n    top: 100%\r\n    width: 300px\r\n</style>","<script>\r\nimport { useSlots, onBeforeMount, onMounted, onBeforeUnmount, ref, reactive, computed, watch, nextTick, defineAsyncComponent, useCssModule, inject } from 'vue'\r\nimport $ from 'jquery'\r\n\r\nimport mapLayerList from '@/config/mapLayerList'\r\nimport baseMapList from '@/config/baseMapList'\r\nimport VectorImageLayer from 'ol/layer/VectorImage.js'\r\nimport TileState from 'ol/TileState.js'\r\nimport { useRouter } from 'vue-router'\r\n\r\n\r\nimport 'ol-ext/dist/ol-ext.css'\r\n\r\nexport default {\r\n    props: {\r\n        onClose: {\r\n            type: Function,\r\n            default: () => {}\r\n        },\r\n        mapLayers: {\r\n            type: Array,\r\n            default: []\r\n        },\r\n        currentLayers: {\r\n            type: Array,\r\n            default: []\r\n        },\r\n        showSelectLayerValue: {\r\n            type: Function,\r\n            default: () => {}\r\n        },\r\n        selectLayerOption: {\r\n            type: Object,\r\n            default: {}\r\n        },\r\n        tribeQuery: {\r\n            type: Object,\r\n            default: {}\r\n        },\r\n        moveToMap: {\r\n            type: Function,\r\n            default: () => {}\r\n        }\r\n    },\r\n    setup(props, { emit }) {\r\n        const mapList = mapLayerList\r\n        const router = useRouter()\r\n        const state = reactive({\r\n            DropDown: null,\r\n            TilesListValue: 0,\r\n            conditionYear: '',\r\n            conditionTown: '',\r\n            selectLayerOption: []\r\n        })\r\n\r\n        function onLayerControl(action, value) {\r\n            emit('onLayerControl', { action, value })\r\n        }\r\n        function openLayerList(value) {\r\n            if (state.DropDown !== value) {\r\n                state.DropDown = value\r\n            } else {\r\n                state.DropDown = null\r\n            }\r\n        }\r\n        function LayerCheckBoxChange(e, item) {\r\n            let defaultChecked = e.target.checked || ((typeof e.target.checked == ' ') ? true : false )\r\n            onLayerControl('layerMode', {\r\n                checked: defaultChecked,\r\n                nodeIndex: item.nodeIndex,\r\n                subNodeIndex: item.subNodeIndex,\r\n                nestedSubNodeIndex: String(item.nestedSubNodeIndex) ? item.nestedSubNodeIndex : undefined,\r\n                // 判斷是否有子層即是勾選的還是下拉\r\n                id: (item.single_tiles || !(e.target.selectedOptions)) ? item.id : e.target.selectedOptions[0].id\r\n            })\r\n        }\r\n\r\n        function tribeYear(event) {\r\n            state.conditionYear = event.target.value\r\n            getTribes()\r\n        }\r\n\r\n        function tribeTown(event) {\r\n            state.conditionTown = event.target.value\r\n            getTribes()\r\n        }\r\n\r\n        async function getTribes() {\r\n            const result = await $.ajax(`https://api.edtest.site/tribes?${ 'years=' + state.conditionYear }&${ 'township=' + state.conditionTown }`, 'GET')\r\n            state.selectLayerOption = result\r\n        }\r\n\r\n        function moveMap(params) {\r\n            let selectValue = state.selectLayerOption.find(node=>node.tribeCode === params.target.value)\r\n            props.moveToMap(selectValue.coordinates)\r\n        }\r\n\r\n        watch(()=>state.TilesListValue, (newVal , oldVal)=>{\r\n            props.showSelectLayerValue(newVal)\r\n        })\r\n\r\n        return {\r\n            props,\r\n            state,\r\n            router,\r\n            mapList,\r\n            onLayerControl,\r\n            openLayerList,\r\n            LayerCheckBoxChange,\r\n            tribeYear,\r\n            tribeTown,\r\n            moveMap\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<template>\r\n    <div class=\"condition bg-white\">\r\n        <div class=\"row mx-0 align-items-center flex-nowrap text-center p-2 fw-bold border-bottom\">\r\n            <p class=\"mb-0 fs-5\">圖層選項</p>\r\n            <a href=\"#\" class=\"closeBtn bg-dark text-decoration-none rounded-circle position-absolute d-flex align-items-center justify-content-center\" @click.prevent=\"props.onClose\"></a>\r\n        </div>\r\n        <div class=\"py-3 px-4 content\" style=\"max-height: 40vh;overflow-y: scroll;\">\r\n            <div class=\"mb-2 landBoundary\">\r\n                <div v-for=\"(node, nodeIndex) in props.mapLayers\" class=\"mb-2\">\r\n                    <div class=\"title d-flex align-items-center fw-bold text-black order-1 mb-1 text-decoration-none\"\r\n                        @click=\"openLayerList(nodeIndex)\">\r\n                        <div :class=\"node.groupClass\"></div>\r\n                        <div>{{ node.label }}</div>\r\n                        <svg viewBox=\"0 0 24 24\" :class=\"{ 'openTitle': state.DropDown == nodeIndex }\">\r\n                            <path fill=\"currentColor\" d=\"M8 5v14l11-7z\" />\r\n                        </svg>\r\n                    </div>\r\n                    <div class=\"ms-3 mb-1\" v-for=\"(subNode, subNodeIndex) in node.layers\" v-if=\"state.DropDown == nodeIndex\">\r\n                        <div v-if=\"subNode.single_tiles\">\r\n                            <input type=\"checkbox\"\r\n                            :checked=\"props.currentLayers.some(node=> node.id === subNode.id)\"\r\n                            @change=\"(e) => {\r\n                                LayerCheckBoxChange(e, {\r\n                                    nodeIndex: nodeIndex,\r\n                                    subNode: subNode,\r\n                                    subNodeIndex: subNodeIndex,\r\n                                    nestedSubNodeIndex: '',\r\n                                    single_tiles: subNode.single_tiles,\r\n                                    id: subNode.id\r\n                                })\r\n                            }\">\r\n                            {{ subNode.title }}\r\n                            <!-- TODO: 優化 -->\r\n                            <div v-if=\"true\">\r\n                                <div v-if=\"subNode.id === 'node4_subNode0_nestedSubNodeundefined'\">\r\n                                    <select class=\"me-2\"\r\n                                    v-if=\"props.tribeQuery['years'] !== undefined\" @change=\"tribeYear\" placeholder=\"請選擇年度\">\r\n                                        <option :value=\"item\" v-for=\"(item, key) in props.tribeQuery['years']\">\r\n                                            {{ item }}\r\n                                        </option>\r\n                                    </select>\r\n                                    <select class=\"me-2\"\r\n                                    v-if=\"props.tribeQuery['township'] !== undefined\" @change=\"tribeTown\" placeholder=\"請選擇鄉鎮\">\r\n                                        <option :value=\"item\" v-for=\"(item, key) in props.tribeQuery['township']\">\r\n                                            {{ item }}\r\n                                        </option>\r\n                                    </select>\r\n                                    <select class=\"me-2\"\r\n                                    v-if=\"state.selectLayerOption.length !== 0\" @change=\"moveMap\">\r\n                                        <option :value=\"item.tribeCode\" v-for=\"(item, key) in state.selectLayerOption\">\r\n                                            {{ item.tribeName }}\r\n                                        </option>\r\n                                    </select>\r\n                                </div>\r\n                                <!-- <div v-if=\"subNode.id === 'node7_subNode0_nestedSubNodeundefined'\">\r\n                                    <select name=\"\" id=\"\" @change=\"props.moveToMap\">\r\n                                        <option :value=\"key\" :data-coordinates=\"item.geometry.coordinates\" v-for=\"(item, key) in props.selectLayerOption[subNode.id]\">\r\n                                            {{ item.properties['事件'] }}\r\n                                        </option>\r\n                                    </select>\r\n                                </div> -->\r\n                            </div>\r\n                        </div>\r\n                        <div v-else>\r\n                            <input type=\"checkbox\"\r\n                            :checked=\"props.currentLayers.some(node=> {\r\n                                let subNodeIds = mapList.getLayerIndex(node.id)\r\n                                return  subNodeIds.nodeIndex == nodeIndex && subNodeIds.subNodeIndex == subNodeIndex\r\n                            })\"\r\n                            @change=\"(e) => {\r\n                                LayerCheckBoxChange(e, {\r\n                                    nodeIndex: nodeIndex,\r\n                                    subNode: subNode,\r\n                                    subNodeIndex: subNodeIndex,\r\n                                    nestedSubNodeIndex: '',\r\n                                    single_tiles: subNode.single_tiles,\r\n                                    id: subNode.id\r\n                                })\r\n                            }\">\r\n                                {{ subNode.title }}\r\n                                <select name=\"\" id=\"\" class=\"ms-3\"\r\n                                v-model=\"state.TilesListValue\"\r\n                                @change=\"(e) => {\r\n                                    LayerCheckBoxChange(e, {\r\n                                        nodeIndex: nodeIndex,\r\n                                        subNode: subNode,\r\n                                        subNodeIndex: subNodeIndex,\r\n                                        nestedSubNodeIndex: state.TilesListValue,\r\n                                        single_tiles: subNode.single_tiles,\r\n                                        id: subNode.id\r\n                                    })\r\n                                }\">\r\n                                    <option :value=\"key\" :id=\"item.id\" v-for=\"(item, key) in subNode.tiles_list\">{{ item.title }}</option>\r\n                                </select>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<style lang=\"sass\" scoped>\r\n.condition\r\n    border-radius: 10px\r\n.closeBtn\r\n    right:10px\r\n    width: 20px\r\n    height: 20px\r\n    padding: 0\r\n    &::after\r\n        content: ''\r\n        background: #fff\r\n        height: 2px\r\n        width: 60%\r\n        display: block\r\n.content\r\n    overflow-y: scroll\r\n    background: #fff\r\n    .landBoundary\r\n        max-height: 500px\r\n    .title\r\n        cursor: pointer\r\n        svg\r\n            transform: rotateZ(0)\r\n        .openTitle\r\n            transform: rotateZ(90deg)\r\n    svg\r\n        width: 20px\r\n        height: 20px\r\n    img\r\n        width: 16px\r\n        height: 16px\r\n    .wrap\r\n        display: none\r\n@media (max-width: 600px)\r\n    .condition\r\n        border-radius: 0\r\n\r\n</style>","export default \"__VITE_ASSET__1efb1f50__\"","export default \"__VITE_ASSET__e9e17f9c__\"","export default \"__VITE_ASSET__9216d299__\"","export default \"__VITE_ASSET__f20fa25d__\"","export default \"__VITE_ASSET__62f11e0f__\"","<script>\r\nimport { useSlots, onBeforeMount, onMounted, onBeforeUnmount, ref, reactive, computed, watch, nextTick, defineAsyncComponent, useCssModule, inject } from 'vue'\r\nimport $ from 'jquery'\r\n\r\nexport default {\r\n    props: {\r\n        currentLayers: {\r\n            type: Array,\r\n            default: []\r\n        },\r\n        mapCount: {\r\n            type: Number,\r\n            default: 1\r\n        },\r\n        dimensionMapStatus: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        onChangeMapCount: {\r\n            type: Function,\r\n            default: ()=>{}\r\n        },\r\n    },\r\n    setup(props, { emit }) {\r\n        const state = reactive({\r\n            toolSwitch: {\r\n                threeDimensionalBtn: false,\r\n                layerConditionBtn: false,\r\n                splitWindowBtn: false,\r\n            },\r\n            targetNum: 1,\r\n        })\r\n\r\n        function toolSwitch(target, value) {\r\n            // 其他全部關掉\r\n            Object.keys(state.toolSwitch).forEach(node => {\r\n                if (node === target) {\r\n                    if(state.toolSwitch[target]) {\r\n                        state.toolSwitch[target] = false\r\n                    } else {\r\n                        state.toolSwitch[target] = true\r\n                    }\r\n                } else {\r\n                    state.toolSwitch[node] = false\r\n                }\r\n            })\r\n        }\r\n        function onLayerControl(action, value) {\r\n            emit('onLayerControl', { action, value })\r\n        }\r\n\r\n        function conditionWrap() {\r\n            emit('conditionWrap')\r\n        }\r\n\r\n        function onChangeTarget(value) {\r\n            state.targetNum = value\r\n            emit('onChangeTarget', value)\r\n        }\r\n\r\n        return {\r\n            props,\r\n            state,\r\n            toolSwitch,\r\n            onLayerControl,\r\n            conditionWrap,\r\n            onChangeTarget\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<template>\r\n    <div>\r\n        <ul class=\"list-unstyled d-inline-flex align-items-center flex-nowrap w-full\">\r\n            <OverLayer :text=\"'圖層操控工具'\" />\r\n            <li class=\"me-4 position-relative\">\r\n                <div class=\"MapFeatureBtn text-white\">\r\n                    <a href=\"\" v-if=\"props.dimensionMapStatus\"\r\n                    @click.prevent=\"toolSwitch('threeDimensionalBtn'), onLayerControl('changeDimensionMap', '3D')\">\r\n                        <img src=\"@/assets/img/icon/2D.svg\">\r\n                    </a>\r\n                    <a href=\"\" v-else\r\n                    @click.prevent=\"toolSwitch('threeDimensionalBtn'), onLayerControl('changeDimensionMap', '2D')\">\r\n                        <img src=\"@/assets/img/icon/3D.svg\">\r\n                    </a>\r\n                </div>\r\n            </li>\r\n            <li class=\"me-4 position-relative\">\r\n                <a href=\"\" class=\"MapFeatureBtn text-white\"\r\n                    @click.prevent=\"toolSwitch('layerConditionBtn'), conditionWrap()\">\r\n                    <img src=\"@/assets/img/icon/baseLayer.svg\" alt=\"\">\r\n                </a>\r\n            </li>\r\n            <li class=\"position-relative\">\r\n                <a href=\"\" class=\"MapFeatureBtn text-white\" @click.prevent=\"toolSwitch('splitWindowBtn')\">\r\n                    <img src=\"@/assets/img/icon/singleWindow.svg\" alt=\"\" v-if=\"props.mapCount === 1\">\r\n                    <img src=\"@/assets/img/icon/doubleWindows.svg\" alt=\"\" v-if=\"props.mapCount === 2\">\r\n                </a>\r\n                <ul class=\"list-unstyled position-absolute start-0 top-100 p-0\" v-if=\"state.toolSwitch.splitWindowBtn\">\r\n                    <li class=\"mt-2\">\r\n                        <a href=\"\" class=\"text-white MapFeatureBtn\" @click.prevent=\"props.onChangeMapCount(1)\">\r\n                            <img src=\"@/assets/img/icon/singleWindow.svg\" alt=\"\">\r\n                        </a>\r\n                    </li>\r\n                    <li class=\"mt-2\">\r\n                        <a href=\"\" class=\"text-white MapFeatureBtn\" @click.prevent=\"props.onChangeMapCount(2)\">\r\n                            <img src=\"@/assets/img/icon/doubleWindows.svg\" alt=\"\">\r\n                        </a>\r\n                    </li>\r\n                </ul>\r\n            </li>\r\n        </ul>\r\n\r\n        <div class=\"switchControl d-flex position-fixed rounded-pill translate-middle-x p-2\" id=\"switchControl\" style=\"z-index: 99;\">\r\n            <OverLayer :text=\"'左右視窗切換工具'\" />\r\n            <div class=\"fs-3 text-white rounded-pill\" :class=\"{ 'active': state.targetNum === 1 }\" @click=\"() => {\r\n                onChangeTarget(1)\r\n            }\">左</div>\r\n            <div class=\"fs-3 text-white rounded-pill\" :class=\"{ 'active': state.targetNum === 2 }\" @click=\"() => {\r\n                onChangeTarget(2)\r\n            }\">右</div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<style lang=\"sass\" scoped>\r\n.MapFeatureBtn\r\n    display: block\r\n    border-radius: 10px\r\n    width: 68px\r\n    height: 68px\r\n    box-sizing: border-box\r\n    img\r\n        width: 100%\r\n        height: 100%\r\n        &:hover\r\n            filter: brightness(0.9)\r\n    svg\r\n        font-size: 24px\r\n        width: 100%\r\n        height: 100%\r\n\r\n.switchControl\r\n    top: 10px\r\n    left: 50%\r\n    background: rgba(30, 30, 30, 0.9)\r\n    box-sizing: border-box\r\n    div\r\n        padding:5px 28px\r\n        cursor: pointer\r\n        box-sizing: border-box\r\n    .active\r\n        background: #247BA0\r\n@media (max-width: 1300px)\r\n    .switchControl\r\n        top: 10px\r\n        left: 80%\r\n\r\n</style>","<script>\r\nimport { useSlots, onBeforeMount, onMounted, onBeforeUnmount, ref, reactive, computed, watch, nextTick, defineAsyncComponent, useCssModule, inject, getCurrentInstance } from 'vue'\r\nimport $ from 'jquery'\r\n\r\nexport default {\r\n    props: {\r\n        baseMapList: {\r\n            type: Array,\r\n            default: []\r\n        },\r\n        onChangeBaseMaps: {\r\n            type: Function,\r\n            default: ()=>{}\r\n        },\r\n    },\r\n    setup(props, { emit }) {\r\n        const state = reactive({\r\n            selectMap: 0,\r\n            mapSourceList: []\r\n        })\r\n\r\n        return {\r\n            state,\r\n            props,\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<template>\r\n    <div>\r\n        <OverLayer :text=\"'底圖切換工具'\" />\r\n        <select name=\"\" id=\"\" v-model=\"state.selectMap\"\r\n        @change=\"(e) => {\r\n            let value = props.baseMapList.find(node=> node.baseId === state.selectMap)\r\n            props.onChangeBaseMaps({ action: 'baseMap', value })\r\n        }\">\r\n            <option v-for=\"(node, nodeIndex) in props.baseMapList\" :key=\"nodeIndex\" :value=\"node.baseId\">{{ node.label }}</option>\r\n        </select>\r\n    </div>\r\n</template>\r\n\r\n<style lang=\"sass\" scoped>\r\nselect\r\n    border: 0\r\n    box-shadow: 0px 4px 4px #999\r\n    border-radius: 5px\r\n    padding: 8px 20px\r\n    option\r\n        padding: 8px 20px\r\n</style>\r\n","export default \"__VITE_ASSET__a8c0f6d0__\"","export default \"__VITE_ASSET__630fe15b__\"","export default \"__VITE_ASSET__7e8d4017__\"","export default \"__VITE_ASSET__0ebcb08a__\"","export default \"__VITE_ASSET__185ae262__\"","<script>\r\nimport { useSlots, onBeforeMount, onMounted, onBeforeUnmount, ref, reactive, computed, watch, nextTick, defineAsyncComponent, useCssModule, inject } from 'vue'\r\nexport default {\r\n    props: {\r\n        id:{\r\n            Type: String,\r\n            default: 0\r\n        },\r\n        map:{}\r\n    },\r\n    setup(props, { emit }){\r\n\r\n        function onMapControl(action) {\r\n            emit('onMapControl', {action})\r\n        }\r\n\r\n        return {\r\n            props,\r\n            onMapControl\r\n        }\r\n    }\r\n}\r\n\r\n</script>\r\n\r\n<template>\r\n    <div class=\"d-flex flex-nowrap flex-column\">\r\n        <OverLayer :text=\"'地圖操控工具'\" />\r\n        <a href=\"#\" class=\"d-none d-sm-block order-1 mb-0\" @click.prevent=\"onMapControl('In')\">\r\n            <img src=\"@/assets/img/icon/zoomIn.svg\" alt=\"zoomIn\">\r\n        </a>\r\n        <a href=\"#\" class=\"d-none d-sm-block order-1 mb-2\" @click.prevent=\"onMapControl('Out')\">\r\n            <img src=\"@/assets/img/icon/zoomOut.svg\" alt=\"zoomOut\">\r\n        </a>\r\n        <a href=\"#\" class=\"order-1 mb-2\" @click.prevent=\"onMapControl('toNorth')\">\r\n            <img src=\"@/assets/img/icon/compass.svg\" alt=\"compass\">\r\n        </a>\r\n        <a href=\"#\" class=\"order-1 mb-2\" @click.prevent=\"onMapControl('moveTo')\">\r\n            <img src=\"@/assets/img/icon/location.svg\" alt=\"location\">\r\n        </a>\r\n        <a href=\"#\" class=\"order-1\" @click.prevent=\"onMapControl('fullScreen')\">\r\n            <img src=\"@/assets/img/icon/zoom.svg\" alt=\"zoom\">\r\n        </a>\r\n    </div>\r\n</template>\r\n\r\n","/**\n * @module ol/interaction/Select\n */\nimport Collection from '../Collection.js';\nimport CollectionEventType from '../CollectionEventType.js';\nimport Event from '../events/Event.js';\nimport Feature from '../Feature.js';\nimport Interaction from './Interaction.js';\nimport VectorLayer from '../layer/Vector.js';\nimport {TRUE} from '../functions.js';\nimport {clear} from '../obj.js';\nimport {createEditingStyle} from '../style/Style.js';\nimport {extend} from '../array.js';\nimport {getUid} from '../util.js';\nimport {never, shiftKeyOnly, singleClick} from '../events/condition.js';\n\n/**\n * @enum {string}\n */\nconst SelectEventType = {\n  /**\n   * Triggered when feature(s) has been (de)selected.\n   * @event SelectEvent#select\n   * @api\n   */\n  SELECT: 'select',\n};\n\n/**\n * A function that takes an {@link module:ol/Feature~Feature} and returns `true` if the feature may be\n * selected or `false` otherwise.\n * @typedef {function(import(\"../Feature.js\").default, import(\"../layer/Layer.js\").default<import(\"../source/Source\").default>):boolean} FilterFunction\n */\n\n/**\n * @typedef {Object} Options\n * @property {import(\"../events/condition.js\").Condition} [addCondition] A function\n * that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled.\n * By default, this is {@link module:ol/events/condition.never}. Use this if you\n * want to use different events for add and remove instead of `toggle`.\n * @property {import(\"../events/condition.js\").Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. This is the event\n * for the selected features as a whole. By default, this is\n * {@link module:ol/events/condition.singleClick}. Clicking on a feature selects that\n * feature and removes any that were in the selection. Clicking outside any\n * feature removes all from the selection.\n * See `toggle`, `add`, `remove` options for adding/removing extra features to/\n * from the selection.\n * @property {Array<import(\"../layer/Layer.js\").default>|function(import(\"../layer/Layer.js\").default<import(\"../source/Source\").default>): boolean} [layers]\n * A list of layers from which features should be selected. Alternatively, a\n * filter function can be provided. The function will be called for each layer\n * in the map and should return `true` for layers that you want to be\n * selectable. If the option is absent, all visible layers will be considered\n * selectable.\n * @property {import(\"../style/Style.js\").StyleLike|null} [style]\n * Style for the selected features. By default the default edit style is used\n * (see {@link module:ol/style/Style~Style}). Set to `null` if this interaction should not apply\n * any style changes for selected features.\n * If set to a falsey value, the selected feature's style will not change.\n * @property {import(\"../events/condition.js\").Condition} [removeCondition] A function\n * that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled.\n * By default, this is {@link module:ol/events/condition.never}. Use this if you\n * want to use different events for add and remove instead of `toggle`.\n * @property {import(\"../events/condition.js\").Condition} [toggleCondition] A function\n * that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. This is in addition\n * to the `condition` event. By default,\n * {@link module:ol/events/condition.shiftKeyOnly}, i.e. pressing `shift` as\n * well as the `condition` event, adds that feature to the current selection if\n * it is not currently selected, and removes it if it is. See `add` and `remove`\n * if you want to use different events instead of a toggle.\n * @property {boolean} [multi=false] A boolean that determines if the default\n * behaviour should select only single features or all (overlapping) features at\n * the clicked map position. The default of `false` means single select.\n * @property {Collection<Feature>} [features]\n * Collection where the interaction will place selected features. Optional. If\n * not set the interaction will create a collection. In any case the collection\n * used by the interaction is returned by\n * {@link module:ol/interaction/Select~Select#getFeatures}.\n * @property {FilterFunction} [filter] A function\n * that takes an {@link module:ol/Feature~Feature} and an\n * {@link module:ol/layer/Layer~Layer} and returns `true` if the feature may be\n * selected or `false` otherwise.\n * @property {number} [hitTolerance=0] Hit-detection tolerance. Pixels inside\n * the radius around the given position will be checked for features.\n */\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/Select~Select} instances are instances of\n * this type.\n */\nexport class SelectEvent extends Event {\n  /**\n   * @param {SelectEventType} type The event type.\n   * @param {Array<import(\"../Feature.js\").default>} selected Selected features.\n   * @param {Array<import(\"../Feature.js\").default>} deselected Deselected features.\n   * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Associated\n   *     {@link module:ol/MapBrowserEvent~MapBrowserEvent}.\n   */\n  constructor(type, selected, deselected, mapBrowserEvent) {\n    super(type);\n\n    /**\n     * Selected features array.\n     * @type {Array<import(\"../Feature.js\").default>}\n     * @api\n     */\n    this.selected = selected;\n\n    /**\n     * Deselected features array.\n     * @type {Array<import(\"../Feature.js\").default>}\n     * @api\n     */\n    this.deselected = deselected;\n\n    /**\n     * Associated {@link module:ol/MapBrowserEvent~MapBrowserEvent}.\n     * @type {import(\"../MapBrowserEvent.js\").default}\n     * @api\n     */\n    this.mapBrowserEvent = mapBrowserEvent;\n  }\n}\n\n/**\n * Original feature styles to reset to when features are no longer selected.\n * @type {Object<number, import(\"../style/Style.js\").default|Array<import(\"../style/Style.js\").default>|import(\"../style/Style.js\").StyleFunction>}\n */\nconst originalFeatureStyles = {};\n\n/***\n * @template Return\n * @typedef {import(\"../Observable\").OnSignature<import(\"../Observable\").EventTypes, import(\"../events/Event.js\").default, Return> &\n *   import(\"../Observable\").OnSignature<import(\"../ObjectEventType\").Types|\n *     'change:active', import(\"../Object\").ObjectEvent, Return> &\n *   import(\"../Observable\").OnSignature<'select', SelectEvent, Return> &\n *   import(\"../Observable\").CombinedOnSignature<import(\"../Observable\").EventTypes|import(\"../ObjectEventType\").Types|\n *     'change:active'|'select', Return>} SelectOnSignature\n */\n\n/**\n * @classdesc\n * Interaction for selecting vector features. By default, selected features are\n * styled differently, so this interaction can be used for visual highlighting,\n * as well as selecting features for other actions, such as modification or\n * output. There are three ways of controlling which features are selected:\n * using the browser event as defined by the `condition` and optionally the\n * `toggle`, `add`/`remove`, and `multi` options; a `layers` filter; and a\n * further feature filter using the `filter` option.\n *\n * @fires SelectEvent\n * @api\n */\nclass Select extends Interaction {\n  /**\n   * @param {Options} [options] Options.\n   */\n  constructor(options) {\n    super();\n\n    /***\n     * @type {SelectOnSignature<import(\"../events\").EventsKey>}\n     */\n    this.on;\n\n    /***\n     * @type {SelectOnSignature<import(\"../events\").EventsKey>}\n     */\n    this.once;\n\n    /***\n     * @type {SelectOnSignature<void>}\n     */\n    this.un;\n\n    options = options ? options : {};\n\n    /**\n     * @private\n     */\n    this.boundAddFeature_ = this.addFeature_.bind(this);\n\n    /**\n     * @private\n     */\n    this.boundRemoveFeature_ = this.removeFeature_.bind(this);\n\n    /**\n     * @private\n     * @type {import(\"../events/condition.js\").Condition}\n     */\n    this.condition_ = options.condition ? options.condition : singleClick;\n\n    /**\n     * @private\n     * @type {import(\"../events/condition.js\").Condition}\n     */\n    this.addCondition_ = options.addCondition ? options.addCondition : never;\n\n    /**\n     * @private\n     * @type {import(\"../events/condition.js\").Condition}\n     */\n    this.removeCondition_ = options.removeCondition\n      ? options.removeCondition\n      : never;\n\n    /**\n     * @private\n     * @type {import(\"../events/condition.js\").Condition}\n     */\n    this.toggleCondition_ = options.toggleCondition\n      ? options.toggleCondition\n      : shiftKeyOnly;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.multi_ = options.multi ? options.multi : false;\n\n    /**\n     * @private\n     * @type {FilterFunction}\n     */\n    this.filter_ = options.filter ? options.filter : TRUE;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.hitTolerance_ = options.hitTolerance ? options.hitTolerance : 0;\n\n    /**\n     * @private\n     * @type {import(\"../style/Style.js\").default|Array<import(\"../style/Style.js\").default>|import(\"../style/Style.js\").StyleFunction|null}\n     */\n    this.style_ =\n      options.style !== undefined ? options.style : getDefaultStyleFunction();\n\n    /**\n     * @private\n     * @type {Collection<Feature>}\n     */\n    this.features_ = options.features || new Collection();\n\n    /** @type {function(import(\"../layer/Layer.js\").default<import(\"../source/Source\").default>): boolean} */\n    let layerFilter;\n    if (options.layers) {\n      if (typeof options.layers === 'function') {\n        layerFilter = options.layers;\n      } else {\n        const layers = options.layers;\n        layerFilter = function (layer) {\n          return layers.includes(layer);\n        };\n      }\n    } else {\n      layerFilter = TRUE;\n    }\n\n    /**\n     * @private\n     * @type {function(import(\"../layer/Layer.js\").default<import(\"../source/Source\").default>): boolean}\n     */\n    this.layerFilter_ = layerFilter;\n\n    /**\n     * An association between selected feature (key)\n     * and layer (value)\n     * @private\n     * @type {Object<string, import(\"../layer/Layer.js\").default>}\n     */\n    this.featureLayerAssociation_ = {};\n  }\n\n  /**\n   * @param {import(\"../Feature.js\").default} feature Feature.\n   * @param {import(\"../layer/Layer.js\").default} layer Layer.\n   * @private\n   */\n  addFeatureLayerAssociation_(feature, layer) {\n    this.featureLayerAssociation_[getUid(feature)] = layer;\n  }\n\n  /**\n   * Get the selected features.\n   * @return {Collection<Feature>} Features collection.\n   * @api\n   */\n  getFeatures() {\n    return this.features_;\n  }\n\n  /**\n   * Returns the Hit-detection tolerance.\n   * @return {number} Hit tolerance in pixels.\n   * @api\n   */\n  getHitTolerance() {\n    return this.hitTolerance_;\n  }\n\n  /**\n   * Returns the associated {@link module:ol/layer/Vector~VectorLayer vector layer} of\n   * a selected feature.\n   * @param {import(\"../Feature.js\").default} feature Feature\n   * @return {import('../layer/Vector.js').default} Layer.\n   * @api\n   */\n  getLayer(feature) {\n    return /** @type {import('../layer/Vector.js').default} */ (\n      this.featureLayerAssociation_[getUid(feature)]\n    );\n  }\n\n  /**\n   * Hit-detection tolerance. Pixels inside the radius around the given position\n   * will be checked for features.\n   * @param {number} hitTolerance Hit tolerance in pixels.\n   * @api\n   */\n  setHitTolerance(hitTolerance) {\n    this.hitTolerance_ = hitTolerance;\n  }\n\n  /**\n   * Remove the interaction from its current map, if any,  and attach it to a new\n   * map, if any. Pass `null` to just remove the interaction from the current map.\n   * @param {import(\"../Map.js\").default|null} map Map.\n   * @api\n   */\n  setMap(map) {\n    const currentMap = this.getMap();\n    if (currentMap && this.style_) {\n      this.features_.forEach(this.restorePreviousStyle_.bind(this));\n    }\n    super.setMap(map);\n    if (map) {\n      this.features_.addEventListener(\n        CollectionEventType.ADD,\n        this.boundAddFeature_\n      );\n      this.features_.addEventListener(\n        CollectionEventType.REMOVE,\n        this.boundRemoveFeature_\n      );\n\n      if (this.style_) {\n        this.features_.forEach(this.applySelectedStyle_.bind(this));\n      }\n    } else {\n      this.features_.removeEventListener(\n        CollectionEventType.ADD,\n        this.boundAddFeature_\n      );\n      this.features_.removeEventListener(\n        CollectionEventType.REMOVE,\n        this.boundRemoveFeature_\n      );\n    }\n  }\n\n  /**\n   * @param {import(\"../Collection.js\").CollectionEvent<Feature>} evt Event.\n   * @private\n   */\n  addFeature_(evt) {\n    const feature = evt.element;\n    if (this.style_) {\n      this.applySelectedStyle_(feature);\n    }\n    if (!this.getLayer(feature)) {\n      const layer = /** @type {VectorLayer} */ (\n        this.getMap()\n          .getAllLayers()\n          .find(function (layer) {\n            if (\n              layer instanceof VectorLayer &&\n              layer.getSource() &&\n              layer.getSource().hasFeature(feature)\n            ) {\n              return layer;\n            }\n          })\n      );\n      if (layer) {\n        this.addFeatureLayerAssociation_(feature, layer);\n      }\n    }\n  }\n\n  /**\n   * @param {import(\"../Collection.js\").CollectionEvent<Feature>} evt Event.\n   * @private\n   */\n  removeFeature_(evt) {\n    if (this.style_) {\n      this.restorePreviousStyle_(evt.element);\n    }\n  }\n\n  /**\n   * @return {import(\"../style/Style.js\").StyleLike|null} Select style.\n   */\n  getStyle() {\n    return this.style_;\n  }\n\n  /**\n   * @param {Feature} feature Feature\n   * @private\n   */\n  applySelectedStyle_(feature) {\n    const key = getUid(feature);\n    if (!(key in originalFeatureStyles)) {\n      originalFeatureStyles[key] = feature.getStyle();\n    }\n    feature.setStyle(this.style_);\n  }\n\n  /**\n   * @param {Feature} feature Feature\n   * @private\n   */\n  restorePreviousStyle_(feature) {\n    const interactions = this.getMap().getInteractions().getArray();\n    for (let i = interactions.length - 1; i >= 0; --i) {\n      const interaction = interactions[i];\n      if (\n        interaction !== this &&\n        interaction instanceof Select &&\n        interaction.getStyle() &&\n        interaction.getFeatures().getArray().lastIndexOf(feature) !== -1\n      ) {\n        feature.setStyle(interaction.getStyle());\n        return;\n      }\n    }\n\n    const key = getUid(feature);\n    feature.setStyle(originalFeatureStyles[key]);\n    delete originalFeatureStyles[key];\n  }\n\n  /**\n   * @param {Feature} feature Feature.\n   * @private\n   */\n  removeFeatureLayerAssociation_(feature) {\n    delete this.featureLayerAssociation_[getUid(feature)];\n  }\n\n  /**\n   * Handles the {@link module:ol/MapBrowserEvent~MapBrowserEvent map browser event} and may change the\n   * selected state of features.\n   * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Map browser event.\n   * @return {boolean} `false` to stop event propagation.\n   */\n  handleEvent(mapBrowserEvent) {\n    if (!this.condition_(mapBrowserEvent)) {\n      return true;\n    }\n    const add = this.addCondition_(mapBrowserEvent);\n    const remove = this.removeCondition_(mapBrowserEvent);\n    const toggle = this.toggleCondition_(mapBrowserEvent);\n    const set = !add && !remove && !toggle;\n    const map = mapBrowserEvent.map;\n    const features = this.getFeatures();\n\n    /**\n     * @type {Array<Feature>}\n     */\n    const deselected = [];\n\n    /**\n     * @type {Array<Feature>}\n     */\n    const selected = [];\n\n    if (set) {\n      // Replace the currently selected feature(s) with the feature(s) at the\n      // pixel, or clear the selected feature(s) if there is no feature at\n      // the pixel.\n      clear(this.featureLayerAssociation_);\n      map.forEachFeatureAtPixel(\n        mapBrowserEvent.pixel,\n        /**\n         * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n         * @param {import(\"../layer/Layer.js\").default} layer Layer.\n         * @return {boolean|undefined} Continue to iterate over the features.\n         */\n        (feature, layer) => {\n          if (!(feature instanceof Feature) || !this.filter_(feature, layer)) {\n            return;\n          }\n          this.addFeatureLayerAssociation_(feature, layer);\n          selected.push(feature);\n          return !this.multi_;\n        },\n        {\n          layerFilter: this.layerFilter_,\n          hitTolerance: this.hitTolerance_,\n        }\n      );\n      for (let i = features.getLength() - 1; i >= 0; --i) {\n        const feature = features.item(i);\n        const index = selected.indexOf(feature);\n        if (index > -1) {\n          // feature is already selected\n          selected.splice(index, 1);\n        } else {\n          features.remove(feature);\n          deselected.push(feature);\n        }\n      }\n      if (selected.length !== 0) {\n        features.extend(selected);\n      }\n    } else {\n      // Modify the currently selected feature(s).\n      map.forEachFeatureAtPixel(\n        mapBrowserEvent.pixel,\n        /**\n         * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n         * @param {import(\"../layer/Layer.js\").default} layer Layer.\n         * @return {boolean|undefined} Continue to iterate over the features.\n         */\n        (feature, layer) => {\n          if (!(feature instanceof Feature) || !this.filter_(feature, layer)) {\n            return;\n          }\n          if ((add || toggle) && !features.getArray().includes(feature)) {\n            this.addFeatureLayerAssociation_(feature, layer);\n            selected.push(feature);\n          } else if (\n            (remove || toggle) &&\n            features.getArray().includes(feature)\n          ) {\n            deselected.push(feature);\n            this.removeFeatureLayerAssociation_(feature);\n          }\n          return !this.multi_;\n        },\n        {\n          layerFilter: this.layerFilter_,\n          hitTolerance: this.hitTolerance_,\n        }\n      );\n      for (let j = deselected.length - 1; j >= 0; --j) {\n        features.remove(deselected[j]);\n      }\n      features.extend(selected);\n    }\n    if (selected.length > 0 || deselected.length > 0) {\n      this.dispatchEvent(\n        new SelectEvent(\n          SelectEventType.SELECT,\n          selected,\n          deselected,\n          mapBrowserEvent\n        )\n      );\n    }\n    return true;\n  }\n}\n\n/**\n * @return {import(\"../style/Style.js\").StyleFunction} Styles.\n */\nfunction getDefaultStyleFunction() {\n  const styles = createEditingStyle();\n  extend(styles['Polygon'], styles['LineString']);\n  extend(styles['GeometryCollection'], styles['LineString']);\n\n  return function (feature) {\n    if (!feature.getGeometry()) {\n      return null;\n    }\n    return styles[feature.getGeometry().getType()];\n  };\n}\n\nexport default Select;\n","/**\n * @module ol/control/ScaleLine\n */\nimport Control from './Control.js';\nimport {CLASS_UNSELECTABLE} from '../css.js';\nimport {METERS_PER_UNIT, getPointResolution} from '../proj.js';\nimport {assert} from '../asserts.js';\n\n/**\n * @type {string}\n */\nconst UNITS_PROP = 'units';\n\n/**\n * @typedef {'degrees' | 'imperial' | 'nautical' | 'metric' | 'us'} Units\n * Units for the scale line.\n */\n\n/**\n * @const\n * @type {Array<number>}\n */\nconst LEADING_DIGITS = [1, 2, 5];\n\n/**\n * @const\n * @type {number}\n */\nconst DEFAULT_DPI = 25.4 / 0.28;\n\n/***\n * @template Return\n * @typedef {import(\"../Observable\").OnSignature<import(\"../Observable\").EventTypes, import(\"../events/Event.js\").default, Return> &\n *   import(\"../Observable\").OnSignature<import(\"../ObjectEventType\").Types|\n *     'change:units', import(\"../Object\").ObjectEvent, Return> &\n *   import(\"../Observable\").CombinedOnSignature<import(\"../Observable\").EventTypes|import(\"../ObjectEventType\").Types\n *     |'change:units', Return>} ScaleLineOnSignature\n */\n\n/**\n * @typedef {Object} Options\n * @property {string} [className] CSS class name. The default is `ol-scale-bar` when configured with\n * `bar: true`. Otherwise the default is `ol-scale-line`.\n * @property {number} [minWidth=64] Minimum width in pixels at the OGC default dpi. The width will be\n * adjusted to match the dpi used.\n * @property {number} [maxWidth] Maximum width in pixels at the OGC default dpi. The width will be\n * adjusted to match the dpi used.\n * @property {function(import(\"../MapEvent.js\").default):void} [render] Function called when the control\n * should be re-rendered. This is called in a `requestAnimationFrame` callback.\n * @property {HTMLElement|string} [target] Specify a target if you want the control\n * to be rendered outside of the map's viewport.\n * @property {Units} [units='metric'] Units.\n * @property {boolean} [bar=false] Render scalebars instead of a line.\n * @property {number} [steps=4] Number of steps the scalebar should use. Use even numbers\n * for best results. Only applies when `bar` is `true`.\n * @property {boolean} [text=false] Render the text scale above of the scalebar. Only applies\n * when `bar` is `true`.\n * @property {number|undefined} [dpi=undefined] dpi of output device such as printer. Only applies\n * when `bar` is `true`. If undefined the OGC default screen pixel size of 0.28mm will be assumed.\n */\n\n/**\n * @classdesc\n * A control displaying rough y-axis distances, calculated for the center of the\n * viewport. For conformal projections (e.g. EPSG:3857, the default view\n * projection in OpenLayers), the scale is valid for all directions.\n * No scale line will be shown when the y-axis distance of a pixel at the\n * viewport center cannot be calculated in the view projection.\n * By default the scale line will show in the bottom left portion of the map,\n * but this can be changed by using the css selector `.ol-scale-line`.\n * When specifying `bar` as `true`, a scalebar will be rendered instead\n * of a scaleline.\n *\n * @api\n */\nclass ScaleLine extends Control {\n  /**\n   * @param {Options} [options] Scale line options.\n   */\n  constructor(options) {\n    options = options ? options : {};\n\n    const element = document.createElement('div');\n    element.style.pointerEvents = 'none';\n\n    super({\n      element: element,\n      render: options.render,\n      target: options.target,\n    });\n\n    /***\n     * @type {ScaleLineOnSignature<import(\"../events\").EventsKey>}\n     */\n    this.on;\n\n    /***\n     * @type {ScaleLineOnSignature<import(\"../events\").EventsKey>}\n     */\n    this.once;\n\n    /***\n     * @type {ScaleLineOnSignature<void>}\n     */\n    this.un;\n\n    const className =\n      options.className !== undefined\n        ? options.className\n        : options.bar\n        ? 'ol-scale-bar'\n        : 'ol-scale-line';\n\n    /**\n     * @private\n     * @type {HTMLElement}\n     */\n    this.innerElement_ = document.createElement('div');\n    this.innerElement_.className = className + '-inner';\n\n    this.element.className = className + ' ' + CLASS_UNSELECTABLE;\n    this.element.appendChild(this.innerElement_);\n\n    /**\n     * @private\n     * @type {?import(\"../View.js\").State}\n     */\n    this.viewState_ = null;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.minWidth_ = options.minWidth !== undefined ? options.minWidth : 64;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.maxWidth_ = options.maxWidth;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.renderedVisible_ = false;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.renderedWidth_ = undefined;\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.renderedHTML_ = '';\n\n    this.addChangeListener(UNITS_PROP, this.handleUnitsChanged_);\n\n    this.setUnits(options.units || 'metric');\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.scaleBar_ = options.bar || false;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.scaleBarSteps_ = options.steps || 4;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.scaleBarText_ = options.text || false;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.dpi_ = options.dpi || undefined;\n  }\n\n  /**\n   * Return the units to use in the scale line.\n   * @return {Units} The units\n   * to use in the scale line.\n   * @observable\n   * @api\n   */\n  getUnits() {\n    return this.get(UNITS_PROP);\n  }\n\n  /**\n   * @private\n   */\n  handleUnitsChanged_() {\n    this.updateElement_();\n  }\n\n  /**\n   * Set the units to use in the scale line.\n   * @param {Units} units The units to use in the scale line.\n   * @observable\n   * @api\n   */\n  setUnits(units) {\n    this.set(UNITS_PROP, units);\n  }\n\n  /**\n   * Specify the dpi of output device such as printer.\n   * @param {number|undefined} dpi The dpi of output device.\n   * @api\n   */\n  setDpi(dpi) {\n    this.dpi_ = dpi;\n  }\n\n  /**\n   * @private\n   */\n  updateElement_() {\n    const viewState = this.viewState_;\n\n    if (!viewState) {\n      if (this.renderedVisible_) {\n        this.element.style.display = 'none';\n        this.renderedVisible_ = false;\n      }\n      return;\n    }\n\n    const center = viewState.center;\n    const projection = viewState.projection;\n    const units = this.getUnits();\n    const pointResolutionUnits = units == 'degrees' ? 'degrees' : 'm';\n    let pointResolution = getPointResolution(\n      projection,\n      viewState.resolution,\n      center,\n      pointResolutionUnits\n    );\n\n    const minWidth =\n      (this.minWidth_ * (this.dpi_ || DEFAULT_DPI)) / DEFAULT_DPI;\n\n    const maxWidth =\n      this.maxWidth_ !== undefined\n        ? (this.maxWidth_ * (this.dpi_ || DEFAULT_DPI)) / DEFAULT_DPI\n        : undefined;\n\n    let nominalCount = minWidth * pointResolution;\n    let suffix = '';\n    if (units == 'degrees') {\n      const metersPerDegree = METERS_PER_UNIT.degrees;\n      nominalCount *= metersPerDegree;\n      if (nominalCount < metersPerDegree / 60) {\n        suffix = '\\u2033'; // seconds\n        pointResolution *= 3600;\n      } else if (nominalCount < metersPerDegree) {\n        suffix = '\\u2032'; // minutes\n        pointResolution *= 60;\n      } else {\n        suffix = '\\u00b0'; // degrees\n      }\n    } else if (units == 'imperial') {\n      if (nominalCount < 0.9144) {\n        suffix = 'in';\n        pointResolution /= 0.0254;\n      } else if (nominalCount < 1609.344) {\n        suffix = 'ft';\n        pointResolution /= 0.3048;\n      } else {\n        suffix = 'mi';\n        pointResolution /= 1609.344;\n      }\n    } else if (units == 'nautical') {\n      pointResolution /= 1852;\n      suffix = 'NM';\n    } else if (units == 'metric') {\n      if (nominalCount < 0.001) {\n        suffix = 'μm';\n        pointResolution *= 1000000;\n      } else if (nominalCount < 1) {\n        suffix = 'mm';\n        pointResolution *= 1000;\n      } else if (nominalCount < 1000) {\n        suffix = 'm';\n      } else {\n        suffix = 'km';\n        pointResolution /= 1000;\n      }\n    } else if (units == 'us') {\n      if (nominalCount < 0.9144) {\n        suffix = 'in';\n        pointResolution *= 39.37;\n      } else if (nominalCount < 1609.344) {\n        suffix = 'ft';\n        pointResolution /= 0.30480061;\n      } else {\n        suffix = 'mi';\n        pointResolution /= 1609.3472;\n      }\n    } else {\n      assert(false, 33); // Invalid units\n    }\n\n    let i = 3 * Math.floor(Math.log(minWidth * pointResolution) / Math.log(10));\n    let count, width, decimalCount;\n    let previousCount, previousWidth, previousDecimalCount;\n    while (true) {\n      decimalCount = Math.floor(i / 3);\n      const decimal = Math.pow(10, decimalCount);\n      count = LEADING_DIGITS[((i % 3) + 3) % 3] * decimal;\n      width = Math.round(count / pointResolution);\n      if (isNaN(width)) {\n        this.element.style.display = 'none';\n        this.renderedVisible_ = false;\n        return;\n      }\n      if (maxWidth !== undefined && width >= maxWidth) {\n        count = previousCount;\n        width = previousWidth;\n        decimalCount = previousDecimalCount;\n        break;\n      } else if (width >= minWidth) {\n        break;\n      }\n      previousCount = count;\n      previousWidth = width;\n      previousDecimalCount = decimalCount;\n      ++i;\n    }\n    const html = this.scaleBar_\n      ? this.createScaleBar(width, count, suffix)\n      : count.toFixed(decimalCount < 0 ? -decimalCount : 0) + ' ' + suffix;\n\n    if (this.renderedHTML_ != html) {\n      this.innerElement_.innerHTML = html;\n      this.renderedHTML_ = html;\n    }\n\n    if (this.renderedWidth_ != width) {\n      this.innerElement_.style.width = width + 'px';\n      this.renderedWidth_ = width;\n    }\n\n    if (!this.renderedVisible_) {\n      this.element.style.display = '';\n      this.renderedVisible_ = true;\n    }\n  }\n\n  /**\n   * @private\n   * @param {number} width The current width of the scalebar.\n   * @param {number} scale The current scale.\n   * @param {string} suffix The suffix to append to the scale text.\n   * @return {string} The stringified HTML of the scalebar.\n   */\n  createScaleBar(width, scale, suffix) {\n    const resolutionScale = this.getScaleForResolution();\n    const mapScale =\n      resolutionScale < 1\n        ? Math.round(1 / resolutionScale).toLocaleString() + ' : 1'\n        : '1 : ' + Math.round(resolutionScale).toLocaleString();\n    const steps = this.scaleBarSteps_;\n    const stepWidth = width / steps;\n    const scaleSteps = [this.createMarker('absolute')];\n    for (let i = 0; i < steps; ++i) {\n      const cls =\n        i % 2 === 0 ? 'ol-scale-singlebar-odd' : 'ol-scale-singlebar-even';\n      scaleSteps.push(\n        '<div>' +\n          '<div ' +\n          `class=\"ol-scale-singlebar ${cls}\" ` +\n          `style=\"width: ${stepWidth}px;\"` +\n          '>' +\n          '</div>' +\n          this.createMarker('relative') +\n          // render text every second step, except when only 2 steps\n          (i % 2 === 0 || steps === 2\n            ? this.createStepText(i, width, false, scale, suffix)\n            : '') +\n          '</div>'\n      );\n    }\n    // render text at the end\n    scaleSteps.push(this.createStepText(steps, width, true, scale, suffix));\n\n    const scaleBarText = this.scaleBarText_\n      ? `<div class=\"ol-scale-text\" style=\"width: ${width}px;\">` +\n        mapScale +\n        '</div>'\n      : '';\n    return scaleBarText + scaleSteps.join('');\n  }\n\n  /**\n   * Creates a marker at given position\n   * @param {'absolute'|'relative'} position The position, absolute or relative\n   * @return {string} The stringified div containing the marker\n   */\n  createMarker(position) {\n    const top = position === 'absolute' ? 3 : -10;\n    return (\n      '<div ' +\n      'class=\"ol-scale-step-marker\" ' +\n      `style=\"position: ${position}; top: ${top}px;\"` +\n      '></div>'\n    );\n  }\n\n  /**\n   * Creates the label for a marker marker at given position\n   * @param {number} i The iterator\n   * @param {number} width The width the scalebar will currently use\n   * @param {boolean} isLast Flag indicating if we add the last step text\n   * @param {number} scale The current scale for the whole scalebar\n   * @param {string} suffix The suffix for the scale\n   * @return {string} The stringified div containing the step text\n   */\n  createStepText(i, width, isLast, scale, suffix) {\n    const length =\n      i === 0 ? 0 : Math.round((scale / this.scaleBarSteps_) * i * 100) / 100;\n    const lengthString = length + (i === 0 ? '' : ' ' + suffix);\n    const margin = i === 0 ? -3 : (width / this.scaleBarSteps_) * -1;\n    const minWidth = i === 0 ? 0 : (width / this.scaleBarSteps_) * 2;\n    return (\n      '<div ' +\n      'class=\"ol-scale-step-text\" ' +\n      'style=\"' +\n      `margin-left: ${margin}px;` +\n      `text-align: ${i === 0 ? 'left' : 'center'};` +\n      `min-width: ${minWidth}px;` +\n      `left: ${isLast ? width + 'px' : 'unset'};` +\n      '\">' +\n      lengthString +\n      '</div>'\n    );\n  }\n\n  /**\n   * Returns the appropriate scale for the given resolution and units.\n   * @return {number} The appropriate scale.\n   */\n  getScaleForResolution() {\n    const resolution = getPointResolution(\n      this.viewState_.projection,\n      this.viewState_.resolution,\n      this.viewState_.center,\n      'm'\n    );\n    const dpi = this.dpi_ || DEFAULT_DPI;\n    const inchesPerMeter = 1000 / 25.4;\n    return resolution * inchesPerMeter * dpi;\n  }\n\n  /**\n   * Update the scale line element.\n   * @param {import(\"../MapEvent.js\").default} mapEvent Map event.\n   * @override\n   */\n  render(mapEvent) {\n    const frameState = mapEvent.frameState;\n    if (!frameState) {\n      this.viewState_ = null;\n    } else {\n      this.viewState_ = frameState.viewState;\n    }\n    this.updateElement_();\n  }\n}\n\nexport default ScaleLine;\n","/**\n * @module olcs.AutoRenderLoop\n */\n\nclass AutoRenderLoop {\n  /**\n   * @constructor\n   * @param {olcs.OLCesium} ol3d\n   */\n  constructor(ol3d) {\n    this.ol3d = ol3d;\n    this.scene_ = ol3d.getCesiumScene();\n    this.canvas_ = this.scene_.canvas;\n    this._boundNotifyRepaintRequired = this.notifyRepaintRequired.bind(this);\n\n    this.repaintEventNames_ = [\n      'mousemove', 'mousedown', 'mouseup',\n      'touchstart', 'touchend', 'touchmove',\n      'pointerdown', 'pointerup', 'pointermove',\n      'wheel'\n    ];\n\n    this.enable();\n  }\n\n  /**\n   * Enable.\n   */\n  enable() {\n    this.scene_.requestRenderMode = true;\n    this.scene_.maximumRenderTimeChange = 1000;\n    for (const repaintKey of this.repaintEventNames_) {\n      this.canvas_.addEventListener(repaintKey, this._boundNotifyRepaintRequired, false);\n    }\n\n    window.addEventListener('resize', this._boundNotifyRepaintRequired, false);\n\n    // Listen for changes on the layer group\n    this.ol3d.getOlMap().getLayerGroup().on('change', this._boundNotifyRepaintRequired);\n  }\n\n  /**\n   * Disable.\n   */\n  disable() {\n    for (const repaintKey of this.repaintEventNames_) {\n      this.canvas_.removeEventListener(repaintKey, this._boundNotifyRepaintRequired, false);\n    }\n\n    window.removeEventListener('resize', this._boundNotifyRepaintRequired, false);\n\n    this.ol3d.getOlMap().getLayerGroup().un('change', this._boundNotifyRepaintRequired);\n    this.scene_.requestRenderMode = false;\n  }\n\n  /**\n   * Restart render loop.\n   * Force a restart of the render loop.\n   * @api\n   */\n  restartRenderLoop() {\n    this.notifyRepaintRequired();\n  }\n\n  notifyRepaintRequired() {\n    this.scene_.requestRender();\n  }\n}\n\n\nexport default AutoRenderLoop;\n","/**\n * Converts radians to to degrees.\n *\n * @param {number} angleInRadians Angle in radians.\n * @return {number} Angle in degrees.\n */\nexport function toDegrees(angleInRadians) {\n  return angleInRadians * 180 / Math.PI;\n}\n\n\n/**\n * Converts degrees to radians.\n *\n * @param {number} angleInDegrees Angle in degrees.\n * @return {number} Angle in radians.\n */\nexport function toRadians(angleInDegrees) {\n  return angleInDegrees * Math.PI / 180;\n}\n","/**\n * @module olcs.Camera\n */\n\nimport {unByKey as olObservableUnByKey} from 'ol/Observable.js';\nimport {toRadians, toDegrees} from './math.js';\nimport {getTransform} from 'ol/proj.js';\nimport olcsCore, {calcDistanceForResolution, calcResolutionForDistance} from './core.js';\n\nclass Camera {\n  /**\n   * This object takes care of additional 3d-specific properties of the view and\n   * ensures proper synchronization with the underlying raw Cesium.Camera object.\n   * @param {!Cesium.Scene} scene\n   * @param {!ol.Map} map\n   * @api\n   */\n  constructor(scene, map) {\n    /**\n     * @type {!Cesium.Scene}\n     * @private\n     */\n    this.scene_ = scene;\n\n    /**\n     * @type {!Cesium.Camera}\n     * @private\n     */\n    this.cam_ = scene.camera;\n\n    /**\n     * @type {!ol.Map}\n     * @private\n     */\n    this.map_ = map;\n\n    /**\n     * @type {?ol.View}\n     * @private\n     */\n    this.view_ = null;\n\n    /**\n     * @type {?ol.EventsKey}\n     * @private\n     */\n    this.viewListenKey_ = null;\n\n    /**\n     * @type {!ol.TransformFunction}\n     * @private\n     */\n    this.toLonLat_ = Camera.identityProjection;\n\n    /**\n     * @type {!ol.TransformFunction}\n     * @private\n     */\n    this.fromLonLat_ = Camera.identityProjection;\n\n    /**\n     * 0 -- topdown, PI/2 -- the horizon\n     * @type {number}\n     * @private\n     */\n    this.tilt_ = 0;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.distance_ = 0;\n\n    /**\n     * @type {?Cesium.Matrix4}\n     * @private\n     */\n    this.lastCameraViewMatrix_ = null;\n\n    /**\n     * This is used to discard change events on view caused by updateView method.\n     * @type {boolean}\n     * @private\n     */\n    this.viewUpdateInProgress_ = false;\n\n    this.map_.on('change:view', (e) => {\n      this.setView_(this.map_.getView());\n    });\n    this.setView_(this.map_.getView());\n  }\n\n  /**\n   * @param {Array.<number>} input Input coordinate array.\n   * @param {Array.<number>=} opt_output Output array of coordinate values.\n   * @param {number=} opt_dimension Dimension.\n   * @return {Array.<number>} Input coordinate array (same array as input).\n   */\n  static identityProjection(input, opt_output, opt_dimension) {\n    const dim = opt_dimension || input.length;\n    if (opt_output) {\n      for (let i = 0; i < dim; ++i) {\n        opt_output[i] = input[i];\n      }\n    }\n    return input;\n  }\n\n  /**\n   * @param {?ol.View} view New view to use.\n   * @private\n   */\n  setView_(view) {\n    if (this.view_) {\n      olObservableUnByKey(this.viewListenKey_);\n      this.viewListenKey_ = null;\n    }\n\n    this.view_ = view;\n    if (view) {\n      const toLonLat = getTransform(view.getProjection(), 'EPSG:4326');\n      const fromLonLat = getTransform('EPSG:4326', view.getProjection());\n      console.assert(toLonLat && fromLonLat);\n\n      this.toLonLat_ = toLonLat;\n      this.fromLonLat_ = fromLonLat;\n\n      this.viewListenKey_ = view.on('propertychange', e => this.handleViewEvent_(e));\n\n      this.readFromView();\n    } else {\n      this.toLonLat_ = Camera.identityProjection;\n      this.fromLonLat_ = Camera.identityProjection;\n    }\n  }\n\n  /**\n   * @param {?} e\n   * @private\n   */\n  handleViewEvent_(e) {\n    if (!this.viewUpdateInProgress_) {\n      this.readFromView();\n    }\n  }\n\n  /**\n   * @param {number} heading In radians.\n   * @api\n   */\n  setHeading(heading) {\n    if (!this.view_) {\n      return;\n    }\n\n    this.view_.setRotation(heading);\n  }\n\n  /**\n   * @return {number|undefined} Heading in radians.\n   * @api\n   */\n  getHeading() {\n    if (!this.view_) {\n      return undefined;\n    }\n    const rotation = this.view_.getRotation();\n    return rotation || 0;\n  }\n\n  /**\n   * @param {number} tilt In radians.\n   * @api\n   */\n  setTilt(tilt) {\n    this.tilt_ = tilt;\n    this.updateCamera_();\n  }\n\n  /**\n   * @return {number} Tilt in radians.\n   * @api\n   */\n  getTilt() {\n    return this.tilt_;\n  }\n\n  /**\n   * @param {number} distance In meters.\n   * @api\n   */\n  setDistance(distance) {\n    this.distance_ = distance;\n    this.updateCamera_();\n    this.updateView();\n  }\n\n  /**\n   * @return {number} Distance in meters.\n   * @api\n   */\n  getDistance() {\n    return this.distance_;\n  }\n\n  /**\n   * Shortcut for ol.View.setCenter().\n   * @param {!ol.Coordinate} center Same projection as the ol.View.\n   * @api\n   */\n  setCenter(center) {\n    if (!this.view_) {\n      return;\n    }\n    this.view_.setCenter(center);\n  }\n\n  /**\n   * Shortcut for ol.View.getCenter().\n   * @return {ol.Coordinate|undefined} Same projection as the ol.View.\n   * @api\n   */\n  getCenter() {\n    if (!this.view_) {\n      return undefined;\n    }\n    return this.view_.getCenter();\n  }\n\n  /**\n   * Sets the position of the camera.\n   * @param {!ol.Coordinate} position Same projection as the ol.View.\n   * @api\n   */\n  setPosition(position) {\n    if (!this.toLonLat_) {\n      return;\n    }\n    const ll = this.toLonLat_(position);\n    console.assert(ll);\n\n    const carto = new Cesium.Cartographic(\n        toRadians(ll[0]),\n        toRadians(ll[1]),\n        this.getAltitude());\n\n    this.cam_.setView({\n      destination: Cesium.Ellipsoid.WGS84.cartographicToCartesian(carto)\n    });\n    this.updateView();\n  }\n\n  /**\n   * Calculates position under the camera.\n   * @return {!ol.Coordinate|undefined} Same projection as the ol.View.\n   * @api\n   */\n  getPosition() {\n    if (!this.fromLonLat_) {\n      return undefined;\n    }\n    const carto = Cesium.Ellipsoid.WGS84.cartesianToCartographic(this.cam_.position);\n\n    const pos = this.fromLonLat_([\n      toDegrees(carto.longitude),\n      toDegrees(carto.latitude)\n    ]);\n    console.assert(pos);\n    return pos;\n  }\n\n  /**\n   * @param {number} altitude In meters.\n   * @api\n   */\n  setAltitude(altitude) {\n    const carto = Cesium.Ellipsoid.WGS84.cartesianToCartographic(\n        this.cam_.position);\n    carto.height = altitude;\n    this.cam_.position = Cesium.Ellipsoid.WGS84.cartographicToCartesian(carto);\n\n    this.updateView();\n  }\n\n  /**\n   * @return {number} Altitude in meters.\n   * @api\n   */\n  getAltitude() {\n    const carto = Cesium.Ellipsoid.WGS84.cartesianToCartographic(\n        this.cam_.position);\n\n    return carto.height;\n  }\n\n  /**\n   * Updates the state of the underlying Cesium.Camera\n   * according to the current values of the properties.\n   * @private\n   */\n  updateCamera_() {\n    if (!this.view_ || !this.toLonLat_) {\n      return;\n    }\n    const center = this.view_.getCenter();\n    if (!center) {\n      return;\n    }\n    const ll = this.toLonLat_(center);\n    console.assert(ll);\n\n    const carto = new Cesium.Cartographic(toRadians(ll[0]),\n        toRadians(ll[1]));\n    if (this.scene_.globe) {\n      const height = this.scene_.globe.getHeight(carto);\n      carto.height = height || 0;\n    }\n\n    const destination = Cesium.Ellipsoid.WGS84.cartographicToCartesian(carto);\n\n    /** @type {Cesium.optionsOrientation} */\n    const orientation = {\n      pitch: this.tilt_ - Cesium.Math.PI_OVER_TWO,\n      heading: -this.view_.getRotation(),\n      roll: undefined\n    };\n    this.cam_.setView({\n      destination,\n      orientation\n    });\n\n    this.cam_.moveBackward(this.distance_);\n\n    this.checkCameraChange(true);\n  }\n\n  /**\n   * Calculates the values of the properties from the current ol.View state.\n   * @api\n   */\n  readFromView() {\n    if (!this.view_ || !this.toLonLat_) {\n      return;\n    }\n    const center = this.view_.getCenter();\n    if (center === undefined || center === null) {\n      return;\n    }\n    const ll = this.toLonLat_(center);\n    console.assert(ll);\n\n    const resolution = this.view_.getResolution();\n    this.distance_ = this.calcDistanceForResolution(\n        resolution || 0, toRadians(ll[1]));\n\n    this.updateCamera_();\n  }\n\n  /**\n   * Calculates the values of the properties from the current Cesium.Camera state.\n   * Modifies the center, resolution and rotation properties of the view.\n   * @api\n   */\n  updateView() {\n    if (!this.view_ || !this.fromLonLat_) {\n      return;\n    }\n    this.viewUpdateInProgress_ = true;\n\n    // target & distance\n    const ellipsoid = Cesium.Ellipsoid.WGS84;\n    const scene = this.scene_;\n    const target = olcsCore.pickCenterPoint(scene);\n\n    let bestTarget = target;\n    if (!bestTarget) {\n      //TODO: how to handle this properly ?\n      const globe = scene.globe;\n      const carto = this.cam_.positionCartographic.clone();\n      const height = globe.getHeight(carto);\n      carto.height = height || 0;\n      bestTarget = Cesium.Ellipsoid.WGS84.cartographicToCartesian(carto);\n    }\n    this.distance_ = Cesium.Cartesian3.distance(bestTarget, this.cam_.position);\n    const bestTargetCartographic = ellipsoid.cartesianToCartographic(bestTarget);\n    this.view_.setCenter(this.fromLonLat_([\n      toDegrees(bestTargetCartographic.longitude),\n      toDegrees(bestTargetCartographic.latitude)]));\n\n    // resolution\n    this.view_.setResolution(\n        this.calcResolutionForDistance(this.distance_,\n            bestTargetCartographic ? bestTargetCartographic.latitude : 0));\n\n\n    /*\n     * Since we are positioning the target, the values of heading and tilt\n     * need to be calculated _at the target_.\n     */\n    if (target) {\n      const pos = this.cam_.position;\n\n      // normal to the ellipsoid at the target\n      const targetNormal = new Cesium.Cartesian3();\n      ellipsoid.geocentricSurfaceNormal(target, targetNormal);\n\n      // vector from the target to the camera\n      const targetToCamera = new Cesium.Cartesian3();\n      Cesium.Cartesian3.subtract(pos, target, targetToCamera);\n      Cesium.Cartesian3.normalize(targetToCamera, targetToCamera);\n\n\n      // HEADING\n      const up = this.cam_.up;\n      const right = this.cam_.right;\n      const normal = new Cesium.Cartesian3(-target.y, target.x, 0); // what is it?\n      const heading = Cesium.Cartesian3.angleBetween(right, normal);\n      const cross = Cesium.Cartesian3.cross(target, up, new Cesium.Cartesian3());\n      const orientation = cross.z;\n\n      this.view_.setRotation((orientation < 0 ? heading : -heading));\n\n      // TILT\n      const tiltAngle = Math.acos(\n          Cesium.Cartesian3.dot(targetNormal, targetToCamera));\n      this.tilt_ = isNaN(tiltAngle) ? 0 : tiltAngle;\n    } else {\n      // fallback when there is no target\n      this.view_.setRotation(this.cam_.heading);\n      this.tilt_ = -this.cam_.pitch + Math.PI / 2;\n    }\n\n    this.viewUpdateInProgress_ = false;\n  }\n\n  /**\n   * Check if the underlying camera state has changed and ensure synchronization.\n   * @param {boolean=} opt_dontSync Do not synchronize the view.\n   */\n  checkCameraChange(opt_dontSync) {\n    const old = this.lastCameraViewMatrix_;\n    const current = this.cam_.viewMatrix;\n\n    if (!old || !Cesium.Matrix4.equalsEpsilon(old, current, 1e-5)) {\n      this.lastCameraViewMatrix_ = current.clone();\n      if (opt_dontSync !== true) {\n        this.updateView();\n      }\n    }\n  }\n\n  /**\n   * calculate the distance between camera and centerpoint based on the resolution and latitude value\n   * @param {number} resolution Number of map units per pixel.\n   * @param {number} latitude Latitude in radians.\n   * @return {number} The calculated distance.\n   * @api\n   */\n  calcDistanceForResolution(resolution, latitude) {\n    return calcDistanceForResolution(resolution, latitude, this.scene_, this.view_.getProjection());\n  }\n\n  /**\n   * calculate the resolution based on a distance(camera to position) and latitude value\n   * @param {number} distance\n   * @param {number} latitude\n   * @return {number} The calculated resolution.\n   * @api\n   */\n  calcResolutionForDistance(distance, latitude) {\n    return calcResolutionForDistance(distance, latitude, this.scene_, this.view_.getProjection());\n  }\n}\n\n\nexport default Camera;\n","/**\n * @module olcs.AbstractSynchronizer\n */\nimport {unByKey as olObservableUnByKey} from 'ol/Observable.js';\nimport olLayerGroup from 'ol/layer/Group.js';\nimport {olcsListen, getUid} from './util.js';\n\n\nclass AbstractSynchronizer {\n  /**\n   * @param {!ol.Map} map\n   * @param {!Cesium.Scene} scene\n   * @template T\n   * @abstract\n   * @api\n   */\n  constructor(map, scene) {\n    /**\n     * @type {!ol.Map}\n     * @protected\n     */\n    this.map = map;\n\n    /**\n     * @type {ol.View}\n     * @protected\n     */\n    this.view = map.getView();\n\n    /**\n     * @type {!Cesium.Scene}\n     * @protected\n     */\n    this.scene = scene;\n\n    /**\n     * @type {ol.Collection.<ol.layer.Base>}\n     * @protected\n     */\n    this.olLayers = map.getLayerGroup().getLayers();\n\n    /**\n     * @type {ol.layer.Group}\n     */\n    this.mapLayerGroup = map.getLayerGroup();\n\n    /**\n     * Map of OpenLayers layer ids (from getUid) to the Cesium ImageryLayers.\n     * Null value means, that we are unable to create equivalent layers.\n     * @type {Object.<string, ?Array.<T>>}\n     * @protected\n     */\n    this.layerMap = {};\n\n    /**\n     * Map of listen keys for OpenLayers layer layers ids (from getUid).\n     * @type {!Object.<string, Array<ol.EventsKey>>}\n     * @protected\n     */\n    this.olLayerListenKeys = {};\n\n    /**\n     * Map of listen keys for OpenLayers layer groups ids (from getUid).\n     * @type {!Object.<string, !Array.<ol.EventsKey>>}\n     * @private\n     */\n    this.olGroupListenKeys_ = {};\n  }\n\n  /**\n   * Destroy all and perform complete synchronization of the layers.\n   * @api\n   */\n  synchronize() {\n    this.destroyAll();\n    this.addLayers_(this.mapLayerGroup);\n  }\n\n  /**\n   * Order counterparts using the same algorithm as the Openlayers renderer:\n   * z-index then original sequence order.\n   * @protected\n   */\n  orderLayers() {\n    // Ordering logics is handled in subclasses.\n  }\n\n  /**\n   * Add a layer hierarchy.\n   * @param {ol.layer.Base} root\n   * @private\n   */\n  addLayers_(root) {\n    /** @type {Array<import('olsc/core.js').LayerWithParents>} */\n    const fifo = [{\n      layer: root,\n      parents: []\n    }];\n    while (fifo.length > 0) {\n      const olLayerWithParents = fifo.splice(0, 1)[0];\n      const olLayer = olLayerWithParents.layer;\n      const olLayerId = getUid(olLayer).toString();\n      this.olLayerListenKeys[olLayerId] = [];\n      console.assert(!this.layerMap[olLayerId]);\n\n      let cesiumObjects = null;\n      if (olLayer instanceof olLayerGroup) {\n        this.listenForGroupChanges_(olLayer);\n        if (olLayer !== this.mapLayerGroup) {\n          cesiumObjects = this.createSingleLayerCounterparts(olLayerWithParents);\n        }\n        if (!cesiumObjects) {\n          olLayer.getLayers().forEach((l) => {\n            if (l) {\n              const newOlLayerWithParents = {\n                layer: l,\n                parents: olLayer === this.mapLayerGroup ?\n                  [] :\n                  [olLayerWithParents.layer].concat(olLayerWithParents.parents)\n              };\n              fifo.push(newOlLayerWithParents);\n            }\n          });\n        }\n      } else {\n        cesiumObjects = this.createSingleLayerCounterparts(olLayerWithParents);\n        if (!cesiumObjects) {\n          // keep an eye on the layers that once failed to be added (might work when the layer is updated)\n          // for example when a source is set after the layer is added to the map\n          const layerId = olLayerId;\n          const layerWithParents = olLayerWithParents;\n          const onLayerChange = (e) => {\n            const cesiumObjs = this.createSingleLayerCounterparts(layerWithParents);\n            if (cesiumObjs) {\n              // unsubscribe event listener\n              layerWithParents.layer.un('change', onLayerChange);\n              this.addCesiumObjects_(cesiumObjs, layerId, layerWithParents.layer);\n              this.orderLayers();\n            }\n          };\n          this.olLayerListenKeys[olLayerId].push(olcsListen(layerWithParents.layer, 'change', onLayerChange));\n        }\n      }\n      // add Cesium layers\n      if (cesiumObjects) {\n        this.addCesiumObjects_(cesiumObjects, olLayerId, olLayer);\n      }\n    }\n\n    this.orderLayers();\n  }\n\n  /**\n   * Add Cesium objects.\n   * @param {Array.<T>} cesiumObjects\n   * @param {string} layerId\n   * @param {ol.layer.Base} layer\n   * @private\n   */\n  addCesiumObjects_(cesiumObjects, layerId, layer) {\n    this.layerMap[layerId] = cesiumObjects;\n    this.olLayerListenKeys[layerId].push(olcsListen(layer, 'change:zIndex', () => this.orderLayers()));\n    cesiumObjects.forEach((cesiumObject) => {\n      this.addCesiumObject(cesiumObject);\n    });\n  }\n\n  /**\n   * Remove and destroy a single layer.\n   * @param {ol.layer.Layer} layer\n   * @return {boolean} counterpart destroyed\n   * @private\n   */\n  removeAndDestroySingleLayer_(layer) {\n    const uid = getUid(layer).toString();\n    const counterparts = this.layerMap[uid];\n    if (!!counterparts) {\n      counterparts.forEach((counterpart) => {\n        this.removeSingleCesiumObject(counterpart, false);\n        this.destroyCesiumObject(counterpart);\n      });\n      this.olLayerListenKeys[uid].forEach(olObservableUnByKey);\n      delete this.olLayerListenKeys[uid];\n    }\n    delete this.layerMap[uid];\n    return !!counterparts;\n  }\n\n  /**\n   * Unlisten a single layer group.\n   * @param {ol.layer.Group} group\n   * @private\n   */\n  unlistenSingleGroup_(group) {\n    if (group === this.mapLayerGroup) {\n      return;\n    }\n    const uid = getUid(group).toString();\n    const keys = this.olGroupListenKeys_[uid];\n    keys.forEach((key) => {\n      olObservableUnByKey(key);\n    });\n    delete this.olGroupListenKeys_[uid];\n    delete this.layerMap[uid];\n  }\n\n  /**\n   * Remove layer hierarchy.\n   * @param {ol.layer.Base} root\n   * @private\n   */\n  removeLayer_(root) {\n    if (!!root) {\n      const fifo = [root];\n      while (fifo.length > 0) {\n        const olLayer = fifo.splice(0, 1)[0];\n        const done = this.removeAndDestroySingleLayer_(olLayer);\n        if (olLayer instanceof olLayerGroup) {\n          this.unlistenSingleGroup_(olLayer);\n          if (!done) {\n            // No counterpart for the group itself so removing\n            // each of the child layers.\n            olLayer.getLayers().forEach((l) => {\n              fifo.push(l);\n            });\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * Register listeners for single layer group change.\n   * @param {ol.layer.Group} group\n   * @private\n   */\n  listenForGroupChanges_(group) {\n    const uuid = getUid(group).toString();\n\n    console.assert(this.olGroupListenKeys_[uuid] === undefined);\n\n    const listenKeyArray = [];\n    this.olGroupListenKeys_[uuid] = listenKeyArray;\n\n    // only the keys that need to be relistened when collection changes\n    let contentKeys = [];\n    const listenAddRemove = (function() {\n      const collection = group.getLayers();\n      if (collection) {\n        contentKeys = [\n          collection.on('add', (event) => {\n            this.addLayers_(event.element);\n          }),\n          collection.on('remove', (event) => {\n            this.removeLayer_(event.element);\n          })\n        ];\n        listenKeyArray.push(...contentKeys);\n      }\n    }).bind(this);\n\n    listenAddRemove();\n\n    listenKeyArray.push(group.on('change:layers', (e) => {\n      contentKeys.forEach((el) => {\n        const i = listenKeyArray.indexOf(el);\n        if (i >= 0) {\n          listenKeyArray.splice(i, 1);\n        }\n        olObservableUnByKey(el);\n      });\n      listenAddRemove();\n    }));\n  }\n\n  /**\n   * Destroys all the created Cesium objects.\n   * @protected\n   */\n  destroyAll() {\n    this.removeAllCesiumObjects(true); // destroy\n    let objKey;\n    for (objKey in this.olGroupListenKeys_) {\n      const keys = this.olGroupListenKeys_[objKey];\n      keys.forEach(olObservableUnByKey);\n    }\n    for (objKey in this.olLayerListenKeys) {\n      this.olLayerListenKeys[objKey].forEach(olObservableUnByKey);\n    }\n    this.olGroupListenKeys_ = {};\n    this.olLayerListenKeys = {};\n    this.layerMap = {};\n  }\n\n  /**\n   * Adds a single Cesium object to the collection.\n   * @param {!T} object\n   * @abstract\n   * @protected\n   */\n  addCesiumObject(object) {}\n\n  /**\n   * @param {!T} object\n   * @abstract\n   * @protected\n   */\n  destroyCesiumObject(object) {}\n\n  /**\n   * Remove single Cesium object from the collection.\n   * @param {!T} object\n   * @param {boolean} destroy\n   * @abstract\n   * @protected\n   */\n  removeSingleCesiumObject(object, destroy) {}\n\n  /**\n   * Remove all Cesium objects from the collection.\n   * @param {boolean} destroy\n   * @abstract\n   * @protected\n   */\n  removeAllCesiumObjects(destroy) {}\n\n  /**\n   * @param {import('olsc/core.js').LayerWithParents} olLayerWithParents\n   * @return {?Array.<T>}\n   * @abstract\n   * @protected\n   */\n  createSingleLayerCounterparts(olLayerWithParents) {}\n}\n\n\nexport default AbstractSynchronizer;\n","/**\n * @module olcs.RasterSynchronizer\n */\nimport olLayerGroup from 'ol/layer/Group.js';\nimport {getUid, stableSort} from './util.js';\nimport olcsAbstractSynchronizer from './AbstractSynchronizer.js';\nimport olcsCore from './core.js';\n\nclass RasterSynchronizer extends olcsAbstractSynchronizer {\n  /**\n   * This object takes care of one-directional synchronization of\n   * Openlayers raster layers to the given Cesium globe.\n   * @param {!ol.Map} map\n   * @param {!Cesium.Scene} scene\n   * @constructor\n   * @extends {olcsAbstractSynchronizer.<Cesium.ImageryLayer>}\n   * @api\n   */\n  constructor(map, scene) {\n    super(map, scene);\n\n    /**\n     * @type {!Cesium.ImageryLayerCollection}\n     * @private\n     */\n    this.cesiumLayers_ = scene.imageryLayers;\n\n    /**\n     * @type {!Cesium.ImageryLayerCollection}\n     * @private\n     */\n    this.ourLayers_ = new Cesium.ImageryLayerCollection();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  addCesiumObject(object) {\n    this.cesiumLayers_.add(object);\n    this.ourLayers_.add(object);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  destroyCesiumObject(object) {\n    object.destroy();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  removeSingleCesiumObject(object, destroy) {\n    this.cesiumLayers_.remove(object, destroy);\n    this.ourLayers_.remove(object, false);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  removeAllCesiumObjects(destroy) {\n    for (let i = 0; i < this.ourLayers_.length; ++i) {\n      this.cesiumLayers_.remove(this.ourLayers_.get(i), destroy);\n    }\n    this.ourLayers_.removeAll(false);\n  }\n\n  /**\n   * Creates an array of Cesium.ImageryLayer.\n   * May be overriden by child classes to implement custom behavior.\n   * The default implementation handles tiled imageries in EPSG:4326 or\n   * EPSG:3859.\n   * @param {!ol.layer.Base} olLayer\n   * @param {!ol.proj.Projection} viewProj Projection of the view.\n   * @return {?Array.<!Cesium.ImageryLayer>} array or null if not possible\n   * (or supported)\n   * @protected\n   */\n  convertLayerToCesiumImageries(olLayer, viewProj) {\n    const result = olcsCore.tileLayerToImageryLayer(this.map, olLayer, viewProj);\n    return result ? [result] : null;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  createSingleLayerCounterparts(olLayerWithParents) {\n    const olLayer = olLayerWithParents.layer;\n    const uid = getUid(olLayer).toString();\n    const viewProj = this.view.getProjection();\n    console.assert(viewProj);\n    const cesiumObjects = this.convertLayerToCesiumImageries(olLayer, viewProj);\n    if (cesiumObjects) {\n      const listenKeyArray = [];\n      [olLayerWithParents.layer].concat(olLayerWithParents.parents).forEach((olLayerItem) => {\n        listenKeyArray.push(olLayerItem.on(['change:opacity', 'change:visible'], () => {\n          // the compiler does not seem to be able to infer this\n          console.assert(cesiumObjects);\n          for (let i = 0; i < cesiumObjects.length; ++i) {\n            olcsCore.updateCesiumLayerProperties(olLayerWithParents, cesiumObjects[i]);\n          }\n        }));\n      });\n\n      if (olLayer.getStyleFunction) {\n        let previousStyleFunction = olLayer.getStyleFunction();\n        // there is no convenient way to detect a style function change in OL\n        listenKeyArray.push(olLayer.on('change', () => {\n          const currentStyleFunction = olLayer.getStyleFunction();\n          if (previousStyleFunction === currentStyleFunction) {\n            return;\n          }\n          previousStyleFunction = currentStyleFunction;\n          for (let i = 0; i < cesiumObjects.length; ++i) {\n            const csObj = cesiumObjects[i];\n            // clear cache and set new style\n            if (csObj._imageryCache && csObj.imageryProvider.cache_) {\n              csObj._imageryCache = {};\n              csObj.imageryProvider.cache_ = {};\n              csObj.imageryProvider.styleFunction_ = currentStyleFunction;\n            }\n          }\n          this.scene.requestRender();\n        }));\n      }\n\n      for (let i = 0; i < cesiumObjects.length; ++i) {\n        olcsCore.updateCesiumLayerProperties(olLayerWithParents, cesiumObjects[i]);\n      }\n\n      // there is no way to modify Cesium layer extent,\n      // we have to recreate when OpenLayers layer extent changes:\n      listenKeyArray.push(olLayer.on('change:extent', (e) => {\n        for (let i = 0; i < cesiumObjects.length; ++i) {\n          this.cesiumLayers_.remove(cesiumObjects[i], true); // destroy\n          this.ourLayers_.remove(cesiumObjects[i], false);\n        }\n        delete this.layerMap[getUid(olLayer)]; // invalidate the map entry\n        this.synchronize();\n      }));\n\n      listenKeyArray.push(olLayer.on('change', (e) => {\n        // when the source changes, re-add the layer to force update\n        for (let i = 0; i < cesiumObjects.length; ++i) {\n          const position = this.cesiumLayers_.indexOf(cesiumObjects[i]);\n          if (position >= 0) {\n            this.cesiumLayers_.remove(cesiumObjects[i], false);\n            this.cesiumLayers_.add(cesiumObjects[i], position);\n          }\n        }\n      }));\n\n      this.olLayerListenKeys[uid].push(...listenKeyArray);\n    }\n\n    return Array.isArray(cesiumObjects) ? cesiumObjects : null;\n  }\n\n  /**\n   * Order counterparts using the same algorithm as the Openlayers renderer:\n   * z-index then original sequence order.\n   * @override\n   * @protected\n   */\n  orderLayers() {\n    const layers = [];\n    const zIndices = {};\n    const queue = [this.mapLayerGroup];\n\n    while (queue.length > 0) {\n      const olLayer = queue.splice(0, 1)[0];\n      layers.push(olLayer);\n      zIndices[getUid(olLayer)] = olLayer.getZIndex() || 0;\n\n      if (olLayer instanceof olLayerGroup) {\n        const sublayers = olLayer.getLayers();\n        if (sublayers) {\n          // Prepend queue with sublayers in order\n          queue.unshift(...sublayers.getArray());\n        }\n      }\n    }\n\n    stableSort(layers, (layer1, layer2) =>\n      zIndices[getUid(layer1)] - zIndices[getUid(layer2)]\n    );\n\n    layers.forEach((olLayer) => {\n      const olLayerId = getUid(olLayer).toString();\n      const cesiumObjects = this.layerMap[olLayerId];\n      if (cesiumObjects) {\n        cesiumObjects.forEach((cesiumObject) => { this.raiseToTop(cesiumObject); });\n      }\n    });\n  }\n\n  /**\n   * @param {Cesium.ImageryLayer} counterpart\n   */\n  raiseToTop(counterpart) {\n    this.cesiumLayers_.raiseToTop(counterpart);\n  }\n}\n\n\nexport default RasterSynchronizer;\n","/**\n * @module olcs.core.VectorLayerCounterpart\n */\nimport {unByKey as olObservableUnByKey} from 'ol/Observable.js';\n\n\n/**\n * Context for feature conversion.\n * @typedef {Object} OlFeatureToCesiumContext\n * @property {!(import('ol/Projection.js').default|string)} projection\n * @property {!Cesium.PrimitiveCollection} primitives\n * @property {Object<number, Array<!Cesium.Primitive|!Cesium.Billboard>>} featureToCesiumMap\n * @property {!Cesium.BillboardCollection} billboards\n */\n\n\nclass VectorLayerCounterpart {\n  /**\n  * Result of the conversion of an OpenLayers layer to Cesium.\n  * @param {!(ol.proj.Projection|string)} layerProjection\n  * @param {!Cesium.Scene} scene\n  */\n  constructor(layerProjection, scene) {\n    const billboards = new Cesium.BillboardCollection({scene});\n    const primitives = new Cesium.PrimitiveCollection();\n\n    /**\n    * @type {!Array.<ol.EventsKey>}\n    */\n    this.olListenKeys = [];\n\n    this.rootCollection_ = new Cesium.PrimitiveCollection();\n    /**\n    * @type {!OlFeatureToCesiumContext}\n    */\n    this.context = {\n      projection: layerProjection,\n      billboards,\n      featureToCesiumMap: {},\n      primitives\n    };\n\n    this.rootCollection_.add(billboards);\n    this.rootCollection_.add(primitives);\n  }\n\n  /**\n  * Unlisten.\n  */\n  destroy() {\n    this.olListenKeys.forEach(olObservableUnByKey);\n    this.olListenKeys.length = 0;\n  }\n\n  /**\n  * @return {!Cesium.Primitive}\n  */\n  getRootPrimitive() {\n    return this.rootCollection_;\n  }\n}\n\n\nexport default VectorLayerCounterpart;\n","/**\n * @module olcs.FeatureConverter\n */\nimport olGeomGeometry from 'ol/geom/Geometry.js';\nimport olStyleIcon from 'ol/style/Icon.js';\nimport olSourceVector from 'ol/source/Vector.js';\nimport olSourceCluster from 'ol/source/Cluster.js';\nimport {circular as olCreateCircularPolygon} from 'ol/geom/Polygon.js';\nimport {boundingExtent, getCenter} from 'ol/extent.js';\nimport olGeomSimpleGeometry from 'ol/geom/SimpleGeometry.js';\nimport olcsCore from './core.js';\nimport olcsCoreVectorLayerCounterpart from './core/VectorLayerCounterpart.js';\nimport olcsUtil, {getUid, isGroundPolylinePrimitiveSupported} from './util.js';\n\n\n/**\n * @typedef {Object} ModelStyle\n * @property {Cesium.Matrix4} [debugModelMatrix]\n * @property {Cesium.ModelFromGltfOptions} cesiumOptions\n */\n\n\nclass FeatureConverter {\n  /**\n   * Concrete base class for converting from OpenLayers3 vectors to Cesium\n   * primitives.\n   * Extending this class is possible provided that the extending class and\n   * the library are compiled together by the closure compiler.\n   * @param {!Cesium.Scene} scene Cesium scene.\n   * @constructor\n   * @api\n   */\n  constructor(scene) {\n\n    /**\n     * @protected\n     */\n    this.scene = scene;\n\n    /**\n     * Bind once to have a unique function for using as a listener\n     * @type {function(ol.source.Vector.Event)}\n     * @private\n     */\n    this.boundOnRemoveOrClearFeatureListener_ = this.onRemoveOrClearFeature_.bind(this);\n\n    /**\n     * @type {Cesium.Cartesian3}\n     * @private\n     */\n    this.defaultBillboardEyeOffset_ = new Cesium.Cartesian3(0, 0, 10);\n  }\n\n  /**\n   * @param {ol.source.Vector.Event} evt\n   * @private\n   */\n  onRemoveOrClearFeature_(evt) {\n    const source = evt.target;\n    console.assert(source instanceof olSourceVector);\n\n    const cancellers = olcsUtil.obj(source)['olcs_cancellers'];\n    if (cancellers) {\n      const feature = evt.feature;\n      if (feature) {\n        // remove\n        const id = getUid(feature);\n        const canceller = cancellers[id];\n        if (canceller) {\n          canceller();\n          delete cancellers[id];\n        }\n      } else {\n        // clear\n        for (const key in cancellers) {\n          if (cancellers.hasOwnProperty(key)) {\n            cancellers[key]();\n          }\n        }\n        olcsUtil.obj(source)['olcs_cancellers'] = {};\n      }\n    }\n  }\n\n  /**\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature.\n   * @param {!Cesium.Primitive|Cesium.Label|Cesium.Billboard} primitive\n   * @protected\n   */\n  setReferenceForPicking(layer, feature, primitive) {\n    primitive.olLayer = layer;\n    primitive.olFeature = feature;\n  }\n\n  /**\n   * Basics primitive creation using a color attribute.\n   * Note that Cesium has 'interior' and outline geometries.\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature.\n   * @param {!ol.geom.Geometry} olGeometry OpenLayers geometry.\n   * @param {!Cesium.Geometry} geometry\n   * @param {!Cesium.Color} color\n   * @param {number=} opt_lineWidth\n   * @return {Cesium.Primitive}\n   * @protected\n   */\n  createColoredPrimitive(layer, feature, olGeometry, geometry, color, opt_lineWidth) {\n    const createInstance = function(geometry, color) {\n      const instance = new Cesium.GeometryInstance({\n        // always update Cesium externs before adding a property\n        geometry\n      });\n      if (color && !(color instanceof Cesium.ImageMaterialProperty)) {\n        instance.attributes = {\n          color: Cesium.ColorGeometryInstanceAttribute.fromColor(color)\n        };\n      }\n      return instance;\n    };\n\n    const options = {\n      // always update Cesium externs before adding a property\n      flat: true, // work with all geometries\n      renderState: {\n        depthTest: {\n          enabled: true\n        }\n      }\n    };\n\n    if (opt_lineWidth !== undefined) {\n      if (!options.renderState) {\n        options.renderState = {};\n      }\n      options.renderState.lineWidth = opt_lineWidth;\n    }\n\n    const instances = createInstance(geometry, color);\n\n    const heightReference = this.getHeightReference(layer, feature, olGeometry);\n\n    let primitive;\n\n    if (heightReference === Cesium.HeightReference.CLAMP_TO_GROUND) {\n      const ctor = instances.geometry.constructor;\n      if (ctor && !ctor['createShadowVolume']) {\n        return null;\n      }\n      primitive = new Cesium.GroundPrimitive({\n        geometryInstances: instances\n      });\n    } else {\n      primitive = new Cesium.Primitive({\n        geometryInstances: instances\n      });\n    }\n\n    if (color instanceof Cesium.ImageMaterialProperty) {\n      const dataUri = color.image.getValue().toDataURL();\n\n      primitive.appearance = new Cesium.MaterialAppearance({\n        flat: true,\n        renderState: {\n          depthTest: {\n            enabled: true\n          }\n        },\n        material: new Cesium.Material({\n          fabric: {\n            type: 'Image',\n            uniforms: {\n              image: dataUri\n            }\n          }\n        })\n      });\n    } else {\n      primitive.appearance = new Cesium.PerInstanceColorAppearance(options);\n    }\n\n    this.setReferenceForPicking(layer, feature, primitive);\n    return primitive;\n  }\n\n  /**\n   * Return the fill or stroke color from a plain ol style.\n   * @param {!ol.style.Style|ol.style.Text} style\n   * @param {boolean} outline\n   * @return {!Cesium.Color}\n   * @protected\n   */\n  extractColorFromOlStyle(style, outline) {\n    const fillColor = style.getFill() ? style.getFill().getColor() : null;\n    const strokeColor = style.getStroke() ? style.getStroke().getColor() : null;\n\n    let olColor = 'black';\n    if (strokeColor && outline) {\n      olColor = strokeColor;\n    } else if (fillColor) {\n      olColor = fillColor;\n    }\n\n    return olcsCore.convertColorToCesium(olColor);\n  }\n\n  /**\n   * Return the width of stroke from a plain ol style.\n   * @param {!ol.style.Style|ol.style.Text} style\n   * @return {number}\n   * @protected\n   */\n  extractLineWidthFromOlStyle(style) {\n    // Handling of line width WebGL limitations is handled by Cesium.\n    const width = style.getStroke() ? style.getStroke().getWidth() : undefined;\n    return width !== undefined ? width : 1;\n  }\n\n  /**\n   * Create a primitive collection out of two Cesium geometries.\n   * Only the OpenLayers style colors will be used.\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature.\n   * @param {!ol.geom.Geometry} olGeometry OpenLayers geometry.\n   * @param {!Cesium.Geometry} fillGeometry\n   * @param {!Cesium.Geometry} outlineGeometry\n   * @param {!ol.style.Style} olStyle\n   * @return {!Cesium.PrimitiveCollection}\n   * @protected\n   */\n  wrapFillAndOutlineGeometries(layer, feature, olGeometry, fillGeometry, outlineGeometry, olStyle) {\n    const fillColor = this.extractColorFromOlStyle(olStyle, false);\n    const outlineColor = this.extractColorFromOlStyle(olStyle, true);\n\n    const primitives = new Cesium.PrimitiveCollection();\n    if (olStyle.getFill()) {\n      const p1 = this.createColoredPrimitive(layer, feature, olGeometry,\n          fillGeometry, fillColor);\n      console.assert(!!p1);\n      primitives.add(p1);\n    }\n\n    if (olStyle.getStroke() && outlineGeometry) {\n      const width = this.extractLineWidthFromOlStyle(olStyle);\n      const p2 = this.createColoredPrimitive(layer, feature, olGeometry,\n          outlineGeometry, outlineColor, width);\n      if (p2) {\n        // Some outline geometries are not supported by Cesium in clamp to ground\n        // mode. These primitives are skipped.\n        primitives.add(p2);\n      }\n    }\n\n    return primitives;\n  }\n\n  // Geometry converters\n  /**\n   * Create a Cesium primitive if style has a text component.\n   * Eventually return a PrimitiveCollection including current primitive.\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature..\n   * @param {!ol.geom.Geometry} geometry\n   * @param {!ol.style.Style} style\n   * @param {!Cesium.Primitive} primitive current primitive\n   * @return {!Cesium.PrimitiveCollection}\n   * @protected\n   */\n  addTextStyle(layer, feature, geometry, style, primitive) {\n    let primitives;\n    if (!(primitive instanceof Cesium.PrimitiveCollection)) {\n      primitives = new Cesium.PrimitiveCollection();\n      primitives.add(primitive);\n    } else {\n      primitives = primitive;\n    }\n\n    if (!style.getText()) {\n      return primitives;\n    }\n\n    const text = /** @type {!ol.style.Text} */ (style.getText());\n    const label = this.olGeometry4326TextPartToCesium(layer, feature, geometry,\n        text);\n    if (label) {\n      primitives.add(label);\n    }\n    return primitives;\n  }\n\n  /**\n   * Add a billboard to a Cesium.BillboardCollection.\n   * Overriding this wrapper allows manipulating the billboard options.\n   * @param {!Cesium.BillboardCollection} billboards\n   * @param {!Cesium.optionsBillboardCollectionAdd} bbOptions\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature.\n   * @param {!ol.geom.Geometry} geometry\n   * @param {!ol.style.Style} style\n   * @return {!Cesium.Billboard} newly created billboard\n   * @api\n   */\n  csAddBillboard(billboards, bbOptions, layer, feature, geometry, style) {\n    if (!bbOptions.eyeOffset) {\n      bbOptions.eyeOffset = this.defaultBillboardEyeOffset_;\n    }\n    const bb = billboards.add(bbOptions);\n    this.setReferenceForPicking(layer, feature, bb);\n    return bb;\n  }\n\n  /**\n   * Convert an OpenLayers circle geometry to Cesium.\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature..\n   * @param {!ol.geom.Circle} olGeometry OpenLayers circle geometry.\n   * @param {!ol.ProjectionLike} projection\n   * @param {!ol.style.Style} olStyle\n   * @return {!Cesium.PrimitiveCollection} primitives\n   * @api\n   */\n  olCircleGeometryToCesium(layer, feature, olGeometry, projection, olStyle) {\n\n    olGeometry = olcsCore.olGeometryCloneTo4326(olGeometry, projection);\n    console.assert(olGeometry.getType() == 'Circle');\n\n    // ol.Coordinate\n    let center = olGeometry.getCenter();\n    const height = center.length == 3 ? center[2] : 0.0;\n    let point = center.slice();\n    point[0] += olGeometry.getRadius();\n\n    // Cesium\n    center = olcsCore.ol4326CoordinateToCesiumCartesian(center);\n    point = olcsCore.ol4326CoordinateToCesiumCartesian(point);\n\n    // Accurate computation of straight distance\n    const radius = Cesium.Cartesian3.distance(center, point);\n\n    const fillGeometry = new Cesium.CircleGeometry({\n      // always update Cesium externs before adding a property\n      center,\n      radius,\n      height\n    });\n\n    let outlinePrimitive, outlineGeometry;\n    if (this.getHeightReference(layer, feature, olGeometry) === Cesium.HeightReference.CLAMP_TO_GROUND) {\n      const width = this.extractLineWidthFromOlStyle(olStyle);\n      if (width) {\n        const circlePolygon = olCreateCircularPolygon(olGeometry.getCenter(), radius);\n        const positions = olcsCore.ol4326CoordinateArrayToCsCartesians(circlePolygon.getLinearRing(0).getCoordinates());\n        if (!isGroundPolylinePrimitiveSupported(this.scene)) {\n          const color = this.extractColorFromOlStyle(olStyle, true);\n          outlinePrimitive = this.createStackedGroundCorridors(layer, feature, width, color, positions);\n        } else {\n          outlinePrimitive = new Cesium.GroundPolylinePrimitive({\n            geometryInstances: new Cesium.GeometryInstance({\n              geometry: new Cesium.GroundPolylineGeometry({positions, width}),\n            }),\n            appearance: new Cesium.PolylineMaterialAppearance({\n              material: this.olStyleToCesium(feature, olStyle, true),\n            }),\n            classificationType: Cesium.ClassificationType.TERRAIN,\n          });\n          outlinePrimitive.readyPromise.then(() => {\n            this.setReferenceForPicking(layer, feature, outlinePrimitive._primitive);\n          });\n        }\n      }\n    } else {\n      outlineGeometry = new Cesium.CircleOutlineGeometry({\n        // always update Cesium externs before adding a property\n        center,\n        radius,\n        extrudedHeight: height,\n        height\n      });\n    }\n\n    const primitives = this.wrapFillAndOutlineGeometries(\n        layer, feature, olGeometry, fillGeometry, outlineGeometry, olStyle);\n\n    if (outlinePrimitive) {\n      primitives.add(outlinePrimitive);\n    }\n    return this.addTextStyle(layer, feature, olGeometry, olStyle, primitives);\n  }\n\n  /**\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature..\n   * @param {!number} width The width of the line.\n   * @param {!Cesium.Color} color The color of the line.\n   * @param {!Array<Cesium.Cartesian3>|Array<Array<Cesium.Cartesian3>>} positions The vertices of the line(s).\n   * @return {!Cesium.GroundPrimitive} primitive\n   */\n  createStackedGroundCorridors(layer, feature, width, color, positions) {\n    // Convert positions to an Array if it isn't\n    if (!Array.isArray(positions[0])) {\n      positions = [positions];\n    }\n    width = Math.max(3, width); // A <3px width is too small for ground primitives\n    const geometryInstances = [];\n    let previousDistance = 0;\n    // A stack of ground lines with increasing width (in meters) are created.\n    // Only one of these lines is displayed at any time giving a feeling of continuity.\n    // The values for the distance and width factor are more or less arbitrary.\n    // Applications can override this logics by subclassing the FeatureConverter class.\n    for (const distance of [1000, 4000, 16000, 64000, 254000, 1000000, 10000000]) {\n      width *= 2.14;\n      const geometryOptions = {\n        // always update Cesium externs before adding a property\n        width,\n        vertexFormat: Cesium.VertexFormat.POSITION_ONLY\n      };\n      for (const linePositions of positions) {\n        geometryOptions.positions = linePositions;\n        geometryInstances.push(new Cesium.GeometryInstance({\n          geometry: new Cesium.CorridorGeometry(geometryOptions),\n          attributes: {\n            color: Cesium.ColorGeometryInstanceAttribute.fromColor(color),\n            distanceDisplayCondition: new Cesium.DistanceDisplayConditionGeometryInstanceAttribute(previousDistance, distance - 1)\n          }\n        }));\n      }\n      previousDistance = distance;\n    }\n    return new Cesium.GroundPrimitive({\n      // always update Cesium externs before adding a property\n      geometryInstances\n    });\n  }\n\n  /**\n   * Convert an OpenLayers line string geometry to Cesium.\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature..\n   * @param {!ol.geom.LineString} olGeometry OpenLayers line string geometry.\n   * @param {!ol.ProjectionLike} projection\n   * @param {!ol.style.Style} olStyle\n   * @return {!Cesium.PrimitiveCollection} primitives\n   * @api\n   */\n  olLineStringGeometryToCesium(layer, feature, olGeometry, projection, olStyle) {\n\n    olGeometry = olcsCore.olGeometryCloneTo4326(olGeometry, projection);\n    console.assert(olGeometry.getType() == 'LineString');\n\n    const positions = olcsCore.ol4326CoordinateArrayToCsCartesians(olGeometry.getCoordinates());\n    const width = this.extractLineWidthFromOlStyle(olStyle);\n\n    let outlinePrimitive;\n    const heightReference = this.getHeightReference(layer, feature, olGeometry);\n\n    if (heightReference === Cesium.HeightReference.CLAMP_TO_GROUND && !isGroundPolylinePrimitiveSupported(this.scene)) {\n      const color = this.extractColorFromOlStyle(olStyle, true);\n      outlinePrimitive = this.createStackedGroundCorridors(layer, feature, width, color, positions);\n    } else {\n      const appearance = new Cesium.PolylineMaterialAppearance({\n        // always update Cesium externs before adding a property\n        material: this.olStyleToCesium(feature, olStyle, true)\n      });\n      const geometryOptions = {\n        // always update Cesium externs before adding a property\n        positions,\n        width,\n      };\n      const primitiveOptions = {\n        // always update Cesium externs before adding a property\n        appearance\n      };\n      if (heightReference === Cesium.HeightReference.CLAMP_TO_GROUND) {\n        const geometry = new Cesium.GroundPolylineGeometry(geometryOptions);\n        primitiveOptions.geometryInstances = new Cesium.GeometryInstance({\n          geometry\n        }),\n        outlinePrimitive = new Cesium.GroundPolylinePrimitive(primitiveOptions);\n        outlinePrimitive.readyPromise.then(() => {\n          this.setReferenceForPicking(layer, feature, outlinePrimitive._primitive);\n        });\n      } else {\n        geometryOptions.vertexFormat = appearance.vertexFormat;\n        const geometry = new Cesium.PolylineGeometry(geometryOptions);\n        primitiveOptions.geometryInstances = new Cesium.GeometryInstance({\n          geometry\n        }),\n        outlinePrimitive = new Cesium.Primitive(primitiveOptions);\n      }\n    }\n\n    this.setReferenceForPicking(layer, feature, outlinePrimitive);\n\n    return this.addTextStyle(layer, feature, olGeometry, olStyle, outlinePrimitive);\n  }\n\n  /**\n   * Convert an OpenLayers polygon geometry to Cesium.\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature..\n   * @param {!ol.geom.Polygon} olGeometry OpenLayers polygon geometry.\n   * @param {!ol.ProjectionLike} projection\n   * @param {!ol.style.Style} olStyle\n   * @return {!Cesium.PrimitiveCollection} primitives\n   * @api\n   */\n  olPolygonGeometryToCesium(layer, feature, olGeometry, projection, olStyle) {\n\n    olGeometry = olcsCore.olGeometryCloneTo4326(olGeometry, projection);\n    console.assert(olGeometry.getType() == 'Polygon');\n\n    const heightReference = this.getHeightReference(layer, feature, olGeometry);\n\n    let fillGeometry, outlineGeometry, outlinePrimitive;\n    if ((olGeometry.getCoordinates()[0].length == 5) &&\n        (feature.getGeometry().get('olcs.polygon_kind') === 'rectangle')) {\n      // Create a rectangle according to the longitude and latitude curves\n      const coordinates = olGeometry.getCoordinates()[0];\n      // Extract the West, South, East, North coordinates\n      const extent = boundingExtent(coordinates);\n      const rectangle = Cesium.Rectangle.fromDegrees(extent[0], extent[1],\n          extent[2], extent[3]);\n\n      // Extract the average height of the vertices\n      let maxHeight = 0.0;\n      if (coordinates[0].length == 3) {\n        for (let c = 0; c < coordinates.length; c++) {\n          maxHeight = Math.max(maxHeight, coordinates[c][2]);\n        }\n      }\n\n      // Render the cartographic rectangle\n      fillGeometry = new Cesium.RectangleGeometry({\n        ellipsoid: Cesium.Ellipsoid.WGS84,\n        rectangle,\n        height: maxHeight\n      });\n\n      outlineGeometry = new Cesium.RectangleOutlineGeometry({\n        ellipsoid: Cesium.Ellipsoid.WGS84,\n        rectangle,\n        height: maxHeight\n      });\n    } else {\n      const rings = olGeometry.getLinearRings();\n      // always update Cesium externs before adding a property\n      const hierarchy = {};\n      const polygonHierarchy = hierarchy;\n      console.assert(rings.length > 0);\n\n      for (let i = 0; i < rings.length; ++i) {\n        const olPos = rings[i].getCoordinates();\n        const positions = olcsCore.ol4326CoordinateArrayToCsCartesians(olPos);\n        console.assert(positions && positions.length > 0);\n        if (i == 0) {\n          hierarchy.positions = positions;\n        } else {\n          if (!hierarchy.holes) {\n            hierarchy.holes = [];\n          }\n          hierarchy.holes.push({\n            positions\n          });\n        }\n      }\n\n      fillGeometry = new Cesium.PolygonGeometry({\n        // always update Cesium externs before adding a property\n        polygonHierarchy,\n        perPositionHeight: true\n      });\n\n      // Since Cesium doesn't yet support Polygon outlines on terrain yet (coming soon...?)\n      // we don't create an outline geometry if clamped, but instead do the polyline method\n      // for each ring. Most of this code should be removeable when Cesium adds\n      // support for Polygon outlines on terrain.\n      if (heightReference === Cesium.HeightReference.CLAMP_TO_GROUND) {\n        const width = this.extractLineWidthFromOlStyle(olStyle);\n        if (width > 0) {\n          const positions = [hierarchy.positions];\n          if (hierarchy.holes) {\n            for (let i = 0; i < hierarchy.holes.length; ++i) {\n              positions.push(hierarchy.holes[i].positions);\n            }\n          }\n          if (!isGroundPolylinePrimitiveSupported(this.scene)) {\n            const color = this.extractColorFromOlStyle(olStyle, true);\n            outlinePrimitive = this.createStackedGroundCorridors(layer, feature, width, color, positions);\n          } else {\n            const appearance = new Cesium.PolylineMaterialAppearance({\n              // always update Cesium externs before adding a property\n              material: this.olStyleToCesium(feature, olStyle, true)\n            });\n            const geometryInstances = [];\n            for (const linePositions of positions) {\n              const polylineGeometry = new Cesium.GroundPolylineGeometry({positions: linePositions, width});\n              geometryInstances.push(new Cesium.GeometryInstance({\n                geometry: polylineGeometry\n              }));\n            }\n            const primitiveOptions = {\n              // always update Cesium externs before adding a property\n              appearance,\n              geometryInstances\n            };\n            outlinePrimitive = new Cesium.GroundPolylinePrimitive(primitiveOptions);\n            outlinePrimitive.readyPromise.then(() => {\n              this.setReferenceForPicking(layer, feature, outlinePrimitive._primitive);\n            });\n          }\n        }\n      } else {\n        // Actually do the normal polygon thing. This should end the removable\n        // section of code described above.\n        outlineGeometry = new Cesium.PolygonOutlineGeometry({\n          // always update Cesium externs before adding a property\n          polygonHierarchy: hierarchy,\n          perPositionHeight: true\n        });\n      }\n    }\n\n    const primitives = this.wrapFillAndOutlineGeometries(\n        layer, feature, olGeometry, fillGeometry, outlineGeometry, olStyle);\n\n    if (outlinePrimitive) {\n      primitives.add(outlinePrimitive);\n    }\n\n    return this.addTextStyle(layer, feature, olGeometry, olStyle, primitives);\n  }\n\n  /**\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {ol.Feature} feature OpenLayers feature..\n   * @param {!ol.geom.Geometry} geometry\n   * @return {!Cesium.HeightReference}\n   * @api\n   */\n  getHeightReference(layer, feature, geometry) {\n\n    // Read from the geometry\n    let altitudeMode = geometry.get('altitudeMode');\n\n    // Or from the feature\n    if (altitudeMode === undefined) {\n      altitudeMode = feature.get('altitudeMode');\n    }\n\n    // Or from the layer\n    if (altitudeMode === undefined) {\n      altitudeMode = layer.get('altitudeMode');\n    }\n\n    let heightReference = Cesium.HeightReference.NONE;\n    if (altitudeMode === 'clampToGround') {\n      heightReference = Cesium.HeightReference.CLAMP_TO_GROUND;\n    } else if (altitudeMode === 'relativeToGround') {\n      heightReference = Cesium.HeightReference.RELATIVE_TO_GROUND;\n    }\n\n    return heightReference;\n  }\n\n  /**\n   * Convert a point geometry to a Cesium BillboardCollection.\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature..\n   * @param {!ol.geom.Point} olGeometry OpenLayers point geometry.\n   * @param {!ol.ProjectionLike} projection\n   * @param {!ol.style.Style} style\n   * @param {!ol.style.Image} imageStyle\n   * @param {!Cesium.BillboardCollection} billboards\n   * @param {function(!Cesium.Billboard)=} opt_newBillboardCallback Called when the new billboard is added.\n   * @api\n   */\n  createBillboardFromImage(\n      layer,\n      feature,\n      olGeometry,\n      projection,\n      style,\n      imageStyle,\n      billboards,\n      opt_newBillboardCallback\n  ) {\n\n    if (imageStyle instanceof olStyleIcon) {\n      // make sure the image is scheduled for load\n      imageStyle.load();\n    }\n\n    const image = imageStyle.getImage(1); // get normal density\n    const isImageLoaded = function(image) {\n      return image.src != '' &&\n          image.naturalHeight != 0 &&\n          image.naturalWidth != 0 &&\n          image.complete;\n    };\n    const reallyCreateBillboard = (function() {\n      if (!image) {\n        return;\n      }\n      if (!(image instanceof HTMLCanvasElement ||\n          image instanceof Image ||\n          image instanceof HTMLImageElement)) {\n        return;\n      }\n      const center = olGeometry.getCoordinates();\n      const position = olcsCore.ol4326CoordinateToCesiumCartesian(center);\n      let color;\n      const opacity = imageStyle.getOpacity();\n      if (opacity !== undefined) {\n        color = new Cesium.Color(1.0, 1.0, 1.0, opacity);\n      }\n\n      const scale = imageStyle.getScale();\n      const heightReference = this.getHeightReference(layer, feature, olGeometry);\n\n      const bbOptions = /** @type {Cesium.optionsBillboardCollectionAdd} */ ({\n        // always update Cesium externs before adding a property\n        image,\n        color,\n        scale,\n        heightReference,\n        position\n      });\n\n      // merge in cesium options from openlayers feature\n      Object.assign(bbOptions, feature.get('cesiumOptions'));\n\n      if (imageStyle instanceof olStyleIcon) {\n        const anchor = imageStyle.getAnchor();\n        if (anchor) {\n          bbOptions.pixelOffset = new Cesium.Cartesian2((image.width / 2 - anchor[0]) * scale, (image.height / 2 - anchor[1]) * scale);\n        }\n      }\n\n      const bb = this.csAddBillboard(billboards, bbOptions, layer, feature, olGeometry, style);\n      if (opt_newBillboardCallback) {\n        opt_newBillboardCallback(bb);\n      }\n    }).bind(this);\n\n    if (image instanceof Image && !isImageLoaded(image)) {\n      // Cesium requires the image to be loaded\n      let cancelled = false;\n      const source = layer.getSource();\n      const canceller = function() {\n        cancelled = true;\n      };\n      source.on(['removefeature', 'clear'],\n          this.boundOnRemoveOrClearFeatureListener_);\n      let cancellers = olcsUtil.obj(source)['olcs_cancellers'];\n      if (!cancellers) {\n        cancellers = olcsUtil.obj(source)['olcs_cancellers'] = {};\n      }\n\n      const fuid = getUid(feature);\n      if (cancellers[fuid]) {\n        // When the feature change quickly, a canceller may still be present so\n        // we cancel it here to prevent creation of a billboard.\n        cancellers[fuid]();\n      }\n      cancellers[fuid] = canceller;\n\n      const listener = function() {\n        image.removeEventListener('load', listener);\n        if (!billboards.isDestroyed() && !cancelled) {\n          // Create billboard if the feature is still displayed on the map.\n          reallyCreateBillboard();\n        }\n      };\n\n      image.addEventListener('load', listener);\n    } else {\n      reallyCreateBillboard();\n    }\n  }\n\n  /**\n   * Convert a point geometry to a Cesium BillboardCollection.\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature..\n   * @param {!ol.geom.Point} olGeometry OpenLayers point geometry.\n   * @param {!ol.ProjectionLike} projection\n   * @param {!ol.style.Style} style\n   * @param {!Cesium.BillboardCollection} billboards\n   * @param {function(!Cesium.Billboard)=} opt_newBillboardCallback Called when\n   * the new billboard is added.\n   * @return {Cesium.Primitive} primitives\n   * @api\n   */\n  olPointGeometryToCesium(\n      layer,\n      feature,\n      olGeometry,\n      projection,\n      style,\n      billboards,\n      opt_newBillboardCallback\n  ) {\n    console.assert(olGeometry.getType() == 'Point');\n    olGeometry = olcsCore.olGeometryCloneTo4326(olGeometry, projection);\n\n    let modelPrimitive = null;\n    const imageStyle = style.getImage();\n    if (imageStyle) {\n      const olcsModelFunction = /** @type {function():olcsx.ModelStyle} */ (olGeometry.get('olcs_model') || feature.get('olcs_model'));\n      if (olcsModelFunction) {\n        const olcsModel = olcsModelFunction();\n        const options = /** @type {Cesium.ModelFromGltfOptions} */ (Object.assign({}, {scene: this.scene}, olcsModel.cesiumOptions));\n        const model = Cesium.Model.fromGltf(options);\n        modelPrimitive = new Cesium.PrimitiveCollection();\n        modelPrimitive.add(model);\n        if (olcsModel.debugModelMatrix) {\n          modelPrimitive.add(new Cesium.DebugModelMatrixPrimitive({\n            modelMatrix: olcsModel.debugModelMatrix\n          }));\n        }\n      } else {\n        this.createBillboardFromImage(layer, feature, olGeometry, projection, style, imageStyle, billboards, opt_newBillboardCallback);\n      }\n    }\n\n    if (style.getText()) {\n      return this.addTextStyle(layer, feature, olGeometry, style, modelPrimitive || new Cesium.Primitive());\n    } else {\n      return modelPrimitive;\n    }\n  }\n\n  /**\n   * Convert an OpenLayers multi-something geometry to Cesium.\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature..\n   * @param {!ol.geom.Geometry} geometry OpenLayers geometry.\n   * @param {!ol.ProjectionLike} projection\n   * @param {!ol.style.Style} olStyle\n   * @param {!Cesium.BillboardCollection} billboards\n   * @param {function(!Cesium.Billboard)=} opt_newBillboardCallback Called when\n   * the new billboard is added.\n   * @return {Cesium.Primitive} primitives\n   * @api\n   */\n  olMultiGeometryToCesium(\n      layer,\n      feature,\n      geometry,\n      projection,\n      olStyle,\n      billboards,\n      opt_newBillboardCallback\n  ) {\n    // Do not reproject to 4326 now because it will be done later.\n\n    // FIXME: would be better to combine all child geometries in one primitive\n    // instead we create n primitives for simplicity.\n    const accumulate = function(geometries, functor) {\n      const primitives = new Cesium.PrimitiveCollection();\n      geometries.forEach((geometry) => {\n        primitives.add(functor(layer, feature, geometry, projection, olStyle));\n      });\n      return primitives;\n    };\n\n    let subgeos;\n    switch (geometry.getType()) {\n      case 'MultiPoint':\n        geometry = /** @type {!ol.geom.MultiPoint} */ (geometry);\n        subgeos = geometry.getPoints();\n        if (olStyle.getText()) {\n          const primitives = new Cesium.PrimitiveCollection();\n          subgeos.forEach((geometry) => {\n            console.assert(geometry);\n            const result = this.olPointGeometryToCesium(layer, feature, geometry,\n                projection, olStyle, billboards, opt_newBillboardCallback);\n            if (result) {\n              primitives.add(result);\n            }\n          });\n          return primitives;\n        } else {\n          subgeos.forEach((geometry) => {\n            console.assert(geometry);\n            this.olPointGeometryToCesium(layer, feature, geometry, projection,\n                olStyle, billboards, opt_newBillboardCallback);\n          });\n          return null;\n        }\n      case 'MultiLineString':\n        geometry = /** @type {!ol.geom.MultiLineString} */ (geometry);\n        subgeos = geometry.getLineStrings();\n        return accumulate(subgeos, this.olLineStringGeometryToCesium.bind(this));\n      case 'MultiPolygon':\n        geometry = /** @type {!ol.geom.MultiPolygon} */ (geometry);\n        subgeos = geometry.getPolygons();\n        return accumulate(subgeos, this.olPolygonGeometryToCesium.bind(this));\n      default:\n        console.assert(false, `Unhandled multi geometry type${geometry.getType()}`);\n    }\n  }\n\n  /**\n   * Convert an OpenLayers text style to Cesium.\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature..\n   * @param {!ol.geom.Geometry} geometry\n   * @param {!ol.style.Text} style\n   * @return {Cesium.LabelCollection} Cesium primitive\n   * @api\n   */\n  olGeometry4326TextPartToCesium(layer, feature, geometry, style) {\n    const text = style.getText();\n    if (!text) {\n      return null;\n    }\n\n    const labels = new Cesium.LabelCollection({scene: this.scene});\n    // TODO: export and use the text draw position from OpenLayers .\n    // See src/ol/render/vector.js\n    const extentCenter = getCenter(geometry.getExtent());\n    if (geometry instanceof olGeomSimpleGeometry) {\n      const first = geometry.getFirstCoordinate();\n      extentCenter[2] = first.length == 3 ? first[2] : 0.0;\n    }\n    const options = /** @type {Cesium.optionsLabelCollection} */ ({});\n\n    options.position = olcsCore.ol4326CoordinateToCesiumCartesian(extentCenter);\n\n    options.text = text;\n\n    options.heightReference = this.getHeightReference(layer, feature, geometry);\n\n    const offsetX = style.getOffsetX();\n    const offsetY = style.getOffsetY();\n    if (offsetX != 0 && offsetY != 0) {\n      const offset = new Cesium.Cartesian2(offsetX, offsetY);\n      options.pixelOffset = offset;\n    }\n\n    options.font = style.getFont() || '10px sans-serif'; // OpenLayers default\n\n    let labelStyle = undefined;\n    if (style.getFill()) {\n      options.fillColor = this.extractColorFromOlStyle(style, false);\n      labelStyle = Cesium.LabelStyle.FILL;\n    }\n    if (style.getStroke()) {\n      options.outlineWidth = this.extractLineWidthFromOlStyle(style);\n      options.outlineColor = this.extractColorFromOlStyle(style, true);\n      labelStyle = Cesium.LabelStyle.OUTLINE;\n    }\n    if (style.getFill() && style.getStroke()) {\n      labelStyle = Cesium.LabelStyle.FILL_AND_OUTLINE;\n    }\n    options.style = labelStyle;\n\n    let horizontalOrigin;\n    switch (style.getTextAlign()) {\n      case 'left':\n        horizontalOrigin = Cesium.HorizontalOrigin.LEFT;\n        break;\n      case 'right':\n        horizontalOrigin = Cesium.HorizontalOrigin.RIGHT;\n        break;\n      case 'center':\n      default:\n        horizontalOrigin = Cesium.HorizontalOrigin.CENTER;\n    }\n    options.horizontalOrigin = horizontalOrigin;\n\n    if (style.getTextBaseline()) {\n      let verticalOrigin;\n      switch (style.getTextBaseline()) {\n        case 'top':\n          verticalOrigin = Cesium.VerticalOrigin.TOP;\n          break;\n        case 'middle':\n          verticalOrigin = Cesium.VerticalOrigin.CENTER;\n          break;\n        case 'bottom':\n          verticalOrigin = Cesium.VerticalOrigin.BOTTOM;\n          break;\n        case 'alphabetic':\n          verticalOrigin = Cesium.VerticalOrigin.TOP;\n          break;\n        case 'hanging':\n          verticalOrigin = Cesium.VerticalOrigin.BOTTOM;\n          break;\n        default:\n          console.assert(false, `unhandled baseline ${style.getTextBaseline()}`);\n      }\n      options.verticalOrigin = verticalOrigin;\n    }\n\n\n    const l = labels.add(options);\n    this.setReferenceForPicking(layer, feature, l);\n    return labels;\n  }\n\n  /**\n   * Convert an OpenLayers style to a Cesium Material.\n   * @param {ol.Feature} feature OpenLayers feature..\n   * @param {!ol.style.Style} style\n   * @param {boolean} outline\n   * @return {Cesium.Material}\n   * @api\n   */\n  olStyleToCesium(feature, style, outline) {\n    const fill = style.getFill();\n    const stroke = style.getStroke();\n    if ((outline && !stroke) || (!outline && !fill)) {\n      return null; // FIXME use a default style? Developer error?\n    }\n\n    let color = outline ? stroke.getColor() : fill.getColor();\n    color = olcsCore.convertColorToCesium(color);\n\n    if (outline && stroke.getLineDash()) {\n      return Cesium.Material.fromType('Stripe', {\n        // always update Cesium externs before adding a property\n        horizontal: false,\n        repeat: 500, // TODO how to calculate this?\n        evenColor: color,\n        oddColor: new Cesium.Color(0, 0, 0, 0) // transparent\n      });\n    } else {\n      return Cesium.Material.fromType('Color', {\n        // always update Cesium externs before adding a property\n        color\n      });\n    }\n\n  }\n\n  /**\n   * Compute OpenLayers plain style.\n   * Evaluates style function, blend arrays, get default style.\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature\n   * @param {ol.StyleFunction|undefined} fallbackStyleFunction\n   * @param {number} resolution\n   * @return {Array.<!ol.style.Style>} null if no style is available\n   * @api\n   */\n  computePlainStyle(layer, feature, fallbackStyleFunction, resolution) {\n    /**\n     * @type {ol.FeatureStyleFunction|undefined}\n     */\n    const featureStyleFunction = feature.getStyleFunction();\n\n    /**\n     * @type {ol.style.Style|Array.<ol.style.Style>}\n     */\n    let style = null;\n\n    if (featureStyleFunction) {\n      style = featureStyleFunction(feature, resolution);\n    }\n\n    if (!style && fallbackStyleFunction) {\n      style = fallbackStyleFunction(feature, resolution);\n    }\n\n    if (!style) {\n      // The feature must not be displayed\n      return null;\n    }\n\n    // FIXME combine materials as in cesium-materials-pack?\n    // then this function must return a custom material\n    // More simply, could blend the colors like described in\n    // http://en.wikipedia.org/wiki/Alpha_compositing\n    return Array.isArray(style) ? style : [style];\n  }\n\n  /**\n   * @protected\n   * @param {!ol.Feature} feature\n   * @param {!ol.style.Style} style\n   * @param {!ol.geom.Geometry=} opt_geom Geometry to be converted.\n   * @return {ol.geom.Geometry|undefined}\n   */\n  getGeometryFromFeature(feature, style, opt_geom) {\n    if (opt_geom) {\n      return opt_geom;\n    }\n\n    const geom3d = /** @type {!ol.geom.Geometry} */(feature.get('olcs.3d_geometry'));\n    if (geom3d && geom3d instanceof olGeomGeometry) {\n      return geom3d;\n    }\n\n    if (style) {\n      const geomFuncRes = style.getGeometryFunction()(feature);\n      if (geomFuncRes instanceof olGeomGeometry) {\n        return geomFuncRes;\n      }\n    }\n\n    return feature.getGeometry();\n  }\n\n  /**\n   * Convert one OpenLayers feature up to a collection of Cesium primitives.\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature.\n   * @param {!ol.style.Style} style\n   * @param {!import('olcs/core/VectorLayerConterpart.js').OlFeatureToCesiumContext} context\n   * @param {!ol.geom.Geometry=} opt_geom Geometry to be converted.\n   * @return {Cesium.Primitive} primitives\n   * @api\n   */\n  olFeatureToCesium(layer, feature, style, context, opt_geom) {\n    let geom = this.getGeometryFromFeature(feature, style, opt_geom);\n\n    if (!geom) {\n      // OpenLayers features may not have a geometry\n      // See http://geojson.org/geojson-spec.html#feature-objects\n      return null;\n    }\n\n    const proj = context.projection;\n    const newBillboardAddedCallback = function(bb) {\n      const featureBb = context.featureToCesiumMap[getUid(feature)];\n      if (featureBb instanceof Array) {\n        featureBb.push(bb);\n      }\n      else {\n        context.featureToCesiumMap[getUid(feature)] = [bb];\n      }\n    };\n\n    switch (geom.getType()) {\n      case 'GeometryCollection':\n        const primitives = new Cesium.PrimitiveCollection();\n        const collection = /** @type {!ol.geom.GeometryCollection} */ (geom);\n        // TODO: use getGeometriesArray() instead\n        collection.getGeometries().forEach((geom) => {\n          if (geom) {\n            const prims = this.olFeatureToCesium(layer, feature, style, context,\n                geom);\n            if (prims) {\n              primitives.add(prims);\n            }\n          }\n        });\n        return primitives;\n      case 'Point':\n        geom = /** @type {!ol.geom.Point} */ (geom);\n        const bbs = context.billboards;\n        const result = this.olPointGeometryToCesium(layer, feature, geom, proj,\n            style, bbs, newBillboardAddedCallback);\n        if (!result) {\n          // no wrapping primitive\n          return null;\n        } else {\n          return result;\n        }\n      case 'Circle':\n        geom = /** @type {!ol.geom.Circle} */ (geom);\n        return this.olCircleGeometryToCesium(layer, feature, geom, proj,\n            style);\n      case 'LineString':\n        geom = /** @type {!ol.geom.LineString} */ (geom);\n        return this.olLineStringGeometryToCesium(layer, feature, geom, proj,\n            style);\n      case 'Polygon':\n        geom = /** @type {!ol.geom.Polygon} */ (geom);\n        return this.olPolygonGeometryToCesium(layer, feature, geom, proj,\n            style);\n      case 'MultiPoint':\n      case 'MultiLineString':\n      case 'MultiPolygon':\n        const result2 = this.olMultiGeometryToCesium(layer, feature, geom, proj,\n            style, context.billboards, newBillboardAddedCallback);\n        if (!result2) {\n          // no wrapping primitive\n          return null;\n        } else {\n          return result2;\n        }\n      case 'LinearRing':\n        throw new Error('LinearRing should only be part of polygon.');\n      default:\n        throw new Error(`Ol geom type not handled : ${geom.getType()}`);\n    }\n  }\n\n  /**\n   * Convert an OpenLayers vector layer to Cesium primitive collection.\n   * For each feature, the associated primitive will be stored in\n   * `featurePrimitiveMap`.\n   * @param {!(ol.layer.Vector|ol.layer.Image)} olLayer\n   * @param {!ol.View} olView\n   * @param {!Object.<number, !Cesium.Primitive>} featurePrimitiveMap\n   * @return {!olcs.core.VectorLayerCounterpart}\n   * @api\n   */\n  olVectorLayerToCesium(olLayer, olView, featurePrimitiveMap) {\n    const proj = olView.getProjection();\n    const resolution = olView.getResolution();\n\n    if (resolution === undefined || !proj) {\n      console.assert(false, 'View not ready');\n      // an assertion is not enough for closure to assume resolution and proj\n      // are defined\n      throw new Error('View not ready');\n    }\n\n    let source = olLayer.getSource();\n    if (source instanceof olSourceCluster) {\n      source = source.getSource();\n    }\n\n    console.assert(source instanceof olSourceVector);\n    const features = source.getFeatures();\n    const counterpart = new olcsCoreVectorLayerCounterpart(proj, this.scene);\n    const context = counterpart.context;\n    for (let i = 0; i < features.length; ++i) {\n      const feature = features[i];\n      if (!feature) {\n        continue;\n      }\n      /**\n       * @type {ol.StyleFunction|undefined}\n       */\n      const layerStyle = olLayer.getStyleFunction();\n      const styles = this.computePlainStyle(olLayer, feature, layerStyle,\n          resolution);\n      if (!styles || !styles.length) {\n        // only 'render' features with a style\n        continue;\n      }\n\n      /**\n       * @type {Cesium.Primitive|null}\n       */\n      let primitives = null;\n      for (let i = 0; i < styles.length; i++) {\n        const prims = this.olFeatureToCesium(olLayer, feature, styles[i], context);\n        if (prims) {\n          if (!primitives) {\n            primitives = prims;\n          } else if (prims) {\n            let i = 0, prim;\n            while ((prim = prims.get(i))) {\n              primitives.add(prim);\n              i++;\n            }\n          }\n        }\n      }\n      if (!primitives) {\n        continue;\n      }\n      featurePrimitiveMap[getUid(feature)] = primitives;\n      counterpart.getRootPrimitive().add(primitives);\n    }\n\n    return counterpart;\n  }\n\n  /**\n   * Convert an OpenLayers feature to Cesium primitive collection.\n   * @param {!(ol.layer.Vector|ol.layer.Image)} layer\n   * @param {!ol.View} view\n   * @param {!ol.Feature} feature\n   * @param {!import('olcs/core/VectorLayerConterpart.js').OlFeatureToCesiumContext} context\n   * @return {Cesium.Primitive}\n   * @api\n   */\n  convert(layer, view, feature, context) {\n    const proj = view.getProjection();\n    const resolution = view.getResolution();\n\n    if (resolution == undefined || !proj) {\n      return null;\n    }\n\n    /**\n     * @type {ol.StyleFunction|undefined}\n     */\n    const layerStyle = layer.getStyleFunction();\n\n    const styles = this.computePlainStyle(layer, feature, layerStyle, resolution);\n\n    if (!styles || !styles.length) {\n      // only 'render' features with a style\n      return null;\n    }\n\n    context.projection = proj;\n\n    /**\n     * @type {Cesium.Primitive|null}\n     */\n    let primitives = null;\n    for (let i = 0; i < styles.length; i++) {\n      const prims = this.olFeatureToCesium(layer, feature, styles[i], context);\n      if (!primitives) {\n        primitives = prims;\n      } else if (prims) {\n        let i = 0, prim;\n        while ((prim = prims.get(i))) {\n          primitives.add(prim);\n          i++;\n        }\n      }\n    }\n    return primitives;\n  }\n}\n\n\nexport default FeatureConverter;\n","/**\n * @module olcs.VectorSynchronizer\n */\nimport olSourceVector from 'ol/source/Vector.js';\nimport olLayerLayer from 'ol/layer/Layer.js';\nimport olSourceCluster from 'ol/source/Cluster.js';\nimport olLayerImage from 'ol/layer/Image.js';\nimport {olcsListen, getUid} from './util.js';\nimport olLayerVector from 'ol/layer/Vector.js';\nimport olLayerVectorTile from 'ol/layer/VectorTile.js';\nimport olcsAbstractSynchronizer from './AbstractSynchronizer.js';\nimport olcsFeatureConverter from './FeatureConverter.js';\n\nclass VectorSynchronizer extends olcsAbstractSynchronizer {\n  /**\n   * Unidirectionally synchronize OpenLayers vector layers to Cesium.\n   * @param {!ol.Map} map\n   * @param {!Cesium.Scene} scene\n   * @param {olcs.FeatureConverter=} opt_converter\n   * @extends {olcs.AbstractSynchronizer.<olcs.core.VectorLayerCounterpart>}\n   * @api\n   */\n  constructor(map, scene, opt_converter) {\n    super(map, scene);\n\n    /**\n     * @protected\n     */\n    this.converter = opt_converter || new olcsFeatureConverter(scene);\n\n    /**\n     * @private\n     */\n    this.csAllPrimitives_ = new Cesium.PrimitiveCollection();\n    scene.primitives.add(this.csAllPrimitives_);\n    this.csAllPrimitives_.destroyPrimitives = false;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  addCesiumObject(counterpart) {\n    console.assert(counterpart);\n    counterpart.getRootPrimitive()['counterpart'] = counterpart;\n    this.csAllPrimitives_.add(counterpart.getRootPrimitive());\n  }\n\n  /**\n   * @inheritDoc\n   */\n  destroyCesiumObject(object) {\n    object.getRootPrimitive().destroy();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  removeSingleCesiumObject(object, destroy) {\n    object.destroy();\n    this.csAllPrimitives_.destroyPrimitives = destroy;\n    this.csAllPrimitives_.remove(object.getRootPrimitive());\n    this.csAllPrimitives_.destroyPrimitives = false;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  removeAllCesiumObjects(destroy) {\n    this.csAllPrimitives_.destroyPrimitives = destroy;\n    if (destroy) {\n      for (let i = 0; i < this.csAllPrimitives_.length; ++i) {\n        this.csAllPrimitives_.get(i)['counterpart'].destroy();\n      }\n    }\n    this.csAllPrimitives_.removeAll();\n    this.csAllPrimitives_.destroyPrimitives = false;\n  }\n\n  /**\n   * Synchronizes the layer visibility properties\n   * to the given Cesium Primitive.\n   * @param {import('olsc/core.js').LayerWithParents} olLayerWithParents\n   * @param {!Cesium.Primitive} csPrimitive\n   */\n  updateLayerVisibility(olLayerWithParents, csPrimitive) {\n    let visible = true;\n    [olLayerWithParents.layer].concat(olLayerWithParents.parents).forEach((olLayer) => {\n      const layerVisible = olLayer.getVisible();\n      if (layerVisible !== undefined) {\n        visible &= layerVisible;\n      } else {\n        visible = false;\n      }\n    });\n    csPrimitive.show = visible;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  createSingleLayerCounterparts(olLayerWithParents) {\n    const olLayer = olLayerWithParents.layer;\n    if (!(olLayer instanceof olLayerVector) || olLayer instanceof olLayerVectorTile) {\n      return null;\n    }\n    console.assert(olLayer instanceof olLayerLayer);\n\n    let source = olLayer.getSource();\n    if (source instanceof olSourceCluster) {\n      source = source.getSource();\n    }\n\n    if (!source) {\n      return null;\n    }\n\n    console.assert(source instanceof olSourceVector);\n    console.assert(this.view);\n\n    const view = this.view;\n    const featurePrimitiveMap = {};\n    const counterpart = this.converter.olVectorLayerToCesium(olLayer, view,\n        featurePrimitiveMap);\n    const csPrimitives = counterpart.getRootPrimitive();\n    const olListenKeys = counterpart.olListenKeys;\n\n    [olLayerWithParents.layer].concat(olLayerWithParents.parents).forEach((olLayerItem) => {\n      olListenKeys.push(olcsListen(olLayerItem, 'change:visible', () => {\n        this.updateLayerVisibility(olLayerWithParents, csPrimitives);\n      }));\n    });\n    this.updateLayerVisibility(olLayerWithParents, csPrimitives);\n\n    const onAddFeature = (function(feature) {\n      console.assert(\n          (olLayer instanceof olLayerVector) ||\n          (olLayer instanceof olLayerImage)\n      );\n      const context = counterpart.context;\n      const prim = this.converter.convert(olLayer, view, feature, context);\n      if (prim) {\n        featurePrimitiveMap[getUid(feature)] = prim;\n        csPrimitives.add(prim);\n      }\n    }).bind(this);\n\n    const onRemoveFeature = (function(feature) {\n      const id = getUid(feature);\n      const context = counterpart.context;\n      const bbs = context.featureToCesiumMap[id];\n      if (bbs) {\n        delete context.featureToCesiumMap[id];\n        bbs.forEach((bb) => {\n          if (bb instanceof Cesium.Billboard) {\n            context.billboards.remove(bb);\n          }\n        });\n      }\n      const csPrimitive = featurePrimitiveMap[id];\n      delete featurePrimitiveMap[id];\n      if (csPrimitive) {\n        csPrimitives.remove(csPrimitive);\n      }\n    }).bind(this);\n\n    olListenKeys.push(olcsListen(source, 'addfeature', (e) => {\n      console.assert(e.feature);\n      onAddFeature(e.feature);\n    }, this));\n\n    olListenKeys.push(olcsListen(source, 'removefeature', (e) => {\n      console.assert(e.feature);\n      onRemoveFeature(e.feature);\n    }, this));\n\n    olListenKeys.push(olcsListen(source, 'changefeature', (e) => {\n      const feature = e.feature;\n      console.assert(feature);\n      onRemoveFeature(feature);\n      onAddFeature(feature);\n    }, this));\n\n    return counterpart ? [counterpart] : null;\n  }\n}\n\nexport default VectorSynchronizer;\n","/**\n * @module olcs.SynchronizedOverlay\n */\nimport olOverlay from 'ol/Overlay.js';\nimport {transform} from 'ol/proj.js';\nimport {removeNode, removeChildren} from './util.js';\nimport {unByKey as olObservableUnByKey} from 'ol/Observable.js';\n\n\n/**\n * Options for SynchronizedOverlay\n * @typedef {Object} SynchronizedOverlayOptions\n * @property {!Cesium.Scene} scene\n * @property {olOverlay} parent\n * @property {!import('olsc/OverlaySynchronizer.js').default} synchronizer\n */\n\n\nclass SynchronizedOverlay extends olOverlay {\n  /**\n   * @param {olcsx.SynchronizedOverlayOptions} options SynchronizedOverlay Options.\n   * @api\n   */\n  constructor(options) {\n    const parent = options.parent;\n    super(parent.getOptions());\n\n    /**\n     * @private\n     * @type {?Function}\n     */\n    this.scenePostRenderListenerRemover_ = null;\n\n    /**\n     * @private\n     * @type {!Cesium.Scene}\n     */\n    this.scene_ = options.scene;\n\n    /**\n     * @private\n     * @type {!olcs.OverlaySynchronizer}\n     */\n    this.synchronizer_ = options.synchronizer;\n\n    /**\n     * @private\n     * @type {!ol.Overlay}\n     */\n    this.parent_ = parent;\n\n    /**\n     * @private\n     * @type {ol.Coordinate|undefined}\n     */\n    this.positionWGS84_ = undefined;\n\n    /**\n     * @private\n     * @type {MutationObserver}\n     */\n    this.observer_ = new MutationObserver(this.handleElementChanged.bind(this));\n\n    /**\n     * @private\n     * @type {Array.<MutationObserver>}\n     */\n    this.attributeObserver_ = [];\n\n    /**\n     * @private\n     * @type {Array<ol.EventsKey>}\n     */\n    this.listenerKeys_ = [];\n    // synchronize our Overlay with the parent Overlay\n    const setPropertyFromEvent = event => this.setPropertyFromEvent_(event);\n    this.listenerKeys_.push(this.parent_.on('change:position', setPropertyFromEvent));\n    this.listenerKeys_.push(this.parent_.on('change:element', setPropertyFromEvent));\n    this.listenerKeys_.push(this.parent_.on('change:offset', setPropertyFromEvent));\n    this.listenerKeys_.push(this.parent_.on('change:position', setPropertyFromEvent));\n    this.listenerKeys_.push(this.parent_.on('change:positioning', setPropertyFromEvent));\n\n    this.setProperties(this.parent_.getProperties());\n\n    this.handleMapChanged();\n    this.handleElementChanged();\n  }\n\n  /**\n   * @param {Node} target\n   * @private\n   */\n  observeTarget_(target) {\n    if (!this.observer_) {\n      // not ready, skip the event (this occurs on construction)\n      return;\n    }\n    this.observer_.disconnect();\n    this.observer_.observe(target, {\n      attributes: false,\n      childList: true,\n      characterData: true,\n      subtree: true\n    });\n    this.attributeObserver_.forEach((observer) => {\n      observer.disconnect();\n    });\n    this.attributeObserver_.length = 0;\n    for (let i = 0; i < target.childNodes.length; i++) {\n      const node = target.childNodes[i];\n      if (node.nodeType === 1) {\n        const observer = new MutationObserver(this.handleElementChanged.bind(this));\n        observer.observe(node, {\n          attributes: true,\n          subtree: true\n        });\n        this.attributeObserver_.push(observer);\n      }\n    }\n  }\n\n  /**\n   *\n   * @param {ol.Object.Event} event\n   * @private\n   */\n  setPropertyFromEvent_(event) {\n    if (event.target && event.key) {\n      this.set(event.key, event.target.get(event.key));\n    }\n  }\n\n  /**\n   * Get the scene associated with this overlay.\n   * @see ol.Overlay.prototype.getMap\n   * @return {!Cesium.Scene} The scene that the overlay is part of.\n   * @api\n   */\n  getScene() {\n    return this.scene_;\n  }\n\n  /**\n   * @override\n   */\n  handleMapChanged() {\n    if (this.scenePostRenderListenerRemover_) {\n      this.scenePostRenderListenerRemover_();\n      removeNode(this.element);\n    }\n    this.scenePostRenderListenerRemover_ = null;\n    const scene = this.getScene();\n    if (scene) {\n      this.scenePostRenderListenerRemover_ = scene.postRender.addEventListener(this.updatePixelPosition.bind(this));\n      this.updatePixelPosition();\n      const container = this.stopEvent ?\n        this.synchronizer_.getOverlayContainerStopEvent() : this.synchronizer_.getOverlayContainer();\n      if (this.insertFirst) {\n        container.insertBefore(this.element, container.childNodes[0] || null);\n      } else {\n        container.appendChild(this.element);\n      }\n    }\n  }\n\n  /**\n   * @override\n   */\n  handlePositionChanged() {\n    // transform position to WGS84\n    const position = this.getPosition();\n    if (position) {\n      const sourceProjection = this.parent_.getMap().getView().getProjection();\n      this.positionWGS84_ = transform(position, sourceProjection, 'EPSG:4326');\n    } else {\n      this.positionWGS84_ = undefined;\n    }\n    this.updatePixelPosition();\n  }\n\n  /**\n   * @override\n   */\n  handleElementChanged() {\n    function cloneNode(node, parent) {\n      const clone = node.cloneNode();\n      if (node.nodeName === 'CANVAS') {\n        const ctx = clone.getContext('2d');\n        ctx.drawImage(node, 0, 0);\n      }\n      if (parent) {\n        parent.appendChild(clone);\n      }\n      if (node.nodeType != Node.TEXT_NODE) {\n        clone.addEventListener('click', (event) => {\n          node.dispatchEvent(new MouseEvent('click', event));\n          event.stopPropagation();\n        });\n      }\n      const nodes = node.childNodes;\n      for (let i = 0; i < nodes.length; i++) {\n        if (!nodes[i]) {\n          continue;\n        }\n        cloneNode(nodes[i], clone);\n      }\n      return clone;\n    }\n    removeChildren(this.element);\n    const element = this.getElement();\n    if (element) {\n      if (element.parentNode && element.parentNode.childNodes) {\n        for (const node of element.parentNode.childNodes) {\n          const clonedNode = cloneNode(node, null);\n          this.element.appendChild(clonedNode);\n        }\n      }\n    }\n    if (element.parentNode) {\n      // set new Observer\n      this.observeTarget_(element.parentNode);\n    }\n  }\n\n  /**\n   * @override\n   */\n  updatePixelPosition() {\n    const position = this.positionWGS84_;\n    if (!this.scene_ || !position) {\n      this.setVisible(false);\n      return;\n    }\n    let height = 0;\n    if (position.length === 2) {\n      const globeHeight = this.scene_.globe.getHeight(Cesium.Cartographic.fromDegrees(position[0], position[1]));\n      if (globeHeight && this.scene_.globe.tilesLoaded) {\n        position[2] = globeHeight;\n      }\n      if (globeHeight) {\n        height = globeHeight;\n      }\n    } else {\n      height = position[2];\n    }\n    const cartesian = Cesium.Cartesian3.fromDegrees(position[0], position[1], height);\n    const camera = this.scene_.camera;\n    const ellipsoidBoundingSphere = new Cesium.BoundingSphere(new Cesium.Cartesian3(), 6356752);\n    const occluder = new Cesium.Occluder(ellipsoidBoundingSphere, camera.position);\n    // check if overlay position is behind the horizon\n    if (!occluder.isPointVisible(cartesian)) {\n      this.setVisible(false);\n      return;\n    }\n    const cullingVolume = camera.frustum.computeCullingVolume(camera.position, camera.direction, camera.up);\n    // check if overlay position is visible from the camera\n    if (cullingVolume.computeVisibility(new Cesium.BoundingSphere(cartesian)) !== 1) {\n      this.setVisible(false);\n      return;\n    }\n    this.setVisible(true);\n\n    const pixelCartesian = this.scene_.cartesianToCanvasCoordinates(cartesian);\n    const pixel = [pixelCartesian.x, pixelCartesian.y];\n    const mapSize = [this.scene_.canvas.width, this.scene_.canvas.height];\n    this.updateRenderedPosition(pixel, mapSize);\n  }\n\n  /**\n   * Destroys the overlay, removing all its listeners and elements\n   * @api\n   */\n  destroy() {\n    if (this.scenePostRenderListenerRemover_) {\n      this.scenePostRenderListenerRemover_();\n    }\n    if (this.observer_) {\n      this.observer_.disconnect();\n    }\n    olObservableUnByKey(this.listenerKeys_);\n    this.listenerKeys_.splice(0);\n    if (this.element.removeNode) {\n      this.element.removeNode(true);\n    } else {\n      this.element.remove();\n    }\n    this.element = null;\n  }\n}\n\nexport default SynchronizedOverlay;\n","/**\n * @module olcs.OverlaySynchronizer\n */\nimport olcsSynchronizedOverlay from './SynchronizedOverlay.js';\nimport {getUid} from './util.js';\n\nclass OverlaySynchronizer {\n  /**\n  * @param {!ol.Map} map\n  * @param {!Cesium.Scene} scene\n  * @constructor\n  * @template T\n  * @api\n  */\n  constructor(map, scene) {\n    /**\n    * @type {!ol.Map}\n    * @protected\n    */\n    this.map = map;\n\n    /**\n    * @type {ol.Collection.<ol.Overlay>}\n    * @private\n    */\n    this.overlays_ = this.map.getOverlays();\n\n    /**\n    * @type {!Cesium.Scene}\n    * @protected\n    */\n    this.scene = scene;\n\n    /**\n    * @private\n    * @type {!Element}\n    */\n    this.overlayContainerStopEvent_ = document.createElement('DIV');\n    this.overlayContainerStopEvent_.className = 'ol-overlaycontainer-stopevent';\n    const overlayEvents = ['click', 'dblclick', 'mousedown', 'touchstart', 'MSPointerDown', 'pointerdown', 'mousewheel', 'wheel'];\n    overlayEvents.forEach((event) => {\n      this.overlayContainerStopEvent_.addEventListener(event, evt => evt.stopPropagation());\n    });\n    this.scene.canvas.parentElement.appendChild(this.overlayContainerStopEvent_);\n\n    /**\n    * @private\n    * @type {!Element}\n    */\n    this.overlayContainer_ = document.createElement('DIV');\n    this.overlayContainer_.className = 'ol-overlaycontainer';\n    this.scene.canvas.parentElement.appendChild(this.overlayContainer_);\n\n\n    /**\n    * @type {!Object<?,olcs.SynchronizedOverlay>}\n    * @private\n    */\n    this.overlayMap_ = {};\n  }\n\n  /**\n  * Get the element that serves as a container for overlays that don't allow\n  * event propagation. Elements added to this container won't let mousedown and\n  * touchstart events through to the map, so clicks and gestures on an overlay\n  * don't trigger any {@link ol.MapBrowserEvent}.\n  * @return {!Element} The map's overlay container that stops events.\n  */\n  getOverlayContainerStopEvent() {\n    return this.overlayContainerStopEvent_;\n  }\n\n  /**\n  * Get the element that serves as a container for overlays.\n  * @return {!Element} The map's overlay container.\n  */\n  getOverlayContainer() {\n    return this.overlayContainer_;\n  }\n\n  /**\n  * Destroy all and perform complete synchronization of the overlays.\n  * @api\n  */\n  synchronize() {\n    this.destroyAll();\n    this.addOverlays();\n    this.overlays_.on('add', this.addOverlayFromEvent_.bind(this));\n    this.overlays_.on('remove', this.removeOverlayFromEvent_.bind(this));\n  }\n\n  /**\n  * @param {ol.Collection.Event} event\n  * @private\n  */\n  addOverlayFromEvent_(event) {\n    const overlay = /** @type {ol.Overlay} */ (event.element);\n    this.addOverlay(overlay);\n  }\n\n  /**\n  * @api\n  */\n  addOverlays() {\n    this.overlays_.forEach((overlay) => { this.addOverlay(overlay); });\n  }\n\n  /**\n  * @param {ol.Overlay} overlay\n  * @api\n  */\n  addOverlay(overlay) {\n    if (!overlay) {\n      return;\n    }\n    const cesiumOverlay = new olcsSynchronizedOverlay({\n      scene: this.scene,\n      synchronizer: this,\n      parent: overlay\n    });\n\n    const overlayId = getUid(overlay).toString();\n    this.overlayMap_[overlayId] = cesiumOverlay;\n  }\n\n  /**\n  * @param {ol.Collection.Event} event\n  * @private\n  */\n  removeOverlayFromEvent_(event) {\n    const removedOverlay = /** @type {ol.Overlay} */ (event.element);\n    this.removeOverlay(removedOverlay);\n  }\n\n  /**\n  * Removes an overlay from the scene\n  * @param {ol.Overlay} overlay\n  * @api\n  */\n  removeOverlay(overlay) {\n    const overlayId = getUid(overlay).toString();\n    const csOverlay = this.overlayMap_[overlayId];\n    if (csOverlay) {\n      csOverlay.destroy();\n      delete this.overlayMap_[overlayId];\n    }\n  }\n\n  /**\n  * Destroys all the created Cesium objects.\n  * @protected\n  */\n  destroyAll() {\n    Object.keys(this.overlayMap_).forEach((key) => {\n      const overlay = this.overlayMap_[key];\n      overlay.destroy();\n      delete this.overlayMap_[key];\n    });\n  }\n}\n\n\nexport default OverlaySynchronizer;\n","/**\n * @module olcs.OLCesium\n */\nimport olGeomPoint from 'ol/geom/Point.js';\nimport {getTransform} from 'ol/proj.js';\nimport olcsUtil from './util.js';\nimport olcsCore from './core.js';\nimport olcsAutoRenderLoop from './AutoRenderLoop.js';\nimport olcsCamera from './Camera.js';\nimport olcsRasterSynchronizer from './RasterSynchronizer.js';\nimport olcsVectorSynchronizer from './VectorSynchronizer.js';\nimport olcsOverlaySynchronizer from './OverlaySynchronizer.js';\n\n\n/**\n * @typedef {Object} OLCesiumOptions\n * @property {import('ol/Map.js').default} map The OpenLayers map we want to show on a Cesium scene.\n * @property {Element|string} [target] Target element for the Cesium scene.\n * @property {function(!import('ol/Map.js').default, !Cesium.Scene, !Cesium.DataSourceCollection): Array<import('olcs/AbstractSynchronizer.js').default>}\n *      [createSynchronizers] Callback function which will be called by the {@link olcs.OLCesium}\n *      constructor to create custom synchronizers. Receives an `ol.Map` and a `Cesium.Scene` as arguments,\n *      and needs to return an array of {@link import('olcs/AbstractSynchronizer.js').default}.\n * @property {function(): Cesium.JulianDate} [time] Control the current time used by Cesium.\n * @property {boolean} [stopOpenLayersEventsPropagation] Prevent propagation of mouse/touch events to\n *      OpenLayers when Cesium is active.\n * @property {Cesium.SceneOptions} [sceneOptions] Allows the passing of property value to the\n *      `Cesium.Scene`.\n */\n\n\nclass OLCesium {\n  /**\n   * @param {!OLCesiumOptions} options Options.\n   * @constructor\n   * @api\n   */\n  constructor(options) {\n\n    /**\n     * @type {olcs.AutoRenderLoop}\n     * @private\n     */\n    this.autoRenderLoop_ = null;\n\n    /**\n     * @type {!ol.Map}\n     * @private\n     */\n    this.map_ = options.map;\n\n    /**\n     * @type {!function(): Cesium.JulianDate}\n     * @private\n     */\n    this.time_ = options.time || function() {\n      return Cesium.JulianDate.now();\n    };\n\n    /**\n     * No change of the view projection.\n     * @private\n     */\n    this.to4326Transform_ = getTransform(this.map_.getView().getProjection(), 'EPSG:4326');\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.resolutionScale_ = 1.0;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.canvasClientWidth_ = 0.0;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.canvasClientHeight_ = 0.0;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.resolutionScaleChanged_ = true; // force resize\n\n    const fillArea = 'position:absolute;top:0;left:0;width:100%;height:100%;';\n\n    /**\n     * @type {!Element}\n     * @private\n     */\n    this.container_ = document.createElement('DIV');\n    const containerAttribute = document.createAttribute('style');\n    containerAttribute.value = `${fillArea}visibility:hidden;`;\n    this.container_.setAttributeNode(containerAttribute);\n\n    let targetElement = options.target || this.map_.getViewport();\n    if (typeof targetElement === 'string') {\n      targetElement = document.getElementById(targetElement);\n    }\n    targetElement.appendChild(this.container_);\n\n    /**\n     * Whether the Cesium container is placed over the ol map.\n     * a target => side by side mode\n     * no target => over map mode\n     * @type {boolean}\n     * @private\n     */\n    this.isOverMap_ = !options.target;\n\n\n    if (this.isOverMap_ && options.stopOpenLayersEventsPropagation) {\n      const overlayEvents = ['click', 'dblclick', 'mousedown', 'touchstart', 'MSPointerDown', 'pointerdown', 'mousewheel', 'wheel'];\n      for (let i = 0, ii = overlayEvents.length; i < ii; ++i) {\n        this.container_.addEventListener(overlayEvents[i], evt => evt.stopPropagation());\n      }\n    }\n\n\n    /**\n     * @type {!HTMLCanvasElement}\n     * @private\n     */\n    this.canvas_ = /** @type {!HTMLCanvasElement} */ (document.createElement('CANVAS'));\n    const canvasAttribute = document.createAttribute('style');\n    canvasAttribute.value = fillArea;\n    this.canvas_.setAttributeNode(canvasAttribute);\n\n    if (olcsUtil.supportsImageRenderingPixelated()) {\n      // non standard CSS4\n      this.canvas_.style['imageRendering'] = olcsUtil.imageRenderingValue();\n    }\n\n    this.canvas_.oncontextmenu = function() { return false; };\n    this.canvas_.onselectstart = function() { return false; };\n\n    this.container_.appendChild(this.canvas_);\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.enabled_ = false;\n\n    /**\n     * @type {!Array.<ol.interaction.Interaction>}\n     * @private\n     */\n    this.pausedInteractions_ = [];\n\n    /**\n     * @type {?ol.layer.Group}\n     * @private\n     */\n    this.hiddenRootGroup_ = null;\n\n    const sceneOptions = options.sceneOptions !== undefined ? options.sceneOptions :\n      /** @type {Cesium.SceneOptions} */ ({});\n    sceneOptions.canvas = this.canvas_;\n    sceneOptions.scene3DOnly = true;\n\n    /**\n     * @type {!Cesium.Scene}\n     * @private\n     */\n    this.scene_ = new Cesium.Scene(sceneOptions);\n\n    const sscc = this.scene_.screenSpaceCameraController;\n\n    sscc.tiltEventTypes.push({\n      'eventType': Cesium.CameraEventType.LEFT_DRAG,\n      'modifier': Cesium.KeyboardEventModifier.SHIFT\n    });\n\n    sscc.tiltEventTypes.push({\n      'eventType': Cesium.CameraEventType.LEFT_DRAG,\n      'modifier': Cesium.KeyboardEventModifier.ALT\n    });\n\n    sscc.enableLook = false;\n\n    this.scene_.camera.constrainedAxis = Cesium.Cartesian3.UNIT_Z;\n\n    /**\n     * @type {!olcs.Camera}\n     * @private\n     */\n    this.camera_ = new olcsCamera(this.scene_, this.map_);\n\n    /**\n     * @type {!Cesium.Globe}\n     * @private\n     */\n    this.globe_ = new Cesium.Globe(Cesium.Ellipsoid.WGS84);\n    this.globe_.baseColor = Cesium.Color.WHITE;\n    this.scene_.globe = this.globe_;\n    this.scene_.skyAtmosphere = new Cesium.SkyAtmosphere();\n\n    // The first layer of Cesium is special; using a 1x1 transparent image to workaround it.\n    // See https://github.com/AnalyticalGraphicsInc/cesium/issues/1323 for details.\n    const firstImageryProvider = new Cesium.SingleTileImageryProvider({\n      url: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=',\n      rectangle: Cesium.Rectangle.fromDegrees(0, 0, 1, 1) // the Rectangle dimensions are arbitrary\n    });\n    this.globe_.imageryLayers.addImageryProvider(firstImageryProvider, 0);\n\n    this.dataSourceCollection_ = new Cesium.DataSourceCollection();\n    this.dataSourceDisplay_ = new Cesium.DataSourceDisplay({\n      scene: this.scene_,\n      dataSourceCollection: this.dataSourceCollection_\n    });\n\n    const synchronizers = options.createSynchronizers ?\n      options.createSynchronizers(this.map_, this.scene_, this.dataSourceCollection_) : [\n        new olcsRasterSynchronizer(this.map_, this.scene_),\n        new olcsVectorSynchronizer(this.map_, this.scene_),\n        new olcsOverlaySynchronizer(this.map_, this.scene_)\n      ];\n\n    // Assures correct canvas size after initialisation\n    this.handleResize_();\n\n    for (let i = synchronizers.length - 1; i >= 0; --i) {\n      synchronizers[i].synchronize();\n    }\n\n    /**\n     * Time of the last rendered frame, as returned by `performance.now()`.\n     * @type {number}\n     * @private\n     */\n    this.lastFrameTime_ = 0;\n\n    /**\n     * The identifier returned by `requestAnimationFrame`.\n     * @type {number|undefined}\n     * @private\n     */\n    this.renderId_ = undefined;\n\n    /**\n     * Target frame rate for the render loop.\n     * @type {number}\n     * @private\n     */\n    this.targetFrameRate_ = Number.POSITIVE_INFINITY;\n\n    /**\n     * If the Cesium render loop is being blocked.\n     * @type {boolean}\n     * @private\n     */\n    this.blockCesiumRendering_ = false;\n\n    /**\n     * If the warmup routine is active.\n     * @type {boolean}\n     * @private\n     */\n    this.warmingUp_ = false;\n\n    /**\n     * @type {ol.Feature}\n     * @private\n     */\n    this.trackedFeature_ = null;\n\n    /**\n     * @type {Cesium.Entity}\n     * @private\n     */\n    this.trackedEntity_ = null;\n\n    /**\n     * @type {Cesium.EntityView}\n     * @private\n     */\n    this.entityView_ = null;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.needTrackedEntityUpdate_ = false;\n\n    /**\n     * @type {!Cesium.BoundingSphere}\n     */\n    this.boundingSphereScratch_ = new Cesium.BoundingSphere();\n\n    const eventHelper = new Cesium.EventHelper();\n    eventHelper.add(this.scene_.postRender, OLCesium.prototype.updateTrackedEntity_, this);\n\n    // Cesium has a mechanism to prevent the camera to go under the terrain.\n    // Unfortunately, it is only active when all the terrain has been loaded, which:\n    // - does not prevent the camera to sink under terrain anymore;\n    // - introduce a jumping effect once all terrain has been loaded and the position of the camera is finally fixed.\n    // The property below enables a workaround found in the Camptocamp Cesium fork.\n    // See also https://github.com/AnalyticalGraphicsInc/cesium/issues/5999.\n    Cesium.Camera.enableSuspendTerrainAdjustment = false;\n  }\n\n  /**\n   * Render the Cesium scene.\n   * @private\n   */\n  render_() {\n    // if a call to `requestAnimationFrame` is pending, cancel it\n    if (this.renderId_ !== undefined) {\n      cancelAnimationFrame(this.renderId_);\n      this.renderId_ = undefined;\n    }\n\n    // only render if Cesium is enabled/warming and rendering hasn't been blocked\n    if ((this.enabled_ || this.warmingUp_) && !this.blockCesiumRendering_) {\n      this.renderId_ = requestAnimationFrame(this.onAnimationFrame_.bind(this));\n    }\n  }\n\n  /**\n   * Callback for `requestAnimationFrame`.\n   * @param {number} frameTime The frame time, from `performance.now()`.\n   * @private\n   */\n  onAnimationFrame_(frameTime) {\n    this.renderId_ = undefined;\n\n    // check if a frame was rendered within the target frame rate\n    const interval = 1000.0 / this.targetFrameRate_;\n    const delta = frameTime - this.lastFrameTime_;\n    if (delta < interval) {\n      // too soon, don't render yet\n      this.render_();\n      return;\n    }\n\n    // time to render a frame, save the time\n    this.lastFrameTime_ = frameTime;\n\n    const julianDate = this.time_();\n    this.scene_.initializeFrame();\n    this.handleResize_();\n    this.dataSourceDisplay_.update(julianDate);\n\n    // Update tracked entity\n    if (this.entityView_) {\n      const trackedEntity = this.trackedEntity_;\n      const trackedState = this.dataSourceDisplay_.getBoundingSphere(trackedEntity, false, this.boundingSphereScratch_);\n      if (trackedState === Cesium.BoundingSphereState.DONE) {\n        this.boundingSphereScratch_.radius = 1; // a radius of 1 is enough for tracking points\n        this.entityView_.update(julianDate, this.boundingSphereScratch_);\n      }\n    }\n\n    this.scene_.render(julianDate);\n    this.camera_.checkCameraChange();\n\n    // request the next render call after this one completes to ensure the browser doesn't get backed up\n    this.render_();\n  }\n\n  /**\n   * @private\n   */\n  updateTrackedEntity_() {\n    if (!this.needTrackedEntityUpdate_) {\n      return;\n    }\n\n    const trackedEntity = this.trackedEntity_;\n    const scene = this.scene_;\n\n    const state = this.dataSourceDisplay_.getBoundingSphere(trackedEntity, false, this.boundingSphereScratch_);\n    if (state === Cesium.BoundingSphereState.PENDING) {\n      return;\n    }\n\n    scene.screenSpaceCameraController.enableTilt = false;\n\n    const bs = state !== Cesium.BoundingSphereState.FAILED ? this.boundingSphereScratch_ : undefined;\n    if (bs) {\n      bs.radius = 1;\n    }\n    this.entityView_ = new Cesium.EntityView(trackedEntity, scene, scene.mapProjection.ellipsoid);\n    this.entityView_.update(this.time_(), bs);\n    this.needTrackedEntityUpdate_ = false;\n  }\n\n  /**\n   * @private\n   */\n  handleResize_() {\n    let width = this.canvas_.clientWidth;\n    let height = this.canvas_.clientHeight;\n\n    if (width === 0 | height === 0) {\n      // The canvas DOM element is not ready yet.\n      return;\n    }\n\n    if (width === this.canvasClientWidth_ &&\n        height === this.canvasClientHeight_ &&\n        !this.resolutionScaleChanged_) {\n      return;\n    }\n\n    let resolutionScale = this.resolutionScale_;\n    if (!olcsUtil.supportsImageRenderingPixelated()) {\n      resolutionScale *= window.devicePixelRatio || 1.0;\n    }\n    this.resolutionScaleChanged_ = false;\n\n    this.canvasClientWidth_ = width;\n    this.canvasClientHeight_ = height;\n\n    width *= resolutionScale;\n    height *= resolutionScale;\n\n    this.canvas_.width = width;\n    this.canvas_.height = height;\n    this.scene_.camera.frustum.aspectRatio = width / height;\n  }\n\n  /**\n   * @return {!olcs.Camera}\n   * @api\n   */\n  getCamera() {\n    return this.camera_;\n  }\n\n  /**\n   * @return {!ol.Map}\n   * @api\n   */\n  getOlMap() {\n    return this.map_;\n  }\n\n  /**\n   * @return {!ol.View}\n   * @api\n   */\n  getOlView() {\n    const view = this.map_.getView();\n    console.assert(view);\n    return view;\n  }\n\n  /**\n   * @return {!Cesium.Scene}\n   * @api\n   */\n  getCesiumScene() {\n    return this.scene_;\n  }\n\n  /**\n   * @return {!Cesium.DataSourceCollection}\n   * @api\n   */\n  getDataSources() {\n    return this.dataSourceCollection_;\n  }\n\n  /**\n   * @return {!Cesium.DataSourceDisplay}\n   * @api\n   */\n  getDataSourceDisplay() {\n    return this.dataSourceDisplay_;\n  }\n\n  /**\n   * @return {boolean}\n   * @api\n   */\n  getEnabled() {\n    return this.enabled_;\n  }\n\n  /**\n   * Enables/disables the Cesium.\n   * This modifies the visibility style of the container element.\n   * @param {boolean} enable\n   * @api\n   */\n  setEnabled(enable) {\n    if (this.enabled_ === enable) {\n      return;\n    }\n    this.enabled_ = enable;\n\n    // some Cesium operations are operating with canvas.clientWidth,\n    // so we can't remove it from DOM or even make display:none;\n    this.container_.style.visibility = this.enabled_ ? 'visible' : 'hidden';\n    let interactions;\n    if (this.enabled_) {\n      this.throwOnUnitializedMap_();\n      if (this.isOverMap_) {\n        interactions = this.map_.getInteractions();\n        interactions.forEach((el, i, arr) => {\n          this.pausedInteractions_.push(el);\n        });\n        interactions.clear();\n\n        this.map_.addInteraction = interaction => this.pausedInteractions_.push(interaction);\n        this.map_.removeInteraction = interaction =>\n          this.pausedInteractions_ = this.pausedInteractions_.filter(i => i !== interaction);\n\n        const rootGroup = this.map_.getLayerGroup();\n        if (rootGroup.getVisible()) {\n          this.hiddenRootGroup_ = rootGroup;\n          this.hiddenRootGroup_.setVisible(false);\n        }\n\n        this.map_.getOverlayContainer().classList.add('olcs-hideoverlay');\n      }\n\n      this.camera_.readFromView();\n      this.render_();\n    } else {\n      if (this.isOverMap_) {\n        interactions = this.map_.getInteractions();\n        this.pausedInteractions_.forEach((interaction) => {\n          interactions.push(interaction);\n        });\n        this.pausedInteractions_.length = 0;\n\n        this.map_.addInteraction = interaction => this.map_.getInteractions().push(interaction);\n        this.map_.removeInteraction = interaction => this.map_.getInteractions().remove(interaction);\n\n        this.map_.getOverlayContainer().classList.remove('olcs-hideoverlay');\n        if (this.hiddenRootGroup_) {\n          this.hiddenRootGroup_.setVisible(true);\n          this.hiddenRootGroup_ = null;\n        }\n      }\n\n      this.camera_.updateView();\n    }\n  }\n\n  /**\n   * Preload Cesium so that it is ready when transitioning from 2D to 3D.\n   * @param {number} height Target height of the camera\n   * @param {number} timeout Milliseconds after which the warming will stop\n   * @api\n  */\n  warmUp(height, timeout) {\n    if (this.enabled_) {\n      // already enabled\n      return;\n    }\n    this.throwOnUnitializedMap_();\n    this.camera_.readFromView();\n    const ellipsoid = this.globe_.ellipsoid;\n    const csCamera = this.scene_.camera;\n    const position = ellipsoid.cartesianToCartographic(csCamera.position);\n    if (position.height < height) {\n      position.height = height;\n      csCamera.position = ellipsoid.cartographicToCartesian(position);\n    }\n\n    this.warmingUp_ = true;\n    this.render_();\n\n    setTimeout(() => {\n      this.warmingUp_ = false;\n    }, timeout);\n  }\n\n  /**\n   * Block Cesium rendering to save resources.\n   * @param {boolean} block True to block.\n   * @api\n  */\n  setBlockCesiumRendering(block) {\n    if (this.blockCesiumRendering_ !== block) {\n      this.blockCesiumRendering_ = block;\n\n      // reset the render loop\n      this.render_();\n    }\n  }\n\n  /**\n   * Render the globe only when necessary in order to save resources.\n   * Experimental.\n   * @api\n   */\n  enableAutoRenderLoop() {\n    if (!this.autoRenderLoop_) {\n      this.autoRenderLoop_ = new olcsAutoRenderLoop(this);\n    }\n  }\n\n  /**\n   * Get the autorender loop.\n   * @return {?olcs.AutoRenderLoop}\n   * @api\n  */\n  getAutoRenderLoop() {\n    return this.autoRenderLoop_;\n  }\n\n  /**\n   * The 3D Cesium globe is rendered in a canvas with two different dimensions:\n   * clientWidth and clientHeight which are the dimension on the screen and\n   * width and height which are the dimensions of the drawing buffer.\n   *\n   * By using a resolution scale lower than 1.0, it is possible to render the\n   * globe in a buffer smaller than the canvas client dimensions and improve\n   * performance, at the cost of quality.\n   *\n   * Pixel ratio should also be taken into account; by default, a device with\n   * pixel ratio of 2.0 will have a buffer surface 4 times bigger than the client\n   * surface.\n   *\n   * @param {number} value\n   * @this {olcs.OLCesium}\n   * @api\n   */\n  setResolutionScale(value) {\n    value = Math.max(0, value);\n    if (value !== this.resolutionScale_) {\n      this.resolutionScale_ = Math.max(0, value);\n      this.resolutionScaleChanged_ = true;\n      if (this.autoRenderLoop_) {\n        this.autoRenderLoop_.restartRenderLoop();\n      }\n    }\n  }\n\n  /**\n   * Set the target frame rate for the renderer. Set to `Number.POSITIVE_INFINITY`\n   * to render as quickly as possible.\n   * @param {number} value The frame rate, in frames per second.\n   * @api\n   */\n  setTargetFrameRate(value) {\n    if (this.targetFrameRate_ !== value) {\n      this.targetFrameRate_ = value;\n\n      // reset the render loop\n      this.render_();\n    }\n  }\n\n  /**\n   * Check if OpenLayers map is not properly initialized.\n   * @private\n   */\n  throwOnUnitializedMap_() {\n    const map = this.map_;\n    const view = map.getView();\n    const center = view.getCenter();\n    if (!view.isDef() || isNaN(center[0]) || isNaN(center[1])) {\n      throw new Error(`The OpenLayers map is not properly initialized: ${center} / ${view.getResolution()}`);\n    }\n  }\n\n  /**\n   * @type {ol.Feature}\n   */\n  get trackedFeature() {\n    return this.trackedFeature_;\n  }\n\n  /**\n   * @param {ol.Feature} feature\n   */\n  set trackedFeature(feature) {\n    if (this.trackedFeature_ !== feature) {\n\n      const scene = this.scene_;\n\n      //Stop tracking\n      if (!feature || !feature.getGeometry()) {\n        this.needTrackedEntityUpdate_ = false;\n        scene.screenSpaceCameraController.enableTilt = true;\n\n        if (this.trackedEntity_) {\n          this.dataSourceDisplay_.defaultDataSource.entities.remove(this.trackedEntity_);\n        }\n        this.trackedEntity_ = null;\n        this.trackedFeature_ = null;\n        this.entityView_ = null;\n        scene.camera.lookAtTransform(Cesium.Matrix4.IDENTITY);\n        return;\n      }\n\n      this.trackedFeature_ = feature;\n\n      //We can't start tracking immediately, so we set a flag and start tracking\n      //when the bounding sphere is ready (most likely next frame).\n      this.needTrackedEntityUpdate_ = true;\n\n      const to4326Transform = this.to4326Transform_;\n      const toCesiumPosition = function() {\n        const geometry = feature.getGeometry();\n        console.assert(geometry instanceof olGeomPoint);\n        const coo = geometry.getCoordinates();\n        const coo4326 = to4326Transform(coo, undefined, coo.length);\n        return olcsCore.ol4326CoordinateToCesiumCartesian(coo4326);\n      };\n\n      // Create an invisible point entity for tracking.\n      // It is independant from the primitive/geometry created by the vector synchronizer.\n      const options = {\n        'position': new Cesium.CallbackProperty((time, result) => toCesiumPosition(), false),\n        'point': {\n          'pixelSize': 1,\n          'color': Cesium.Color.TRANSPARENT\n        }\n      };\n\n      this.trackedEntity_ = this.dataSourceDisplay_.defaultDataSource.entities.add(options);\n    }\n  }\n}\n\nexport default OLCesium;\n","<script>\r\nimport { useSlots, onBeforeMount, onMounted, onBeforeUnmount, ref, reactive, computed, watch, nextTick, defineAsyncComponent, useCssModule, inject, getCurrentInstance } from 'vue'\r\nimport $ from 'jquery'\r\nimport { useStore } from 'vuex'\r\n\r\nimport { Map, View, Feature } from 'ol'\r\nimport Select from 'ol/interaction/Select'\r\nimport { click } from 'ol/events/condition'\r\nimport { ScaleLine } from 'ol/control.js'\r\nimport XYZ from 'ol/source/XYZ'\r\nimport VectorSource from 'ol/source/Vector.js'\r\nimport { Tile, Vector } from 'ol/layer.js'\r\nimport { Point } from 'ol/geom.js'\r\nimport { Icon, Style } from 'ol/style.js'\r\n\r\nimport OLCesium from 'olcs/OLCesium.js'\r\n\r\nimport 'ol/ol.css'\r\nimport 'ol-ext/dist/ol-ext.css'\r\nimport Overlay from 'ol/Overlay.js'\r\nimport currentPositionImg from '@/assets/img/icon/currentPosition.svg'\r\n\r\nimport mapLayerList from '@/config/mapLayerList'\r\nimport baseMapList, { getBaseMapAll } from '@/config/baseMapList'\r\n\r\nexport default {\r\n    props: {},\r\n    setup(props, { emit }) {\r\n        const getMapLayers = mapLayerList\r\n        const baseMaps = baseMapList\r\n        const store = useStore()\r\n        const state = reactive({\r\n            // defaultCenter: [120.971859, 24.801583],\r\n            // defaultCenterZoom: 14,\r\n            defaultCenter: [121.326776, 24.655499],\r\n            defaultCenterZoom: 14,\r\n            targetNum: 1,\r\n            conditionWrap: false,\r\n            layerSelect: false,\r\n            currentLayers: [],\r\n            layers: [],\r\n            mapLayers: computed(() => {\r\n                return state.layers.map((node, index) => {\r\n                    return {\r\n                        label: node.group_title,\r\n                        value: node.value,\r\n                        layers: node.group_layers,\r\n                        groupClass: node.group_class\r\n                    }\r\n                })\r\n            }),\r\n            selectLock: false,\r\n            mapCount: 1,\r\n            map1: null,\r\n            map2: null,\r\n            map1LayerStatus: [],\r\n            map2LayerStatus: [],\r\n            temp: {\r\n                map1BaseStatus: 0,\r\n                map2BaseStatus: 0,\r\n            },\r\n            deleteLightbox: false,\r\n            // 目前地圖狀態為2D or 3D\r\n            dimensionMap: {\r\n                map1: '2D',\r\n                map2: '2D'\r\n            },\r\n            toSearchDimensionStatus: computed(() => {\r\n                let target = state.targetNum == 1 ? 'map1' : 'map2'\r\n                return state.dimensionMap[target] === '2D'\r\n            }),\r\n            ol3d: null,\r\n            selectValueTemp: 0,\r\n            popup: {\r\n                nodeRef: null,\r\n                overlay: null,\r\n                popupId: 0,\r\n                coordinate: [],\r\n                popupData: '',\r\n            },\r\n            comSize: {\r\n                wrapHeight: '',\r\n                wrapWidth: '',\r\n            },\r\n            tribeQuery: {},\r\n        })\r\n\r\n        let ol3d = null\r\n\r\n        const defaultView = new View({\r\n            projection: 'EPSG:4326',\r\n            center: state.defaultCenter,\r\n            zoom: state.defaultCenterZoom,\r\n        })\r\n\r\n        // 初始化地圖\r\n        function initMap() {\r\n            state.map1 = new Map({\r\n                target: 'map1',\r\n                layers: [\r\n                    baseMapList.getBaseMapData(0)\r\n                ],\r\n                view: defaultView,\r\n                controls: [],\r\n            })\r\n\r\n            state.map1.addControl(new ScaleLine({\r\n                units: 'metric', // 比例尺單位\r\n            }));\r\n        }\r\n\r\n        function addPoint(targetLng, targetLat) {\r\n            const marker = new Vector({\r\n                source: new VectorSource({\r\n                    features: [\r\n                        new Feature({\r\n                            geometry: new Point([targetLng, targetLat]),\r\n                            population: 4000,\r\n                            rainfall: 500,\r\n                        })\r\n                    ]\r\n                }),\r\n                style: new Style({\r\n                    image: new Icon({\r\n                        anchor: [0.5, 100],\r\n                        anchorXUnits: 'fraction',\r\n                        anchorYUnits: 'pixels',\r\n                        src: currentPositionImg,\r\n                    }),\r\n                })\r\n            })\r\n\r\n            let target = state.targetNum == 1 ? 'map1' : 'map2'\r\n            state[target].addLayer(marker)\r\n        }\r\n\r\n        function mapControl({ action, value }) {\r\n            let mainMap = state.map1?.getTarget() == null ? 'map2' : 'map1'\r\n            let View = state[mainMap].getView()\r\n            switch (action) {\r\n                case 'In':\r\n                    View.animate({\r\n                        zoom: View.getZoom() + 1,\r\n                    })\r\n                    break;\r\n                case 'Out':\r\n                    View.animate({\r\n                        zoom: View.getZoom() - 1,\r\n                    })\r\n                    break;\r\n                case 'toNorth':\r\n                    View.animate({\r\n                        rotation: 0,\r\n                    })\r\n                    break;\r\n                case 'moveTo':\r\n                    if (value) {\r\n                        const { xAxis, yAxis } = value\r\n                        View.animate({\r\n                            center: [xAxis, yAxis],\r\n                            zoom: 17,\r\n                            duration: 100,\r\n                        });\r\n                    } else {\r\n                        navigator.geolocation.getCurrentPosition(function (pos) {\r\n                            View.animate({\r\n                                center: [pos.coords.longitude, pos.coords.latitude],\r\n                                zoom: 17,\r\n                                duration: 100,\r\n                            });\r\n                            addPoint(pos.coords.longitude, pos.coords.latitude)\r\n                        })\r\n                    }\r\n                    break;\r\n                case 'fullScreen':\r\n                    let target = document.getElementById(`map${state.targetNum}`)\r\n                    if (target.requestFullscreen) {\r\n                        target.requestFullscreen()\r\n                    } else if (target.msRequestFullscreen) {\r\n                        target.msRequestFullscreen()\r\n                    } else if (target.mozRequestFullScreen) {\r\n                        target.mozRequestFullScreen()\r\n                    } else if (target.webkitRequestFullscreen) {\r\n                        target.webkitRequestFullscreen()\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n\r\n        function layerControl({ action, value }) {\r\n            let target = state.targetNum == 1 ? state.map1 : state.map2\r\n            let targetLayers = target?.getLayers()\r\n            switch (action) {\r\n                case 'layerMode':\r\n                    if (value.checked) {\r\n                        // 避免加到有群組的母層\r\n                        if (!(state.layers[value.nodeIndex].group_layers[value.subNodeIndex].single_tiles)) {\r\n                            let layersAry = targetLayers.getArray()\r\n                            layersAry.forEach(element => {\r\n                                if (!(element.get('id'))) { return }\r\n                                if (element.get('id').includes(`node${value.nodeIndex}_subNode${value.subNodeIndex}_nestedSubNode`)) {\r\n                                    target.removeLayer(element)\r\n                                }\r\n                            })\r\n                            onMapLayerStatus('delete', target.getTarget(), value.id)\r\n                        }\r\n                        let nestedSubNodeIndex = value.nestedSubNodeIndex || state.selectValueTemp\r\n                        let targetLayer = getMapLayers.getLayer(state.layers[value.nodeIndex].group_layers[value.subNodeIndex], nestedSubNodeIndex, value.id)\r\n                        target.addLayer(targetLayer)\r\n                        if (targetLayer.get('label')?.includes('雷達回波預測')) {\r\n                            var source = targetLayer.getSource();\r\n                            var iconFeature = source.getFeatures()[0]\r\n                            const extent = state.layers[value.nodeIndex].group_layers[value.subNodeIndex].image_options.image_extent\r\n\r\n                            // TODO: 等待api 確定後切換成api路徑\r\n                            const gifUrl = targetLayer.get('extra').url;\r\n                            const gif = gifler(gifUrl);\r\n\r\n                            const extentWidth = extent[2] - extent[0];\r\n                            const extentHeight = extent[3] - extent[1];\r\n\r\n                            gif.frames(\r\n                                document.createElement('canvas'),\r\n                                function (ctx, frame) {\r\n                                    const scaleX = extentWidth / frame.width;\r\n                                    const scaleY = extentHeight / frame.height;\r\n                                    const baseScale = Math.min(scaleX, scaleY);\r\n\r\n                                    // 獲取當前地圖的解析度\r\n                                    const currentResolution = state.map1.getView().getResolution()\r\n\r\n                                    iconFeature.setStyle(\r\n                                        new Style({\r\n                                            image: new Icon({\r\n                                                img: ctx.canvas,\r\n                                                imgSize: [frame.width, frame.height],\r\n                                                opacity: 0.8,\r\n                                                scale: baseScale / currentResolution\r\n                                            }),\r\n                                        })\r\n                                    );\r\n\r\n                                    ctx.clearRect(0, 0, frame.width, frame.height);\r\n                                    ctx.drawImage(frame.buffer, frame.x, frame.y);\r\n\r\n                                    target.render();\r\n                                },\r\n                                true\r\n                            );\r\n                        }\r\n                        if (['新竹縣原住民部落範圍', '近年歷史災害82處部落點位', '雨量站'].includes(targetLayer.get('label'))) {\r\n                            mapClickEvent(target, targetLayer.label)\r\n                            addSelectElement(value)\r\n                        }\r\n                        onMapLayerStatus('add', target.getTarget(), value.id)\r\n                    } else {\r\n                        let layersAry = targetLayers.getArray()\r\n                        function removeLayersById(id) {\r\n                            const toRemoveLayerId = layersAry.filter(element => element?.get('id')?.includes(id));\r\n                            toRemoveLayerId.forEach((node) => {\r\n                                target.removeLayer(node);\r\n                            });\r\n                        }\r\n\r\n                        const idMappings = {\r\n                            'node9_subNode0_nestedSubNode': 'node9_subNode0_nestedSubNode',\r\n                            'node12_subNode1_nestedSubNode': 'node12_subNode1_nestedSubNode',\r\n                        };\r\n                        const idToRemove = idMappings[value.id] || value.id;\r\n                        removeLayersById(idToRemove);\r\n                        if (state.layers[value.nodeIndex].group_layers[value.subNodeIndex].layer_type === \"WFS\") {\r\n                            // FIXME: popup 修改\r\n                            // TODO: 結構優化\r\n                            addSelectElement(value);\r\n                            state.popup.popupId = 0\r\n                            state.popup.popupData = '';\r\n                            if (state.popup.overlay) {\r\n                                target.removeOverlay(state.popup.overlay);\r\n                                state.popup.overlay = null;\r\n                            }\r\n                        }\r\n\r\n                        onMapLayerStatus('delete', target.getTarget(), value.id)\r\n                    }\r\n                    break;\r\n                case 'selectLayerMode':\r\n                    if (state.selectLock) { return }\r\n                    if (value.layerName === 'all') {\r\n                        let layersAry = targetLayers.getArray()\r\n                        let layersToRemove = layersAry.filter(node => !(node.get('id') === undefined))\r\n                        layersToRemove.forEach((node) => {\r\n                            target.removeLayer(node)\r\n                        })\r\n                    } else {\r\n                        let layersAry = targetLayers.getArray()\r\n                        layersAry.forEach(element => {\r\n                            if (element.get('id') == value.id) {\r\n                                target.removeLayer(element)\r\n                            }\r\n                        })\r\n                    }\r\n                    break;\r\n                case 'changeOrder':\r\n                    if (state.selectLock) { return }\r\n                    let { nodeIndex, subNodeIndex, nestedSubNodeIndex } = getMapLayers.getLayerIndex(value.id)\r\n                    let nowTileLayer = getMapLayers.getLayer(state.layers[nodeIndex].group_layers[subNodeIndex], nestedSubNodeIndex, value.id)\r\n                    if (value.movement === 'up') {\r\n                        if (value.key + 1 == targetLayers.getArray().length) { return }\r\n                        let obj = {\r\n                            checked: false,\r\n                            nodeIndex: nodeIndex,\r\n                            subNodeIndex: subNodeIndex,\r\n                            nestedSubNodeIndex: nestedSubNodeIndex,\r\n                            id: value.id\r\n                        }\r\n                        layerControl({ action: 'layerMode', value: obj })\r\n                        targetLayers.insertAt(value.key + 1, nowTileLayer)\r\n                    }\r\n                    if (value.movement === 'down') {\r\n                        if (value.key - 1 == 0) { return }\r\n                        let obj = {\r\n                            checked: false,\r\n                            nodeIndex: nodeIndex,\r\n                            subNodeIndex: subNodeIndex,\r\n                            nestedSubNodeIndex: nestedSubNodeIndex,\r\n                            id: value.id\r\n                        }\r\n                        layerControl({ action: 'layerMode', value: obj })\r\n                        targetLayers.insertAt(value.key - 1, nowTileLayer)\r\n                    }\r\n                    break;\r\n                case 'changeLayerVisible':\r\n                    if (state.selectLock) { return }\r\n                    let visibleStatus = !(targetLayers.getArray()[value.key].getVisible())\r\n                    targetLayers.getArray()[value.key].setVisible(visibleStatus)\r\n                    break;\r\n                case 'baseMap':\r\n                    state.temp[`map${state.targetNum}BaseStatus`] = value.baseId\r\n                    let newTileLayer = new Tile({\r\n                        preload: Infinity,\r\n                        name: value.name,\r\n                        label: value.label,\r\n                        type: value.mapType,\r\n                        baseId: value.baseId,\r\n                        source: new XYZ({\r\n                            url: value.url\r\n                        }),\r\n                        crossOrigin: 'anonymous',\r\n                    })\r\n                    let layersAry = target?.getLayers().getArray()\r\n                    targetLayers.insertAt(0, newTileLayer)\r\n\r\n                    layersAry.forEach(element => {\r\n                        if (element.get('type') == 'base' && element.get('baseId') !== value.baseId) {\r\n                            target.removeLayer(element)\r\n                        }\r\n                        return true\r\n                    })\r\n                    break;\r\n                case 'changeDimensionMap':\r\n                    let ta = state.targetNum == 1 ? 'map1' : 'map2'\r\n                    state.dimensionMap[ta] = value\r\n                    if (value === '3D') {\r\n                        // 先移除82處部落，後面補回\r\n                        let layersArray = targetLayers.getArray()\r\n                        const layerToRemove = layersArray.find(element => element.get('label').includes('近年歷史災害82處部落點位'))\r\n                        if (layerToRemove) {\r\n                            state[`map${state.targetNum}`].removeLayer(layerToRemove);\r\n                        }\r\n                        ol3d = new OLCesium({\r\n                            map: target,\r\n                        })\r\n                        ol3d.setEnabled(true)\r\n                        Cesium.Ion.defaultAccessToken = import.meta.env.VITE_Ol3D_TOKEN\r\n                        let scene = ol3d.getCesiumScene({})\r\n                        scene.terrainProvider = Cesium.createWorldTerrain({})\r\n                        state[`${ta}LayerStatus`].push('3D')\r\n                    } else {\r\n                        ol3d.setEnabled(false)\r\n                        state[`${ta}LayerStatus`] = state[`${ta}LayerStatus`].filter(node => node !== '3D')\r\n                        state[`map${state.targetNum}LayerStatus`].forEach(node => {\r\n                            let { nodeIndex, subNodeIndex, nestedSubNodeIndex } = getMapLayers.getLayerIndex(node)\r\n                            let nowTileLayer = getMapLayers.getLayer(state.layers[nodeIndex].group_layers[subNodeIndex], nestedSubNodeIndex, value.id)\r\n                            if (nowTileLayer.get('label').includes('近年歷史災害82處部落點位')) {\r\n                                layerControl({\r\n                                    action: 'layerMode', value: {\r\n                                        checked: true,\r\n                                        nodeIndex: nodeIndex,\r\n                                        subNodeIndex: subNodeIndex,\r\n                                        nestedSubNodeIndex: nestedSubNodeIndex,\r\n                                        id: node\r\n                                    }\r\n                                })\r\n                            }\r\n                            return node\r\n                        })\r\n                    }\r\n                    break;\r\n                case 'setOpacity':\r\n                    targetLayers.getArray()[value.key].setOpacity(Number(value.value))\r\n                    break;\r\n            }\r\n            getCurrentMapData()\r\n        }\r\n\r\n        function changeMapCount(qty) {\r\n            if (state.mapCount === qty) { return }\r\n            let otherMap = state.targetNum !== 1 ? 'map1' : 'map2'\r\n            state.mapCount = qty\r\n            let otherLayers = state[`${otherMap}LayerStatus`].filter(node => node !== '3D')\r\n            let otherLayersData = otherLayers.map(item => mapLayerList.getLayerIndex(item))\r\n            if (qty === 2) {\r\n                state[otherMap] = new Map({\r\n                    target: otherMap,\r\n                    layers: [\r\n                        baseMapList.getBaseMapData(0),\r\n                        ...otherLayersData.map(node => getMapLayers.getLayer(state.layers[node.nodeIndex].group_layers[node.subNodeIndex], node.nestedSubNodeIndex, node.id))\r\n                    ],\r\n                    view: defaultView,\r\n                    controls: [],\r\n                })\r\n                if (state[`${otherMap}LayerStatus`]?.indexOf('3D') !== -1) {\r\n                    ol3d = new OLCesium({\r\n                        map: state[otherMap],\r\n                    })\r\n                    ol3d.setEnabled(true)\r\n                    Cesium.Ion.defaultAccessToken = import.meta.env.VITE_Ol3D_TOKEN\r\n                    let scene = ol3d.getCesiumScene({})\r\n                    scene.terrainProvider = Cesium.createWorldTerrain({})\r\n                }\r\n            }\r\n            if (qty === 1) {\r\n                state[otherMap] = null\r\n                const element = document.getElementById(otherMap)\r\n                while (element.firstChild) {\r\n                    element.removeChild(element.firstChild)\r\n                }\r\n            }\r\n        }\r\n\r\n        function changeTarget(value) {\r\n            state.targetNum = value\r\n            let delToMap = state.targetNum !== 1 ? 'map1' : 'map2'\r\n            if (state.mapCount === 1) {\r\n                // 目標地圖為空\r\n                if (!state[`map${value}`]) {\r\n                    let otherLayers = state[`map${value}LayerStatus`].filter(node => node !== '3D')\r\n\r\n                    // TODO: 優化，把node0_subNode4_nestedSubNodeundefined移到最後面\r\n                    if (otherLayers.includes('node0_subNode4_nestedSubNodeundefined')) {\r\n                        let a = otherLayers.filter(node => node !== 'node0_subNode4_nestedSubNodeundefined')\r\n                        otherLayers = [...a, 'node0_subNode4_nestedSubNodeundefined']\r\n                    }\r\n\r\n                    let otherLayersData = otherLayers.map(item => mapLayerList.getLayerIndex(item))\r\n                    state[`map${value}`] = new Map({\r\n                        target: `map${value}`,\r\n                        layers: [\r\n                            baseMapList.getBaseMapData(state.temp[`map${state.targetNum}BaseStatus`]),\r\n                            ...otherLayersData.map(node => getMapLayers.getLayer(state.layers[node.nodeIndex].group_layers[node.subNodeIndex], node.nestedSubNodeIndex, node.layeredIndex))\r\n                        ],\r\n                        view: defaultView,\r\n                        controls: [],\r\n                    })\r\n\r\n                    mapClickEvent(state[`map${value}`])\r\n                    if (state[`map${value}LayerStatus`]?.indexOf('3D') !== -1) {\r\n                        ol3d = new OLCesium({\r\n                            map: state[`map${value}`],\r\n                        })\r\n                        ol3d.setEnabled(true)\r\n                    }\r\n\r\n                }\r\n                // 非目標地圖的刪除\r\n                if (state[delToMap]) {\r\n                    state[delToMap] = null\r\n                    const element = document.getElementById(delToMap)\r\n                    while (element.firstChild) {\r\n                        element.removeChild(element.firstChild)\r\n                    }\r\n                }\r\n            }\r\n            nextTick(() => {\r\n                getCurrentMapData()\r\n            })\r\n        }\r\n\r\n        function getCurrentMapData() {\r\n            let target = state.targetNum == 1 ? state.map1 : state.map2\r\n            const layers = target?.getLayers()?.getArray()\r\n            state.currentLayers = layers?.map(layer => {\r\n                return {\r\n                    label: layer.get('label'),\r\n                    id: layer.get('id'),\r\n                    visible: layer.getVisible(),\r\n                }\r\n            })\r\n        }\r\n\r\n        function conditionWrap() {\r\n            state.conditionWrap = !state.conditionWrap\r\n        }\r\n\r\n        function onMapLayerStatus(action, target, id) {\r\n            if (action === 'add') {\r\n                state[`${target}LayerStatus`].push(id)\r\n            } else if (action === 'delete') {\r\n                let a = state[`${target}LayerStatus`].findIndex(node => node === id)\r\n                state[`${target}LayerStatus`].splice(a, 1)\r\n            } else {\r\n                console.log('error')\r\n            }\r\n        }\r\n\r\n        function mapClickEvent(target) {\r\n            let selector = new Select({\r\n                layers: target?.getLayers()?.getArray(),\r\n                condition: click,\r\n            })\r\n            target.addInteraction(selector)\r\n            selector.on('select', (event) => {\r\n                let selectedFeatures = event.selected[0]\r\n                if (selectedFeatures) {\r\n                    state.popup.overlay = new Overlay({\r\n                        element: state.popup.nodeRef,\r\n                        autoPan: true,\r\n                        autoPanAnimation: {\r\n                            duration: 250\r\n                        }\r\n                    })\r\n                    state.popup.overlay.setPosition(event.mapBrowserEvent.coordinate)\r\n                    target.addOverlay(state.popup.overlay)\r\n                    // TODO: 截圖結構修改\r\n                    // TODO: 優化結構，獲取state.popupId.overlay方式修正，考慮整包selectedFeatures放進去\r\n                    let selectIds = selectedFeatures.getId().split('.')\r\n                    state.popup.popupData = selectIds[0]\r\n                    state.popup.coordinate = event.mapBrowserEvent.coordinate\r\n                    if (selectIds[0] === '新竹縣原住民部落範圍') {\r\n                        state.popup.popupId = selectedFeatures.get('編號')\r\n                        return\r\n                    }\r\n                    if (selectIds[0] === '近年歷史災害82處部落點位') {\r\n                        state.popup.popupId = selectIds[1]\r\n                        return\r\n                    }\r\n                    if (selectIds[0] === '雨量站') {\r\n                        // FIXME:\r\n                        state.popup.popupId = selectIds[1]\r\n                        return\r\n                    }\r\n                } else {\r\n                    target.removeOverlay(state.popup.overlay)\r\n                    state.popup.overlay = null\r\n                    state.popup = {\r\n                        nodeRef: null,\r\n                        overlay: null,\r\n                        popupId: 0,\r\n                        coordinate: [],\r\n                        popupData: '',\r\n                    }\r\n                }\r\n            })\r\n        }\r\n\r\n        function closeMapData() {\r\n            let target = state.targetNum == 1 ? state.map1 : state.map2\r\n            target.removeOverlay(state.popup.overlay)\r\n            state.popup.overlay = null\r\n        }\r\n\r\n        // TODO: 優化 移除id判斷?\r\n        function addSelectElement(value) {\r\n            const { checked, id } = value\r\n            if (!checked) { state.selectLayerOption = {}; return }\r\n            if (id === 'node4_subNode0_nestedSubNodeundefined') {\r\n                $.ajax({\r\n                    url: 'https://api.edtest.site/tribeQuery',\r\n                    method: 'GET',\r\n                    success: (res) => {\r\n                        state.tribeQuery = res\r\n                    },\r\n                    error: (res) => {\r\n                        console.log(res)\r\n                    }\r\n                })\r\n            }\r\n        }\r\n\r\n        function moveToMap(val) {\r\n            let obj = {\r\n                action: 'moveTo',\r\n                value: {\r\n                    xAxis: val.WGS84.lng,\r\n                    yAxis: val.WGS84.lat\r\n                }\r\n            }\r\n            mapControl(obj)\r\n        }\r\n\r\n        onMounted(async () => {\r\n            let getBaseData = $.ajax({\r\n                url: 'https://api.edtest.site/underLayers',\r\n                method: 'GET',\r\n            }).done(res => {\r\n                return res\r\n            })\r\n\r\n            let getLayerData = $.ajax({\r\n                url: 'https://api.edtest.site/layers',\r\n                method: 'GET',\r\n            }).done(res => {\r\n                return res\r\n            })\r\n\r\n            Promise.all([getBaseData, getLayerData]).then((value) => {\r\n                // TODO: 優化\r\n                let result = value[0].data.map((node, nodeIndex) => {\r\n                    return {\r\n                        mapType: 'base',\r\n                        baseId: nodeIndex,\r\n                        onCurrent: false,\r\n                        ...node\r\n                    }\r\n                })\r\n                baseMapList.setBaseMapData(result)\r\n                state.temp.map1BaseStatus = 0\r\n                state.temp.baseMapList = getBaseMapAll()\r\n\r\n                state.layers = value[1].map((node, index) => {\r\n                    node.group_layers.forEach((sub, subIndex) => {\r\n                        let subNodeIndex = subIndex, nestedSubNodeIndex = undefined\r\n                        sub.id = `node${index}_subNode${subNodeIndex}_nestedSubNode${nestedSubNodeIndex}`\r\n\r\n                        if (!(sub.single_tiles)) {\r\n                            sub.tiles_list.forEach((nestedSub, nestedSubIndex) => {\r\n                                nestedSubNodeIndex = nestedSubIndex\r\n                                nestedSub.id = `node${index}_subNode${subNodeIndex}_nestedSubNode${nestedSubNodeIndex}`\r\n                            })\r\n                        }\r\n                    })\r\n                    return {\r\n                        ...node,\r\n                        value: index,\r\n                    }\r\n                })\r\n\r\n                nextTick(() => {\r\n                    initMap()\r\n                    getCurrentMapData()\r\n                })\r\n            })\r\n            state.comSize.wrapHeight = window.innerHeight\r\n            state.comSize.wrapWidth = window.innerWidth\r\n            window.onresize = (e) => {\r\n                state.comSize.wrapHeight = e.target.innerHeight\r\n                state.comSize.wrapWidth = e.target.innerWidth\r\n            }\r\n        })\r\n\r\n        return {\r\n            state,\r\n            props,\r\n            store,\r\n            mapControl,\r\n            layerControl,\r\n            changeTarget,\r\n            conditionWrap,\r\n            closeMapData,\r\n            moveToMap,\r\n            changeMapCount\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<template>\r\n    <div>\r\n        <!-- TODO: 寬度設定是否調整 -->\r\n        <div class=\"w-100 d-flex justify-content-between flex-sm-row flex-wrap flex-sm-nowrap mapWrap\" id=\"mapWrap\">\r\n            <div id=\"map1\"\r\n            :class=\"{\r\n                'w-100': state.map1?.getTarget() == 'map1',\r\n                'h-100': state.mapCount === 1,\r\n                'h-50': state.mapCount === 2 && (state.comSize.wrapWidth < 600),\r\n                'middleMap': state.map1?.getTarget()\r\n            }\">\r\n            </div>\r\n            <div class=\"middleLine\" v-if=\"state.mapCount === 2\"></div>\r\n            <div id=\"map2\"\r\n            :class=\"{\r\n                'w-100': state.map2?.getTarget() == 'map2',\r\n                'h-100': state.mapCount === 1,\r\n                'h-50': state.mapCount === 2 && (state.comSize.wrapWidth < 600),\r\n                'middleMap': state.map2?.getTarget()\r\n            }\">\r\n            </div>\r\n        </div>\r\n        <asideTool class=\"asideTool position-absolute top-50 translate-middle-y\" id=\"asideTool\"\r\n        @onMapControl=\"({ action, value }) => { mapControl({ action, value }) }\" />\r\n\r\n        <div class=\"SearchBar d-none d-sm-block position-absolute\">\r\n            <div class=\"d-flex align-items-center\">\r\n                <img src=\"@/assets/logo.svg\" alt=\"\" class=\"me-5\">\r\n                <mapSourceOption class=\"mapSourceOption d-none d-sm-block\"\r\n                :baseMapList=\"state.temp.baseMapList\"\r\n                :onChangeBaseMaps=\"({ action, value }) => {\r\n                    layerControl({ action, value })\r\n                }\" />\r\n            </div>\r\n            <SearchBar class=\"mt-4\"\r\n            v-bind=\"{\r\n                dimensionMapStatus: state.toSearchDimensionStatus,\r\n                currentLayers: state.currentLayers,\r\n                mapCount: state.mapCount,\r\n                onChangeBaseMaps: ({ action, value }) => {\r\n                    layerControl({ action, value })\r\n                },\r\n                onChangeMapCount: (qty) => {\r\n                    changeMapCount(qty)\r\n                }\r\n            }\"\r\n            @onLayerControl=\"({ action, value }) => { layerControl(action, value) }\"\r\n            @onChangeTarget=\"(value) => { changeTarget(value) }\" @conditionWrap=\"(value) => { conditionWrap(value) }\" />\r\n        </div>\r\n\r\n        <div class=\"conditionCom d-none d-sm-block position-absolute\">\r\n            <div class=\"mb-4\">\r\n                <button class=\"border-0 w-100 rounded-4 bg-steel text-white text-center p-2 fw-bold fs-5\"\r\n                    v-if=\"!state.conditionWrap\" @click=\"state.conditionWrap = true\">\r\n                    圖層選項\r\n                </button>\r\n                <div class=\"mb-4\"\r\n                v-if=\"state.conditionWrap\"\r\n                @onLayerControl=\"({ action, value }) => { layerControl({ action, value }) }\">\r\n                    <Condition\r\n                    v-bind=\"{\r\n                        tribeQuery: state.tribeQuery,\r\n                        mapLayers: state.mapLayers,\r\n                        currentLayers: state.currentLayers,\r\n                        onClose: () => {\r\n                            state.conditionWrap = false\r\n                        },\r\n                        showSelectLayerValue: (val) => {\r\n                            state.selectValueTemp = val\r\n                        },\r\n                        moveToMap: (val) => {\r\n                            moveToMap(val)\r\n                        }\r\n                    }\"\r\n                    @onLayerControl=\"({ action, value }) => { layerControl({ action, value }) }\"\r\n                    />\r\n                </div>\r\n                <OverLayer :text=\"'可選擇要加入的圖層'\" :styles=\"'right: 105%;top: 0;text-align: right;'\" />\r\n            </div>\r\n\r\n            <div>\r\n                <button class=\"border-0 w-100 rounded-4 bg-steel text-white text-center p-2 fw-bold fs-5\"\r\n                    v-if=\"!state.layerSelect\" @click=\"state.layerSelect = true\">\r\n                    已選擇的圖層\r\n                </button>\r\n                <div\r\n                v-if=\"state.layerSelect\">\r\n                    <LayerSelector\r\n                    v-bind=\"{\r\n                        selectLock: state.selectLock,\r\n                        currentLayers: state.currentLayers,\r\n                        onClose: () => {\r\n                            state.layerSelect = false\r\n                        },\r\n                        onLockLayer: () => {\r\n                            state.selectLock = !state.selectLock\r\n                        },\r\n                        onDeleteLayer: ({ action, value }) => {\r\n                            if (value.layerName == 'all') {\r\n                                state.deleteLightbox = true\r\n                            } else {\r\n                                layerControl({ action, value })\r\n                            }\r\n                        },\r\n                        onDeleteLayerAll: () => {\r\n                            state.deleteLightbox = true\r\n                        },\r\n                        onLayerControl: ({ action, value }) => {\r\n                            layerControl({ action, value })\r\n                        },\r\n                    }\" />\r\n                </div>\r\n                <OverLayer :text=\"'顯示已經選擇的圖層'\" :styles=\"'right: 105%;top: 0;text-align: right;'\" />\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"m-Navbar d-flex d-sm-none position-fixed bottom-0 start-0 w-100\">\r\n            <div class=\"position-absolute bottom-100 w-100\" style=\"max-height: 70vh;overflow-y: scroll;\">\r\n                <Condition class=\"w-100\"\r\n                v-if=\"state.conditionWrap\"\r\n                v-bind=\"{\r\n                    mapLayers: state.mapLayers,\r\n                    currentLayers: state.currentLayers,\r\n                    onClose: () => {\r\n                        state.conditionWrap = false\r\n                    },\r\n                    showSelectLayerValue: (val) => {\r\n                        state.selectValueTemp = val\r\n                    }\r\n                }\"\r\n                @onLayerControl=\"({ action, value }) => { layerControl({ action, value }) }\" />\r\n            </div>\r\n            <div v-if=\"state.layerSelect\">\r\n                <LayerSelector class=\"position-absolute bottom-100 w-100\"\r\n                v-bind=\"{\r\n                    selectLock: state.selectLock,\r\n                    currentLayers: state.currentLayers,\r\n                    onClose: () => {\r\n                        state.layerSelect = false\r\n                    },\r\n                    onLockLayer: () => {\r\n                        state.selectLock = !state.selectLock\r\n                    },\r\n                    onDeleteLayer: ({ action, value }) => {\r\n                        if (value.layerName == 'all') {\r\n                            state.deleteLightbox = true\r\n                        } else {\r\n                            layerControl({ action, value })\r\n                        }\r\n                    },\r\n                    onDeleteLayerAll: () => {\r\n                        state.deleteLightbox = true\r\n                    },\r\n                    onChangLayerVisible: (action) => {\r\n                        layerControl(action)\r\n                    },\r\n                    onChangeOrderLayer: ({ action, value }) => {\r\n                        layerControl({ action, value })\r\n                    },\r\n                    onLayerControl: ({ action, value }) => {\r\n                        layerControl({ action, value })\r\n                    },\r\n                }\" />\r\n            </div>\r\n            <mNavbar\r\n            v-bind=\"{\r\n                dimensionMapStatus: state.toSearchDimensionStatus,\r\n                currentLayers: state.currentLayers,\r\n                mapCount: state.mapCount,\r\n                openConditionWrap: () => {\r\n                    state.conditionWrap = !state.conditionWrap\r\n                    state.layerSelect = false\r\n                },\r\n                openLayerSelect: () => {\r\n                    state.layerSelect = !state.layerSelect\r\n                    state.conditionWrap = false\r\n                },\r\n                onLayerControl: ({ action, value }) => {\r\n                    layerControl({ action, value })\r\n                },\r\n                onChangeMapCount: (qty) => {\r\n                    changeMapCount(qty)\r\n                },\r\n                onChangeTarget:(value) => {\r\n                    changeTarget(value)\r\n                }\r\n            }\"\r\n            @conditionWrap=\"(value) => { conditionWrap(value) }\" />\r\n        </div>\r\n\r\n        <div class=\"lightWrap w-100 h-100 d-flex justify-content-center align-items-center\" v-if=\"state.deleteLightbox\">\r\n            <div class=\"p-4 rounded bg-white\" style=\"width: 250px;\">\r\n                <p class=\"text-center fw-bold\">是否要取消全部圖層</p>\r\n                <div class=\" d-flex justify-content-around\">\r\n                    <button class=\"rounded px-3 py-1 bg-steel text-white border-0\" @click=\"() => {\r\n                        layerControl({\r\n                            action: 'selectLayerMode',\r\n                            value: {\r\n                                layerName: 'all'\r\n                            }\r\n                        })\r\n                        state.deleteLightbox = false\r\n                    }\">確定</button>\r\n                    <button class=\"rounded px-3 py-1 bg-secondary bg-gradient text-white border-0\" @click=\"() => {\r\n                        state.deleteLightbox = false\r\n                    }\">取消</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div id=\"popup\" class=\"popup position-absolute bottom-0\"\r\n        :ref=\"(e) => {\r\n            state.popup.nodeRef = e\r\n        }\">\r\n            <areaData class=\"areaData\"\r\n            v-if=\"state.popup.popupId !== 0\"\r\n            :closeMapData=\"() => {\r\n                closeMapData()\r\n            }\"\r\n            :popup=\"state.popup\"\r\n            :maxHeight=\"500\" />\r\n        </div>\r\n\r\n        <div class=\"stepOverLayer position-absolute top-0 start-0 w-100 h-100 bg-black opacity-50\" id=\"firstEnter\"\r\n        v-if=\"store.state.isInit\"\r\n        @click=\"()=>{\r\n            store.dispatch('updateLayerStatus', false)\r\n        }\"></div>\r\n    </div>\r\n</template>\r\n\r\n<style lang=\"sass\">\r\n@import '@/assets/styles/all.module.scss'\r\n.mapWrap\r\n    height: 100vh\r\n.mapWrap .ol-viewport\r\n    height: 100vh\r\n    width: 100vw\r\n.asideTool\r\n    z-index: 220\r\n    left: 20px\r\n.SearchBar\r\n    top: 20px\r\n    left: 20px\r\n    z-index: 220\r\n.conditionCom\r\n    width: 480px\r\n    right: 1%\r\n    bottom: 5%\r\n.middleLine\r\n    width: 5px\r\n    background: $blue-steel\r\n.popup\r\n    z-index: 9999\r\n.areaData\r\n    width: 450px\r\n    max-height: 550px\r\n    background: #fff\r\n    box-sizing: border-box\r\n    border-radius: 10px\r\n    border: 1px solid #088\r\n.middleMap\r\n    position: relative\r\n    &::after\r\n        content: ''\r\n        position: absolute\r\n        display: block\r\n        border: 2px solid #000\r\n        width: 40px\r\n        height: 40px\r\n        top: calc((100% - 40px)/2)\r\n        left: calc((100% - 40px)/2)\r\n@media (max-width: 600px)\r\n    .m-Navbar\r\n        z-index: 222\r\n    .middleLine\r\n        height: 1px\r\n        width: 100%\r\n    .areaData\r\n        width: 90vw\r\n</style>\r\n"],"names":["Property","Overlay","BaseObject","options","CLASS_SELECTABLE","removeChildren","element","removeNode","unlistenByKey","map","listen","MapEventType","container","offset","position","panIntoViewOptions","mapRect","overlayRect","outerWidth","outerHeight","myMargin","containsExtent","offsetLeft","offsetRight","offsetTop","offsetBottom","delta","center","centerPx","newCenterPx","panOptions","size","box","offsetX","offsetY","positioning","visible","pixel","mapSize","style","x","y","posX","posY","transform","Overlay$1","Cluster","VectorSource","feature","geometry","assert","fast","extent","resolution","projection","distance","minDistance","source","EventType","ratio","changed","createEmpty","mapDistance","features","clustered","i","ii","getUid","coordinates","createOrUpdateFromCoordinate","buffer","neighbors","neighbor","uid","centroid","addCoordinate","scaleCoordinate","searchCenter","getCenter","Point","Feature","olSourceCluster","ATTRIBUTION","OSM","XYZ","attributions","crossOrigin","url","OSM$1","resolveUrl","baseUrl","doc","base","a","uuid","counter","random","toArray","arrayLike","arr","l","px","node","styleProperty","val","getNodeWidth","leftBorder","rightBorder","getNodeHeight","topBorder","bottomBorder","getImageSize","targetNode","width","height","getPixelRatio","FINAL_PROCESS","canvasDimensionLimit","checkCanvasDimensions","canvas","createImage","resolve","reject","img","svgToDataURL","svg","html","nodeToDataURL","xmlns","foreignObject","isInstanceOfElement","instance","nodePrototype","formatCSSText","content","formatCSSProperties","name","value","priority","getPseudoElementStyle","className","pseudo","selector","cssText","clonePseudoElement","nativeNode","clonedNode","styleElement","clonePseudoElements","WOFF","JPEG","mimes","getExtension","match","getMimeType","extension","getContentFromDataUrl","dataURL","isDataUrl","makeDataUrl","mimeType","fetchAsDataURL","init","process","res","blob","reader","error","cache","getCacheKey","contentType","includeQueryParams","key","resourceToDataURL","resourceUrl","cacheKey","result","msg","cloneCanvasElement","cloneVideoElement","video","ctx","poster","cloneIFrameElement","iframe","_a","cloneNode","cloneSingleNode","isSlotElement","cloneChildren","_b","children","deferred","child","clonedChild","cloneCSSStyle","targetStyle","sourceStyle","cloneInputValue","cloneSelectValue","clonedSelect","selectedOption","decorate","ensureSVGSymbols","clone","uses","processedDefs","id","exist","definition","nodes","ns","defs","isRoot","URL_REGEX","URL_WITH_FORMAT_REGEX","FONT_SRC_REGEX","toRegex","escaped","parseURLs","urls","raw","quotation","embed","resourceURL","baseURL","getContentFromUrl","resolvedURL","filterPreferredFontFormat","str","preferredFontFormat","src","format","shouldEmbed","embedResources","filteredCSSText","css","embedProp","propName","propValue","cssString","embedBackground","embedImageNode","isImageElement","image","embedChildren","deferreds","embedImages","applyStyle","manual","cssFetchCache","fetchCSS","embedFonts","data","regexUrl","loadFonts","loc","parseCSS","commentsRegex","keyframesRegex","matches","importRegex","combinedCSSRegex","unifiedRegex","getCSSRules","styleSheets","ret","sheet","item","index","importIndex","metadata","rule","e","inline","err","getWebFontRules","cssRules","parseWebFontRules","getWebFontCSS","rules","embedWebFonts","styleNode","sytleContent","toSvg","toCanvas","context","canvasWidth","canvasHeight","toPng","currentPositionImg","_sfc_main","props","emit","state","reactive","onMounted","Style","Icon","_openBlock","_createElementBlock","_hoisted_1","$setup","_imports_0$4","getTribeData","tribeId","FailMethod","getDisasterData","getRainfallStation","stationName","watch","newVal","router","_hoisted_2","_hoisted_3","_withScopeId","_createElementVNode","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_imports_0","_hoisted_11","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_18","_hoisted_21","_hoisted_23","_hoisted_24","_hoisted_26","_hoisted_27","_hoisted_29","_hoisted_30","_hoisted_32","_hoisted_33","_hoisted_35","_hoisted_36","_hoisted_38","_hoisted_39","_hoisted_41","_hoisted_42","_hoisted_44","_hoisted_45","_hoisted_47","_hoisted_48","_hoisted_49","_hoisted_51","_hoisted_52","_hoisted_53","_hoisted_54","_hoisted_55","_hoisted_56","_hoisted_57","_normalizeStyle","_cache","args","_toDisplayString","_i","_h","_g","_hoisted_12","_Fragment","_renderList","_u","_t","_hoisted_17","_hoisted_19","_hoisted_22","_hoisted_25","_hoisted_28","_hoisted_31","_hoisted_34","_hoisted_37","_hoisted_40","_v","_w","_x","_y","_z","_A","_B","_imports_0$3","_imports_1$3","_imports_2$3","_imports_3$3","_imports_4$3","_imports_5","_imports_6","toolSwitch","target","onLayerControl","action","_hoisted_5","_hoisted_4","_normalizeClass","_imports_0$2","_imports_1$2","_imports_2$2","_imports_3$2","_imports_4$2","_imports_1","_imports_2","_imports_3","_imports_4","_withModifiers","nodeIndex","_hoisted_10","store","useStore","route","overLayCom","computed","LayerCheckBoxChange","defaultChecked","event","$","selectValue","params","mapList","tribeYear","tribeTown","moveMap","subNode","subNodeIndex","_createTextVNode","_hoisted_16","subNodeIds","$event","_vModelSelect","_imports_0$1","_imports_1$1","_imports_2$1","_imports_3$1","_imports_4$1","SelectEventType","SelectEvent","Event","type","selected","deselected","mapBrowserEvent","originalFeatureStyles","Select","Interaction","singleClick","never","shiftKeyOnly","TRUE","getDefaultStyleFunction","Collection","layerFilter","layers","layer","hitTolerance","CollectionEventType","evt","VectorLayer","interactions","interaction","add","remove","toggle","set","clear","j","styles","createEditingStyle","extend","Select$1","UNITS_PROP","LEADING_DIGITS","DEFAULT_DPI","ScaleLine","Control","CLASS_UNSELECTABLE","units","dpi","viewState","pointResolutionUnits","pointResolution","getPointResolution","minWidth","maxWidth","nominalCount","suffix","metersPerDegree","METERS_PER_UNIT","count","decimalCount","previousCount","previousWidth","previousDecimalCount","decimal","scale","resolutionScale","mapScale","steps","stepWidth","scaleSteps","cls","isLast","lengthString","margin","inchesPerMeter","mapEvent","frameState","ScaleLine$1","AutoRenderLoop","ol3d","repaintKey","toDegrees","angleInRadians","toRadians","angleInDegrees","Camera","scene","input","opt_output","opt_dimension","dim","view","olObservableUnByKey","toLonLat","getTransform","fromLonLat","heading","tilt","ll","carto","pos","altitude","destination","orientation","ellipsoid","olcsCore","bestTarget","globe","bestTargetCartographic","targetNormal","targetToCamera","up","right","normal","tiltAngle","opt_dontSync","old","current","latitude","calcDistanceForResolution","calcResolutionForDistance","AbstractSynchronizer","root","fifo","olLayerWithParents","olLayer","olLayerId","cesiumObjects","olLayerGroup","newOlLayerWithParents","layerId","layerWithParents","onLayerChange","cesiumObjs","olcsListen","cesiumObject","counterparts","counterpart","group","done","listenKeyArray","contentKeys","listenAddRemove","collection","el","objKey","object","destroy","RasterSynchronizer","olcsAbstractSynchronizer","viewProj","olLayerItem","previousStyleFunction","currentStyleFunction","csObj","zIndices","queue","sublayers","stableSort","layer1","layer2","VectorLayerCounterpart","layerProjection","billboards","primitives","FeatureConverter","olSourceVector","cancellers","olcsUtil","canceller","primitive","olGeometry","color","opt_lineWidth","createInstance","instances","heightReference","ctor","dataUri","outline","fillColor","strokeColor","olColor","fillGeometry","outlineGeometry","olStyle","outlineColor","p1","p2","text","label","bbOptions","bb","point","radius","outlinePrimitive","circlePolygon","olCreateCircularPolygon","positions","isGroundPolylinePrimitiveSupported","geometryInstances","previousDistance","geometryOptions","linePositions","appearance","primitiveOptions","boundingExtent","rectangle","maxHeight","c","rings","hierarchy","polygonHierarchy","olPos","polylineGeometry","altitudeMode","imageStyle","opt_newBillboardCallback","olStyleIcon","isImageLoaded","reallyCreateBillboard","opacity","anchor","cancelled","fuid","listener","modelPrimitive","olcsModelFunction","olcsModel","model","accumulate","geometries","functor","subgeos","labels","extentCenter","olGeomSimpleGeometry","first","labelStyle","horizontalOrigin","verticalOrigin","fill","stroke","fallbackStyleFunction","featureStyleFunction","opt_geom","geom3d","olGeomGeometry","geomFuncRes","geom","proj","newBillboardAddedCallback","featureBb","prims","bbs","result2","olView","featurePrimitiveMap","olcsCoreVectorLayerCounterpart","layerStyle","prim","VectorSynchronizer","opt_converter","olcsFeatureConverter","csPrimitive","layerVisible","olLayerVector","olLayerVectorTile","olLayerLayer","csPrimitives","olListenKeys","onAddFeature","olLayerImage","onRemoveFeature","SynchronizedOverlay","olOverlay","parent","setPropertyFromEvent","observer","sourceProjection","globeHeight","cartesian","camera","ellipsoidBoundingSphere","pixelCartesian","OverlaySynchronizer","overlay","cesiumOverlay","olcsSynchronizedOverlay","overlayId","removedOverlay","csOverlay","OLCesium","fillArea","containerAttribute","targetElement","overlayEvents","canvasAttribute","sceneOptions","sscc","olcsCamera","firstImageryProvider","synchronizers","olcsRasterSynchronizer","olcsVectorSynchronizer","olcsOverlaySynchronizer","frameTime","interval","julianDate","trackedEntity","bs","enable","rootGroup","timeout","csCamera","block","olcsAutoRenderLoop","to4326Transform","toCesiumPosition","olGeomPoint","coo","coo4326","time","initMap","Map","defaultView","addPoint","targetLng","targetLat","mapControl","View","mainMap","xAxis","yAxis","layerControl","targetLayers","nestedSubNodeIndex","targetLayer","getMapLayers","iconFeature","gifUrl","extentWidth","extentHeight","frame","scaleX","scaleY","baseScale","currentResolution","mapClickEvent","layersAry","obj","visibleStatus","newTileLayer","ta","layerToRemove","getCurrentMapData","qty","otherMap","otherLayersData","mapLayerList","delToMap","otherLayers","baseMapList","onMapLayerStatus","click","selectedFeatures","selectIds","addSelectElement","getBaseMapAll","sub","subIndex","nestedSubIndex","nestedSub","moveToMap","_createVNode","_component_SearchBar","_mergeProps","_component_Condition","_createBlock","_component_LayerSelector","_component_mNavbar"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,46,47,48,49,50,51,52,53,54,55,56,57,58]}