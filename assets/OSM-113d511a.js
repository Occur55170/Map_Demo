import{b8 as j,b0 as D,a$ as A,ca as p,b4 as T,aP as v,aS as w,cb as z,I as r,ai as S,aX as f,cc as G,l as y,E as O,u as C,cd as F,av as M,ce as P,bb as R,at as Z,n as N,aA as X,aR as q,aZ as H,V as $,q as K}from"./proj4-56d3a803.js";class W extends j{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:D({extent:A(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,opaque:e.opaque,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const k=W;class U extends p{constructor(e,t,i,a,s,o,u){const c=e.getExtent(),h=t.getExtent(),g=h?T(i,h):i,d=v(g),l=w(e,t,d,a),m=F,E=new z(e,t,g,c,l*m,a),L=E.calculateSourceExtent(),_=o(L,l,s),b=_?r.IDLE:r.EMPTY,x=_?_.getPixelRatio():1;super(i,a,x,b),this.targetProj_=t,this.maxSourceExtent_=c,this.triangulation_=E,this.targetResolution_=a,this.targetExtent_=i,this.sourceImage_=_,this.sourcePixelRatio_=x,this.interpolate_=u,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==r.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const e=this.sourceImage_.getState();if(e==r.LOADED){const t=S(this.targetExtent_)/this.targetResolution_,i=f(this.targetExtent_)/this.targetResolution_;this.canvas_=G(t,i,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_)}this.state=e,this.changed()}load(){if(this.state==r.IDLE){this.state=r.LOADING,this.changed();const e=this.sourceImage_.getState();e==r.LOADED||e==r.ERROR?this.reproject_():(this.sourceListenerKey_=y(this.sourceImage_,O.CHANGE,function(t){const i=this.sourceImage_.getState();(i==r.LOADED||i==r.ERROR)&&(this.unlistenSource_(),this.reproject_())},this),this.sourceImage_.load())}}unlistenSource_(){C(this.sourceListenerKey_),this.sourceListenerKey_=null}}const Y=U,I={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class B extends X{constructor(e,t){super(e),this.image=t}}class V extends M{constructor(e){super({attributions:e.attributions,projection:e.projection,state:e.state,interpolate:e.interpolate!==void 0?e.interpolate:!0}),this.on,this.once,this.un,this.resolutions_=e.resolutions!==void 0?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0}getResolutions(){return this.resolutions_}setResolutions(e){this.resolutions_=e}findNearestResolution(e){const t=this.getResolutions();if(t){const i=P(t,e,0);e=t[i]}return e}getImage(e,t,i,a){const s=this.getProjection();if(!s||!a||R(s,a))return s&&(a=s),this.getImageInternal(e,t,i,a);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&R(this.reprojectedImage_.getProjection(),a)&&this.reprojectedImage_.getResolution()==t&&Z(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new Y(s,a,e,t,i,(o,u,c)=>this.getImageInternal(o,u,c,s),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(e,t,i,a){return N()}handleImageChange(e){const t=e.target;let i;switch(t.getState()){case r.LOADING:this.loading=!0,i=I.IMAGELOADSTART;break;case r.LOADED:this.loading=!1,i=I.IMAGELOADEND;break;case r.ERROR:this.loading=!1,i=I.IMAGELOADERROR;break;default:return}this.hasListener(i)&&this.dispatchEvent(new B(i,t))}}function J(n,e){n.getImage().src=e}const Q=V;class ee extends Q{constructor(e){const t=e.crossOrigin!==void 0?e.crossOrigin:null,i=e.imageLoadFunction!==void 0?e.imageLoadFunction:J;super({attributions:e.attributions,interpolate:e.interpolate,projection:q(e.projection)}),this.url_=e.url,this.imageExtent_=e.imageExtent,this.image_=new H(this.imageExtent_,void 0,1,this.url_,t,i),this.imageSize_=e.imageSize?e.imageSize:null,this.image_.addEventListener(O.CHANGE,this.handleImageChange.bind(this))}getImageExtent(){return this.imageExtent_}getImageInternal(e,t,i,a){return $(e,this.image_.getExtent())?this.image_:null}getUrl(){return this.url_}handleImageChange(e){if(this.image_.getState()==r.LOADED){const t=this.image_.getExtent(),i=this.image_.getImage();let a,s;this.imageSize_?(a=this.imageSize_[0],s=this.imageSize_[1]):(a=i.width,s=i.height);const o=S(t),u=f(t),c=o/a,h=u/s;let g=a,d=s;if(c>h?g=Math.round(o/h):d=Math.round(u/c),g!==a||d!==s){const l=K(g,d);this.getInterpolate()||(l.imageSmoothingEnabled=!1);const m=l.canvas;l.drawImage(i,0,0,a,s,0,0,m.width,m.height),this.image_.setImage(m)}}super.handleImageChange(e)}}const se=ee,te='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class ie extends k{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[te];const i=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",a=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:i,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,opaque:e.opaque!==void 0?e.opaque:!0,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,transition:e.transition,url:a,wrapX:e.wrapX,zDirection:e.zDirection})}}const re=ie;export{Q as I,re as O,se as S,k as X,J as d};
//# sourceMappingURL=OSM-113d511a.js.map
