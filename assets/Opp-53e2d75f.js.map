{"version":3,"file":"Opp-53e2d75f.js","sources":["../../src/view/Opp.vue"],"sourcesContent":["<script>\r\nimport { useSlots, onBeforeMount, onMounted, onBeforeUnmount, ref, reactive, computed, watch, nextTick, defineAsyncComponent, useCssModule, inject, getCurrentInstance } from 'vue'\r\nimport $ from 'jquery'\r\nimport { Map, View } from 'ol' // 引入容器绑定模块和视图模块\r\nimport XYZ from 'ol/source/XYZ' // 引入XYZ地图格式\r\nimport Overlay from 'ol/Overlay'// 引入覆盖物模块\r\nimport 'ol/ol.css' // ol提供的css样式（必须引入）\r\nimport { ImageArcGISRest, OSM } from 'ol/source.js'\r\nimport VectorSource from 'ol/source/Vector.js'\r\nimport { Fill, Stroke, Style, Icon } from 'ol/style.js'\r\nimport { Tile, Tile as TileLayer, Image as ImageLayer, Vector, Vector as VectorLayer } from 'ol/layer.js'\r\nimport TileWMS from 'ol/source/TileWMS'\r\nimport proj4 from 'proj4';\r\n\r\nimport { register } from 'ol/proj/proj4.js'\r\nimport { transform } from 'ol/proj.js'\r\nimport Static from 'ol/source/ImageStatic.js'\r\nimport ImageWMS from 'ol/source/ImageWMS.js'\r\nimport {getCenter} from 'ol/extent.js'\r\n\r\nproj4.defs('EPSG:27700', '+proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy +towgs84=446.448,-125.157,542.06,0.15,0.247,0.842,-20.489 +units=m +no_defs')\r\nproj4.defs(\"EPSG:3826\", \"+proj=tmerc +lat_0=0 +lon_0=121 +k=0.9999 +x_0=250000 +y_0=0 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs +type=crs\")\r\n// window.Proj4js = {\r\n//     Proj: function(code) {\r\n//       return proj4(Proj4js.defs[code]);\r\n//     },\r\n//     defs: proj4.defs,\r\n//     transform: proj4\r\n//   };\r\n\r\n\r\nregister(proj4);\r\n\r\nexport default {\r\n    props: {},\r\n    setup(props, { emit }) {\r\n        const mapCom = ref(null)\r\n        const state = reactive({})\r\n        const imageExtent = [-90, -45, 90, 45]\r\n        const addImageExtent = [0, 0, 700000, 1300000]\r\n        const a = [105.03935412100009,31.039717361000044,111.73204131800009,40.43520212000004]\r\n\r\n\r\n        // 初始化地图\r\n        function initMap() {\r\n            mapCom.value = new Map({\r\n                target: mapCom.value,\r\n                layers: [\r\n                    new TileLayer({\r\n                        preload: Infinity,\r\n                        source: new OSM(),\r\n                    }),\r\n                ],\r\n                view: new View({\r\n                    projection: 'EPSG:4326',\r\n                    center: [121.326776, 24.655499],\r\n                    zoom: 10,\r\n                }),\r\n            })\r\n            // const source = new OSM();\r\n\r\n            // const layer = new TileLayer();\r\n\r\n            // const map = new Map({\r\n            // layers: [layer],\r\n            // target: 'map',\r\n            // view: new View({\r\n            //     center: [0, 0],\r\n            //     zoom: 2,\r\n            // }),\r\n            // });\r\n\r\n            // document.getElementById('set-source').onclick = function () {\r\n            // layer.setSource(source);\r\n            // };\r\n\r\n            // document.getElementById('unset-source').onclick = function () {\r\n            // layer.setSource(null);\r\n            // };\r\n        }\r\n\r\n        function add() {\r\n            const imageLayer = new ImageLayer({\r\n                source: new Static({\r\n                    url: 'https://api.edtest.site/maxdbz/202311190510-202311190520_Maxdbz_map.png',\r\n                    projection: 'EPSG:4326',\r\n                    // [119.18, 21.45, 124.34, 26.56]\r\n                    // imageExtent: [95.03935412100009,21.039717361000044,101.73204131800009,30.43520212000004],\r\n                    imageExtent:  [119.18, 21.45, 124.34, 26.56],\r\n                    interpolate: true,\r\n                })\r\n            })\r\n            mapCom.value.addLayer(imageLayer)\r\n\r\n        }\r\n        function bdd() {\r\n            const imageLayer = new ImageLayer({\r\n                preload: Infinity,\r\n                source: new Static({\r\n                    url: 'https://upload.wikimedia.org/wikipedia/commons/thumb/1/18/British_National_Grid.svg/2000px-British_National_Grid.svg.png',\r\n                    projection: 'EPSG:27700',\r\n                    imageExtent: addImageExtent,\r\n                    interpolate: true,\r\n                })\r\n            })\r\n            mapCom.value.addLayer(imageLayer)\r\n\r\n        }\r\n        function show() {\r\n            console.log(mapCom.value.getLayers().getArray())\r\n        }\r\n        // 获取图层的数据源\r\n        onMounted(() => {\r\n            // 在元素加载完之后再执行地图初始化\r\n            initMap()\r\n        })\r\n\r\n        return {\r\n            state,\r\n            props,\r\n            mapCom,\r\n            show,\r\n            add,\r\n            bdd,\r\n        }\r\n    }\r\n\r\n}\r\n</script>\r\n<template>\r\n    <button @click=\"show()\">show</button>\r\n    <button @click=\"add()\">add</button>\r\n    <button @click=\"bdd()\">bdd</button>\r\n    <!-- 地图容器 -->\r\n    <div id=\"map\" class=\"mapCom\" ref=\"mapCom\"></div>\r\n</template>\r\n<style>\r\n.mapCom {\r\n    width: 100%;\r\n    height: 800px;\r\n}\r\n</style>\r\n"],"names":["proj4","register","_sfc_main","props","emit","mapCom","ref","addImageExtent","initMap","Map","OSM","imageLayer","ImageLayer","Static","show","onMounted","add","bdd","_cache","$event","$setup","_createElementVNode","_hoisted_1"],"mappings":"6MAoBAA,EAAA,KAAA,aAAA,kKAAA,EACAA,EAAA,KAAA,YAAA,8HAAA,EAUAC,EAAAD,CAAA,EAEA,MAAAE,EAAA,CACI,MAAA,CAAA,EACA,MAAAC,EAAA,CAAA,KAAAC,GAAA,CACI,MAAAC,EAAAC,EAAA,IAAA,UAGAC,EAAA,CAAA,EAAA,EAAA,IAAA,IAAA,EAKA,SAAAC,GAAA,CACIH,EAAA,MAAA,IAAAI,EAAA,CACI,OAAAJ,EAAA,MACA,OAAA,QAEQ,QAAA,IACA,OAAA,IAAAK,CACJ,CAAA,oEAKA,KAAA,EACJ,CAAA,GAsBR,cAGI,MAAAC,EAAA,IAAAC,EAAA,CACI,OAAA,IAAAC,EAAA,CACI,IAAA,iGAIA,YAAA,CAAA,OAAA,MAAA,OAAA,KAAA,EACA,YAAA,OAGRR,EAAA,MAAA,SAAAM,CAAA,CAEJ,cAEI,MAAAA,EAAA,IAAAC,EAAA,CACI,QAAA,IACA,OAAA,IAAAC,EAAA,CACI,IAAA,iKAGA,YAAA,OAGRR,EAAA,MAAA,SAAAM,CAAA,CAEJ,CACA,SAAAG,GAAA,4CAEA,CAEA,OAAAC,EAAA,IAAA,CAEIP,EAAA,IAGJ,iBAGI,OAAAH,SAEA,IAAAW,EACA,IAAAC,CACJ,CACJ,CAEJ,KAOS,GAAA,MAAS,MAAA,SAAe,IAAA,mEAJpB,QAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAC,EAAA,KAAA,wBACA,QAAAF,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAC,EAAA,IAAA,uBACA,QAAAF,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAC,EAAA,IAAA,WAETC,EAAA,MAAAC,EAAA,KAAA,GAAA"}