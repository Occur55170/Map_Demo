{"version":3,"file":"WebMap-6e5646a4.js","sources":["../../node_modules/ol/source/Cluster.js","../../node_modules/ol/source/TileArcGISRest.js","../../node_modules/ol/format/JSONFeature.js","../../node_modules/ol/format/EsriJSON.js","../../src/config/mapLayerList.js","../../src/assets/example-AddressData.jpg","../../src/assets/img/icon/vector.svg","../../src/components/areaData.vue","../../src/components/layerSelect.vue","../../src/components/condition.vue","../../src/assets/img/icon/zoomIn.svg","../../src/assets/img/icon/zoomOut.svg","../../src/assets/img/icon/compass.svg","../../src/assets/img/icon/location.svg","../../src/assets/img/icon/zoom.svg","../../src/components/AsideTool.vue","../../src/components/mapSourceOption.vue","../../src/assets/img/icon/twoDimensional.svg","../../src/assets/img/icon/threeDimensional.svg","../../src/assets/img/icon/baseLayer.svg","../../src/assets/img/icon/singleWindow.svg","../../src/assets/img/icon/doubleWindows.svg","../../src/components/SearchBar.vue","../../node_modules/olcs/AutoRenderLoop.js","../../node_modules/olcs/math.js","../../node_modules/olcs/Camera.js","../../node_modules/olcs/AbstractSynchronizer.js","../../node_modules/olcs/RasterSynchronizer.js","../../node_modules/olcs/core/VectorLayerCounterpart.js","../../node_modules/olcs/FeatureConverter.js","../../node_modules/olcs/VectorSynchronizer.js","../../node_modules/olcs/SynchronizedOverlay.js","../../node_modules/olcs/OverlaySynchronizer.js","../../node_modules/olcs/OLCesium.js","../../src/assets/logo.svg","../../src/view/WebMap.vue"],"sourcesContent":["/**\n * @module ol/source/Cluster\n */\n\nimport EventType from '../events/EventType.js';\nimport Feature from '../Feature.js';\nimport Point from '../geom/Point.js';\nimport VectorSource from './Vector.js';\nimport {add as addCoordinate, scale as scaleCoordinate} from '../coordinate.js';\nimport {assert} from '../asserts.js';\nimport {\n  buffer,\n  createEmpty,\n  createOrUpdateFromCoordinate,\n  getCenter,\n} from '../extent.js';\nimport {getUid} from '../util.js';\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions] Attributions.\n * @property {number} [distance=20] Distance in pixels within which features will\n * be clustered together.\n * @property {number} [minDistance=0] Minimum distance in pixels between clusters.\n * Will be capped at the configured distance.\n * By default no minimum distance is guaranteed. This config can be used to avoid\n * overlapping icons. As a tradoff, the cluster feature's position will no longer be\n * the center of all its features.\n * @property {function(Feature):Point} [geometryFunction]\n * Function that takes an {@link module:ol/Feature~Feature} as argument and returns an\n * {@link module:ol/geom/Point~Point} as cluster calculation point for the feature. When a\n * feature should not be considered for clustering, the function should return\n * `null`. The default, which works when the underlying source contains point\n * features only, is\n * ```js\n * function(feature) {\n *   return feature.getGeometry();\n * }\n * ```\n * See {@link module:ol/geom/Polygon~Polygon#getInteriorPoint} for a way to get a cluster\n * calculation point for polygons.\n * @property {function(Point, Array<Feature>):Feature} [createCluster]\n * Function that takes the cluster's center {@link module:ol/geom/Point~Point} and an array\n * of {@link module:ol/Feature~Feature} included in this cluster. Must return a\n * {@link module:ol/Feature~Feature} that will be used to render. Default implementation is:\n * ```js\n * function(point, features) {\n *   return new Feature({\n *     geometry: point,\n *     features: features\n *   });\n * }\n * ```\n * @property {VectorSource} [source=null] Source.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n */\n\n/**\n * @classdesc\n * Layer source to cluster vector data. Works out of the box with point\n * geometries. For other geometry types, or if not all geometries should be\n * considered for clustering, a custom `geometryFunction` can be defined.\n *\n * If the instance is disposed without also disposing the underlying\n * source `setSource(null)` has to be called to remove the listener reference\n * from the wrapped source.\n * @api\n */\nclass Cluster extends VectorSource {\n  /**\n   * @param {Options} options Cluster options.\n   */\n  constructor(options) {\n    super({\n      attributions: options.attributions,\n      wrapX: options.wrapX,\n    });\n\n    /**\n     * @type {number|undefined}\n     * @protected\n     */\n    this.resolution = undefined;\n\n    /**\n     * @type {number}\n     * @protected\n     */\n    this.distance = options.distance !== undefined ? options.distance : 20;\n\n    /**\n     * @type {number}\n     * @protected\n     */\n    this.minDistance = options.minDistance || 0;\n\n    /**\n     * @type {number}\n     * @protected\n     */\n    this.interpolationRatio = 0;\n\n    /**\n     * @type {Array<Feature>}\n     * @protected\n     */\n    this.features = [];\n\n    /**\n     * @param {Feature} feature Feature.\n     * @return {Point} Cluster calculation point.\n     * @protected\n     */\n    this.geometryFunction =\n      options.geometryFunction ||\n      function (feature) {\n        const geometry = /** @type {Point} */ (feature.getGeometry());\n        assert(geometry.getType() == 'Point', 10); // The default `geometryFunction` can only handle `Point` geometries\n        return geometry;\n      };\n\n    /**\n     * @type {function(Point, Array<Feature>):Feature}\n     * @private\n     */\n    this.createCustomCluster_ = options.createCluster;\n\n    /**\n     * @type {VectorSource|null}\n     * @protected\n     */\n    this.source = null;\n\n    /**\n     * @private\n     */\n    this.boundRefresh_ = this.refresh.bind(this);\n\n    this.updateDistance(this.distance, this.minDistance);\n    this.setSource(options.source || null);\n  }\n\n  /**\n   * Remove all features from the source.\n   * @param {boolean} [fast] Skip dispatching of {@link module:ol/source/VectorEventType~VectorEventType#removefeature} events.\n   * @api\n   */\n  clear(fast) {\n    this.features.length = 0;\n    super.clear(fast);\n  }\n\n  /**\n   * Get the distance in pixels between clusters.\n   * @return {number} Distance.\n   * @api\n   */\n  getDistance() {\n    return this.distance;\n  }\n\n  /**\n   * Get a reference to the wrapped source.\n   * @return {VectorSource|null} Source.\n   * @api\n   */\n  getSource() {\n    return this.source;\n  }\n\n  /**\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {number} resolution Resolution.\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   */\n  loadFeatures(extent, resolution, projection) {\n    this.source.loadFeatures(extent, resolution, projection);\n    if (resolution !== this.resolution) {\n      this.resolution = resolution;\n      this.refresh();\n    }\n  }\n\n  /**\n   * Set the distance within which features will be clusterd together.\n   * @param {number} distance The distance in pixels.\n   * @api\n   */\n  setDistance(distance) {\n    this.updateDistance(distance, this.minDistance);\n  }\n\n  /**\n   * Set the minimum distance between clusters. Will be capped at the\n   * configured distance.\n   * @param {number} minDistance The minimum distance in pixels.\n   * @api\n   */\n  setMinDistance(minDistance) {\n    this.updateDistance(this.distance, minDistance);\n  }\n\n  /**\n   * The configured minimum distance between clusters.\n   * @return {number} The minimum distance in pixels.\n   * @api\n   */\n  getMinDistance() {\n    return this.minDistance;\n  }\n\n  /**\n   * Replace the wrapped source.\n   * @param {VectorSource|null} source The new source for this instance.\n   * @api\n   */\n  setSource(source) {\n    if (this.source) {\n      this.source.removeEventListener(EventType.CHANGE, this.boundRefresh_);\n    }\n    this.source = source;\n    if (source) {\n      source.addEventListener(EventType.CHANGE, this.boundRefresh_);\n    }\n    this.refresh();\n  }\n\n  /**\n   * Handle the source changing.\n   */\n  refresh() {\n    this.clear();\n    this.cluster();\n    this.addFeatures(this.features);\n  }\n\n  /**\n   * Update the distances and refresh the source if necessary.\n   * @param {number} distance The new distance.\n   * @param {number} minDistance The new minimum distance.\n   */\n  updateDistance(distance, minDistance) {\n    const ratio =\n      distance === 0 ? 0 : Math.min(minDistance, distance) / distance;\n    const changed =\n      distance !== this.distance || this.interpolationRatio !== ratio;\n    this.distance = distance;\n    this.minDistance = minDistance;\n    this.interpolationRatio = ratio;\n    if (changed) {\n      this.refresh();\n    }\n  }\n\n  /**\n   * @protected\n   */\n  cluster() {\n    if (this.resolution === undefined || !this.source) {\n      return;\n    }\n    const extent = createEmpty();\n    const mapDistance = this.distance * this.resolution;\n    const features = this.source.getFeatures();\n\n    /** @type {Object<string, true>} */\n    const clustered = {};\n\n    for (let i = 0, ii = features.length; i < ii; i++) {\n      const feature = features[i];\n      if (!(getUid(feature) in clustered)) {\n        const geometry = this.geometryFunction(feature);\n        if (geometry) {\n          const coordinates = geometry.getCoordinates();\n          createOrUpdateFromCoordinate(coordinates, extent);\n          buffer(extent, mapDistance, extent);\n\n          const neighbors = this.source\n            .getFeaturesInExtent(extent)\n            .filter(function (neighbor) {\n              const uid = getUid(neighbor);\n              if (uid in clustered) {\n                return false;\n              }\n              clustered[uid] = true;\n              return true;\n            });\n          this.features.push(this.createCluster(neighbors, extent));\n        }\n      }\n    }\n  }\n\n  /**\n   * @param {Array<Feature>} features Features\n   * @param {import(\"../extent.js\").Extent} extent The searched extent for these features.\n   * @return {Feature} The cluster feature.\n   * @protected\n   */\n  createCluster(features, extent) {\n    const centroid = [0, 0];\n    for (let i = features.length - 1; i >= 0; --i) {\n      const geometry = this.geometryFunction(features[i]);\n      if (geometry) {\n        addCoordinate(centroid, geometry.getCoordinates());\n      } else {\n        features.splice(i, 1);\n      }\n    }\n    scaleCoordinate(centroid, 1 / features.length);\n    const searchCenter = getCenter(extent);\n    const ratio = this.interpolationRatio;\n    const geometry = new Point([\n      centroid[0] * (1 - ratio) + searchCenter[0] * ratio,\n      centroid[1] * (1 - ratio) + searchCenter[1] * ratio,\n    ]);\n    if (this.createCustomCluster_) {\n      return this.createCustomCluster_(geometry, features);\n    }\n    return new Feature({\n      geometry,\n      features,\n    });\n  }\n}\n\nexport default Cluster;\n","/**\n * @module ol/source/TileArcGISRest\n */\n\nimport TileImage from './TileImage.js';\nimport {appendParams} from '../uri.js';\nimport {createEmpty} from '../extent.js';\nimport {modulo} from '../math.js';\nimport {scale as scaleSize, toSize} from '../size.js';\nimport {hash as tileCoordHash} from '../tilecoord.js';\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions] Attributions.\n * @property {number} [cacheSize] Initial tile cache size. Will auto-grow to hold at least the number of tiles in the viewport.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you want to access pixel data with the Canvas renderer.\n * See https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image for more detail.\n * @property {boolean} [interpolate=true] Use interpolated values when resampling.  By default,\n * linear interpolation is used when resampling.  Set to false to use the nearest neighbor instead.\n * @property {Object<string,*>} [params] ArcGIS Rest parameters. This field is optional. Service defaults will be\n * used for any fields not specified. `FORMAT` is `PNG32` by default. `F` is `IMAGE` by\n * default. `TRANSPARENT` is `true` by default.  `BBOX`, `SIZE`, `BBOXSR`,\n * and `IMAGESR` will be set dynamically. Set `LAYERS` to\n * override the default service layer visibility. See\n * https://developers.arcgis.com/rest/services-reference/export-map.htm\n * for further reference.\n * @property {boolean} [hidpi=true] Use the `ol/Map#pixelRatio` value when requesting\n * the image from the remote server.\n * @property {import(\"../tilegrid/TileGrid.js\").default} [tileGrid] Tile grid. Base this on the resolutions,\n * tilesize and extent supported by the server.\n * If this is not defined, a default grid will be used: if there is a projection\n * extent, the grid will be based on that; if not, a grid based on a global\n * extent with origin at 0,0 will be used.\n * @property {import(\"../proj.js\").ProjectionLike} [projection] Projection. Default is the view projection.\n * The projection code must contain a numeric end portion separated by :\n * or the entire code must form a valid ArcGIS SpatialReference definition.\n * @property {number} [reprojectionErrorThreshold=0.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {import(\"../Tile.js\").LoadFunction} [tileLoadFunction] Optional function to load a tile given a URL.\n * The default is\n * ```js\n * function(imageTile, src) {\n *   imageTile.getImage().src = src;\n * };\n * ```\n * @property {string} [url] ArcGIS Rest service URL for a Map Service or Image Service. The\n * url should include /MapServer or /ImageServer.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n * @property {number} [transition] Duration of the opacity transition for rendering.  To disable the opacity\n * transition, pass `transition: 0`.\n * @property {Array<string>} [urls] ArcGIS Rest service urls. Use this instead of `url` when the ArcGIS\n * Service supports multiple urls for export requests.\n * @property {number|import(\"../array.js\").NearestDirectionFunction} [zDirection=0]\n * Choose whether to use tiles with a higher or lower zoom level when between integer\n * zoom levels. See {@link module:ol/tilegrid/TileGrid~TileGrid#getZForResolution}.\n */\n\n/**\n * @classdesc\n * Layer source for tile data from ArcGIS Rest services. Map and Image\n * Services are supported.\n *\n * For cached ArcGIS services, better performance is available using the\n * {@link module:ol/source/XYZ~XYZ} data source.\n * @api\n */\nclass TileArcGISRest extends TileImage {\n  /**\n   * @param {Options} [options] Tile ArcGIS Rest options.\n   */\n  constructor(options) {\n    options = options ? options : {};\n\n    super({\n      attributions: options.attributions,\n      cacheSize: options.cacheSize,\n      crossOrigin: options.crossOrigin,\n      interpolate: options.interpolate,\n      projection: options.projection,\n      reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n      tileGrid: options.tileGrid,\n      tileLoadFunction: options.tileLoadFunction,\n      url: options.url,\n      urls: options.urls,\n      wrapX: options.wrapX !== undefined ? options.wrapX : true,\n      transition: options.transition,\n      zDirection: options.zDirection,\n    });\n\n    /**\n     * @private\n     * @type {!Object}\n     */\n    this.params_ = options.params || {};\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.hidpi_ = options.hidpi !== undefined ? options.hidpi : true;\n\n    /**\n     * @private\n     * @type {import(\"../extent.js\").Extent}\n     */\n    this.tmpExtent_ = createEmpty();\n\n    this.setKey(this.getKeyForParams_());\n  }\n\n  /**\n   * @private\n   * @return {string} The key for the current params.\n   */\n  getKeyForParams_() {\n    let i = 0;\n    const res = [];\n    for (const key in this.params_) {\n      res[i++] = key + '-' + this.params_[key];\n    }\n    return res.join('/');\n  }\n\n  /**\n   * Get the user-provided params, i.e. those passed to the constructor through\n   * the \"params\" option, and possibly updated using the updateParams method.\n   * @return {Object} Params.\n   * @api\n   */\n  getParams() {\n    return this.params_;\n  }\n\n  /**\n   * @param {import(\"../tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n   * @param {import(\"../size.js\").Size} tileSize Tile size.\n   * @param {import(\"../extent.js\").Extent} tileExtent Tile extent.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @param {Object} params Params.\n   * @return {string|undefined} Request URL.\n   * @private\n   */\n  getRequestUrl_(\n    tileCoord,\n    tileSize,\n    tileExtent,\n    pixelRatio,\n    projection,\n    params\n  ) {\n    const urls = this.urls;\n    if (!urls) {\n      return undefined;\n    }\n\n    // ArcGIS Server only wants the numeric portion of the projection ID.\n    // (if there is no numeric portion the entire projection code must\n    // form a valid ArcGIS SpatialReference definition).\n    const srid = projection\n      .getCode()\n      .split(/:(?=\\d+$)/)\n      .pop();\n\n    params['SIZE'] = tileSize[0] + ',' + tileSize[1];\n    params['BBOX'] = tileExtent.join(',');\n    params['BBOXSR'] = srid;\n    params['IMAGESR'] = srid;\n    params['DPI'] = Math.round(\n      params['DPI'] ? params['DPI'] * pixelRatio : 90 * pixelRatio\n    );\n\n    let url;\n    if (urls.length == 1) {\n      url = urls[0];\n    } else {\n      const index = modulo(tileCoordHash(tileCoord), urls.length);\n      url = urls[index];\n    }\n\n    const modifiedUrl = url\n      .replace(/MapServer\\/?$/, 'MapServer/export')\n      .replace(/ImageServer\\/?$/, 'ImageServer/exportImage');\n    return appendParams(modifiedUrl, params);\n  }\n\n  /**\n   * Get the tile pixel ratio for this source.\n   * @param {number} pixelRatio Pixel ratio.\n   * @return {number} Tile pixel ratio.\n   */\n  getTilePixelRatio(pixelRatio) {\n    return this.hidpi_ ? pixelRatio : 1;\n  }\n\n  /**\n   * Update the user-provided params.\n   * @param {Object} params Params.\n   * @api\n   */\n  updateParams(params) {\n    Object.assign(this.params_, params);\n    this.setKey(this.getKeyForParams_());\n  }\n\n  /**\n   * @param {import(\"../tilecoord.js\").TileCoord} tileCoord The tile coordinate\n   * @param {number} pixelRatio The pixel ratio\n   * @param {import(\"../proj/Projection.js\").default} projection The projection\n   * @return {string|undefined} The tile URL\n   * @override\n   */\n  tileUrlFunction(tileCoord, pixelRatio, projection) {\n    let tileGrid = this.getTileGrid();\n    if (!tileGrid) {\n      tileGrid = this.getTileGridForProjection(projection);\n    }\n\n    if (tileGrid.getResolutions().length <= tileCoord[0]) {\n      return undefined;\n    }\n\n    if (pixelRatio != 1 && !this.hidpi_) {\n      pixelRatio = 1;\n    }\n\n    const tileExtent = tileGrid.getTileCoordExtent(tileCoord, this.tmpExtent_);\n    let tileSize = toSize(tileGrid.getTileSize(tileCoord[0]), this.tmpSize);\n\n    if (pixelRatio != 1) {\n      tileSize = scaleSize(tileSize, pixelRatio, this.tmpSize);\n    }\n\n    // Apply default params and override with user specified values.\n    const baseParams = {\n      'F': 'image',\n      'FORMAT': 'PNG32',\n      'TRANSPARENT': true,\n    };\n    Object.assign(baseParams, this.params_);\n\n    return this.getRequestUrl_(\n      tileCoord,\n      tileSize,\n      tileExtent,\n      pixelRatio,\n      projection,\n      baseParams\n    );\n  }\n}\n\nexport default TileArcGISRest;\n","/**\n * @module ol/format/JSONFeature\n */\nimport FeatureFormat from './Feature.js';\nimport {abstract} from '../util.js';\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for JSON feature formats.\n *\n * @abstract\n */\nclass JSONFeature extends FeatureFormat {\n  constructor() {\n    super();\n  }\n\n  /**\n   * @return {import(\"./Feature.js\").Type} Format.\n   */\n  getType() {\n    return 'json';\n  }\n\n  /**\n   * Read a feature.  Only works for a single feature. Use `readFeatures` to\n   * read a feature collection.\n   *\n   * @param {ArrayBuffer|Document|Element|Object|string} source Source.\n   * @param {import(\"./Feature.js\").ReadOptions} [options] Read options.\n   * @return {import(\"../Feature.js\").default} Feature.\n   * @api\n   */\n  readFeature(source, options) {\n    return this.readFeatureFromObject(\n      getObject(source),\n      this.getReadOptions(source, options)\n    );\n  }\n\n  /**\n   * Read all features.  Works with both a single feature and a feature\n   * collection.\n   *\n   * @param {ArrayBuffer|Document|Element|Object|string} source Source.\n   * @param {import(\"./Feature.js\").ReadOptions} [options] Read options.\n   * @return {Array<import(\"../Feature.js\").default>} Features.\n   * @api\n   */\n  readFeatures(source, options) {\n    return this.readFeaturesFromObject(\n      getObject(source),\n      this.getReadOptions(source, options)\n    );\n  }\n\n  /**\n   * @abstract\n   * @param {Object} object Object.\n   * @param {import(\"./Feature.js\").ReadOptions} [options] Read options.\n   * @protected\n   * @return {import(\"../Feature.js\").default} Feature.\n   */\n  readFeatureFromObject(object, options) {\n    return abstract();\n  }\n\n  /**\n   * @abstract\n   * @param {Object} object Object.\n   * @param {import(\"./Feature.js\").ReadOptions} [options] Read options.\n   * @protected\n   * @return {Array<import(\"../Feature.js\").default>} Features.\n   */\n  readFeaturesFromObject(object, options) {\n    return abstract();\n  }\n\n  /**\n   * Read a geometry.\n   *\n   * @param {ArrayBuffer|Document|Element|Object|string} source Source.\n   * @param {import(\"./Feature.js\").ReadOptions} [options] Read options.\n   * @return {import(\"../geom/Geometry.js\").default} Geometry.\n   * @api\n   */\n  readGeometry(source, options) {\n    return this.readGeometryFromObject(\n      getObject(source),\n      this.getReadOptions(source, options)\n    );\n  }\n\n  /**\n   * @abstract\n   * @param {Object} object Object.\n   * @param {import(\"./Feature.js\").ReadOptions} [options] Read options.\n   * @protected\n   * @return {import(\"../geom/Geometry.js\").default} Geometry.\n   */\n  readGeometryFromObject(object, options) {\n    return abstract();\n  }\n\n  /**\n   * Read the projection.\n   *\n   * @param {ArrayBuffer|Document|Element|Object|string} source Source.\n   * @return {import(\"../proj/Projection.js\").default} Projection.\n   * @api\n   */\n  readProjection(source) {\n    return this.readProjectionFromObject(getObject(source));\n  }\n\n  /**\n   * @abstract\n   * @param {Object} object Object.\n   * @protected\n   * @return {import(\"../proj/Projection.js\").default} Projection.\n   */\n  readProjectionFromObject(object) {\n    return abstract();\n  }\n\n  /**\n   * Encode a feature as string.\n   *\n   * @param {import(\"../Feature.js\").default} feature Feature.\n   * @param {import(\"./Feature.js\").WriteOptions} [options] Write options.\n   * @return {string} Encoded feature.\n   * @api\n   */\n  writeFeature(feature, options) {\n    return JSON.stringify(this.writeFeatureObject(feature, options));\n  }\n\n  /**\n   * @abstract\n   * @param {import(\"../Feature.js\").default} feature Feature.\n   * @param {import(\"./Feature.js\").WriteOptions} [options] Write options.\n   * @return {Object} Object.\n   */\n  writeFeatureObject(feature, options) {\n    return abstract();\n  }\n\n  /**\n   * Encode an array of features as string.\n   *\n   * @param {Array<import(\"../Feature.js\").default>} features Features.\n   * @param {import(\"./Feature.js\").WriteOptions} [options] Write options.\n   * @return {string} Encoded features.\n   * @api\n   */\n  writeFeatures(features, options) {\n    return JSON.stringify(this.writeFeaturesObject(features, options));\n  }\n\n  /**\n   * @abstract\n   * @param {Array<import(\"../Feature.js\").default>} features Features.\n   * @param {import(\"./Feature.js\").WriteOptions} [options] Write options.\n   * @return {Object} Object.\n   */\n  writeFeaturesObject(features, options) {\n    return abstract();\n  }\n\n  /**\n   * Encode a geometry as string.\n   *\n   * @param {import(\"../geom/Geometry.js\").default} geometry Geometry.\n   * @param {import(\"./Feature.js\").WriteOptions} [options] Write options.\n   * @return {string} Encoded geometry.\n   * @api\n   */\n  writeGeometry(geometry, options) {\n    return JSON.stringify(this.writeGeometryObject(geometry, options));\n  }\n\n  /**\n   * @abstract\n   * @param {import(\"../geom/Geometry.js\").default} geometry Geometry.\n   * @param {import(\"./Feature.js\").WriteOptions} [options] Write options.\n   * @return {Object} Object.\n   */\n  writeGeometryObject(geometry, options) {\n    return abstract();\n  }\n}\n\n/**\n * @param {Document|Element|Object|string} source Source.\n * @return {Object} Object.\n */\nfunction getObject(source) {\n  if (typeof source === 'string') {\n    const object = JSON.parse(source);\n    return object ? /** @type {Object} */ (object) : null;\n  } else if (source !== null) {\n    return source;\n  }\n  return null;\n}\n\nexport default JSONFeature;\n","/**\n * @module ol/format/EsriJSON\n */\nimport Feature from '../Feature.js';\nimport JSONFeature from './JSONFeature.js';\nimport LineString from '../geom/LineString.js';\nimport LinearRing from '../geom/LinearRing.js';\nimport MultiLineString from '../geom/MultiLineString.js';\nimport MultiPoint from '../geom/MultiPoint.js';\nimport MultiPolygon from '../geom/MultiPolygon.js';\nimport Point from '../geom/Point.js';\nimport Polygon from '../geom/Polygon.js';\nimport {assert} from '../asserts.js';\nimport {containsExtent} from '../extent.js';\nimport {deflateCoordinates} from '../geom/flat/deflate.js';\nimport {get as getProjection} from '../proj.js';\nimport {isEmpty} from '../obj.js';\nimport {linearRingIsClockwise} from '../geom/flat/orient.js';\nimport {transformGeometryWithOptions} from './Feature.js';\n\n/**\n * @typedef {import(\"arcgis-rest-api\").Feature} EsriJSONFeature\n * @typedef {import(\"arcgis-rest-api\").FeatureSet} EsriJSONFeatureSet\n * @typedef {import(\"arcgis-rest-api\").Geometry} EsriJSONGeometry\n * @typedef {import(\"arcgis-rest-api\").Point} EsriJSONPoint\n * @typedef {import(\"arcgis-rest-api\").Polyline} EsriJSONPolyline\n * @typedef {import(\"arcgis-rest-api\").Polygon} EsriJSONPolygon\n * @typedef {import(\"arcgis-rest-api\").Multipoint} EsriJSONMultipoint\n * @typedef {import(\"arcgis-rest-api\").HasZM} EsriJSONHasZM\n * @typedef {import(\"arcgis-rest-api\").Position} EsriJSONPosition\n * @typedef {import(\"arcgis-rest-api\").SpatialReferenceWkid} EsriJSONSpatialReferenceWkid\n */\n\n/**\n * @typedef {Object} EsriJSONMultiPolygon\n * @property {Array<Array<Array<Array<number>>>>} rings Rings for the MultiPolygon.\n * @property {boolean} [hasM] If the polygon coordinates have an M value.\n * @property {boolean} [hasZ] If the polygon coordinates have a Z value.\n * @property {EsriJSONSpatialReferenceWkid} [spatialReference] The coordinate reference system.\n */\n\n/**\n * @const\n * @type {Object<import(\"../geom/Geometry.js\").Type, function(EsriJSONGeometry): import(\"../geom/Geometry.js\").default>}\n */\nconst GEOMETRY_READERS = {\n  Point: readPointGeometry,\n  LineString: readLineStringGeometry,\n  Polygon: readPolygonGeometry,\n  MultiPoint: readMultiPointGeometry,\n  MultiLineString: readMultiLineStringGeometry,\n  MultiPolygon: readMultiPolygonGeometry,\n};\n\n/**\n * @const\n * @type {Object<import(\"../geom/Geometry.js\").Type, function(import(\"../geom/Geometry.js\").default, import(\"./Feature.js\").WriteOptions=): (EsriJSONGeometry)>}\n */\nconst GEOMETRY_WRITERS = {\n  Point: writePointGeometry,\n  LineString: writeLineStringGeometry,\n  Polygon: writePolygonGeometry,\n  MultiPoint: writeMultiPointGeometry,\n  MultiLineString: writeMultiLineStringGeometry,\n  MultiPolygon: writeMultiPolygonGeometry,\n};\n\n/**\n * @typedef {Object} Options\n * @property {string} [geometryName] Geometry name to use when creating features.\n */\n\n/**\n * @classdesc\n * Feature format for reading and writing data in the EsriJSON format.\n *\n * @api\n */\nclass EsriJSON extends JSONFeature {\n  /**\n   * @param {Options} [options] Options.\n   */\n  constructor(options) {\n    options = options ? options : {};\n\n    super();\n\n    /**\n     * Name of the geometry attribute for features.\n     * @type {string|undefined}\n     * @private\n     */\n    this.geometryName_ = options.geometryName;\n  }\n\n  /**\n   * @param {Object} object Object.\n   * @param {import(\"./Feature.js\").ReadOptions} [options] Read options.\n   * @param {string} [idField] Name of the field where to get the id from.\n   * @protected\n   * @return {import(\"../Feature.js\").default} Feature.\n   */\n  readFeatureFromObject(object, options, idField) {\n    const esriJSONFeature = /** @type {EsriJSONFeature} */ (object);\n    const geometry = readGeometry(esriJSONFeature.geometry, options);\n    const feature = new Feature();\n    if (this.geometryName_) {\n      feature.setGeometryName(this.geometryName_);\n    }\n    feature.setGeometry(geometry);\n    if (esriJSONFeature.attributes) {\n      feature.setProperties(esriJSONFeature.attributes, true);\n      const id = esriJSONFeature.attributes[idField];\n      if (id !== undefined) {\n        feature.setId(/** @type {number} */ (id));\n      }\n    }\n    return feature;\n  }\n\n  /**\n   * @param {Object} object Object.\n   * @param {import(\"./Feature.js\").ReadOptions} [options] Read options.\n   * @protected\n   * @return {Array<Feature>} Features.\n   */\n  readFeaturesFromObject(object, options) {\n    options = options ? options : {};\n    if (object['features']) {\n      const esriJSONFeatureSet = /** @type {EsriJSONFeatureSet} */ (object);\n      /** @type {Array<import(\"../Feature.js\").default>} */\n      const features = [];\n      const esriJSONFeatures = esriJSONFeatureSet.features;\n      for (let i = 0, ii = esriJSONFeatures.length; i < ii; ++i) {\n        features.push(\n          this.readFeatureFromObject(\n            esriJSONFeatures[i],\n            options,\n            object.objectIdFieldName\n          )\n        );\n      }\n      return features;\n    }\n    return [this.readFeatureFromObject(object, options)];\n  }\n\n  /**\n   * @param {EsriJSONGeometry} object Object.\n   * @param {import(\"./Feature.js\").ReadOptions} [options] Read options.\n   * @protected\n   * @return {import(\"../geom/Geometry.js\").default} Geometry.\n   */\n  readGeometryFromObject(object, options) {\n    return readGeometry(object, options);\n  }\n\n  /**\n   * @param {Object} object Object.\n   * @protected\n   * @return {import(\"../proj/Projection.js\").default} Projection.\n   */\n  readProjectionFromObject(object) {\n    if (\n      object['spatialReference'] &&\n      object['spatialReference']['wkid'] !== undefined\n    ) {\n      const spatialReference = /** @type {EsriJSONSpatialReferenceWkid} */ (\n        object['spatialReference']\n      );\n      const crs = spatialReference.wkid;\n      return getProjection('EPSG:' + crs);\n    }\n    return null;\n  }\n\n  /**\n   * Encode a geometry as a EsriJSON object.\n   *\n   * @param {import(\"../geom/Geometry.js\").default} geometry Geometry.\n   * @param {import(\"./Feature.js\").WriteOptions} [options] Write options.\n   * @return {EsriJSONGeometry} Object.\n   * @api\n   */\n  writeGeometryObject(geometry, options) {\n    return writeGeometry(geometry, this.adaptOptions(options));\n  }\n\n  /**\n   * Encode a feature as a esriJSON Feature object.\n   *\n   * @param {import(\"../Feature.js\").default} feature Feature.\n   * @param {import(\"./Feature.js\").WriteOptions} [options] Write options.\n   * @return {Object} Object.\n   * @api\n   */\n  writeFeatureObject(feature, options) {\n    options = this.adaptOptions(options);\n    const object = {};\n    if (!feature.hasProperties()) {\n      object['attributes'] = {};\n      return object;\n    }\n    const properties = feature.getProperties();\n    const geometry = feature.getGeometry();\n    if (geometry) {\n      object['geometry'] = writeGeometry(geometry, options);\n      const projection =\n        options && (options.dataProjection || options.featureProjection);\n      if (projection) {\n        object['geometry']['spatialReference'] =\n          /** @type {EsriJSONSpatialReferenceWkid} */ ({\n            wkid: Number(getProjection(projection).getCode().split(':').pop()),\n          });\n      }\n      delete properties[feature.getGeometryName()];\n    }\n    if (!isEmpty(properties)) {\n      object['attributes'] = properties;\n    } else {\n      object['attributes'] = {};\n    }\n    return object;\n  }\n\n  /**\n   * Encode an array of features as a EsriJSON object.\n   *\n   * @param {Array<import(\"../Feature.js\").default>} features Features.\n   * @param {import(\"./Feature.js\").WriteOptions} [options] Write options.\n   * @return {EsriJSONFeatureSet} EsriJSON Object.\n   * @api\n   */\n  writeFeaturesObject(features, options) {\n    options = this.adaptOptions(options);\n    const objects = [];\n    for (let i = 0, ii = features.length; i < ii; ++i) {\n      objects.push(this.writeFeatureObject(features[i], options));\n    }\n    return {\n      'features': objects,\n    };\n  }\n}\n\n/**\n * @param {EsriJSONGeometry} object Object.\n * @param {import(\"./Feature.js\").ReadOptions} [options] Read options.\n * @return {import(\"../geom/Geometry.js\").default} Geometry.\n */\nfunction readGeometry(object, options) {\n  if (!object) {\n    return null;\n  }\n  /** @type {import(\"../geom/Geometry.js\").Type} */\n  let type;\n  if (typeof object['x'] === 'number' && typeof object['y'] === 'number') {\n    type = 'Point';\n  } else if (object['points']) {\n    type = 'MultiPoint';\n  } else if (object['paths']) {\n    const esriJSONPolyline = /** @type {EsriJSONPolyline} */ (object);\n    if (esriJSONPolyline.paths.length === 1) {\n      type = 'LineString';\n    } else {\n      type = 'MultiLineString';\n    }\n  } else if (object['rings']) {\n    const esriJSONPolygon = /** @type {EsriJSONPolygon} */ (object);\n    const layout = getGeometryLayout(esriJSONPolygon);\n    const rings = convertRings(esriJSONPolygon.rings, layout);\n    if (rings.length === 1) {\n      type = 'Polygon';\n      object = Object.assign({}, object, {['rings']: rings[0]});\n    } else {\n      type = 'MultiPolygon';\n      object = Object.assign({}, object, {['rings']: rings});\n    }\n  }\n  const geometryReader = GEOMETRY_READERS[type];\n  return transformGeometryWithOptions(geometryReader(object), false, options);\n}\n\n/**\n * Determines inner and outer rings.\n * Checks if any polygons in this array contain any other polygons in this\n * array. It is used for checking for holes.\n * Logic inspired by: https://github.com/Esri/terraformer-arcgis-parser\n * @param {Array<!Array<!Array<number>>>} rings Rings.\n * @param {import(\"../geom/Geometry.js\").GeometryLayout} layout Geometry layout.\n * @return {Array<!Array<!Array<!Array<number>>>>} Transformed rings.\n */\nfunction convertRings(rings, layout) {\n  const flatRing = [];\n  const outerRings = [];\n  const holes = [];\n  let i, ii;\n  for (i = 0, ii = rings.length; i < ii; ++i) {\n    flatRing.length = 0;\n    deflateCoordinates(flatRing, 0, rings[i], layout.length);\n    // is this ring an outer ring? is it clockwise?\n    const clockwise = linearRingIsClockwise(\n      flatRing,\n      0,\n      flatRing.length,\n      layout.length\n    );\n    if (clockwise) {\n      outerRings.push([rings[i]]);\n    } else {\n      holes.push(rings[i]);\n    }\n  }\n  while (holes.length) {\n    const hole = holes.shift();\n    let matched = false;\n    // loop over all outer rings and see if they contain our hole.\n    for (i = outerRings.length - 1; i >= 0; i--) {\n      const outerRing = outerRings[i][0];\n      const containsHole = containsExtent(\n        new LinearRing(outerRing).getExtent(),\n        new LinearRing(hole).getExtent()\n      );\n      if (containsHole) {\n        // the hole is contained push it into our polygon\n        outerRings[i].push(hole);\n        matched = true;\n        break;\n      }\n    }\n    if (!matched) {\n      // no outer rings contain this hole turn it into and outer\n      // ring (reverse it)\n      outerRings.push([hole.reverse()]);\n    }\n  }\n  return outerRings;\n}\n\n/**\n * @param {EsriJSONPoint} object Object.\n * @return {import(\"../geom/Geometry.js\").default} Point.\n */\nfunction readPointGeometry(object) {\n  let point;\n  if (object.m !== undefined && object.z !== undefined) {\n    point = new Point([object.x, object.y, object.z, object.m], 'XYZM');\n  } else if (object.z !== undefined) {\n    point = new Point([object.x, object.y, object.z], 'XYZ');\n  } else if (object.m !== undefined) {\n    point = new Point([object.x, object.y, object.m], 'XYM');\n  } else {\n    point = new Point([object.x, object.y]);\n  }\n  return point;\n}\n\n/**\n * @param {EsriJSONPolyline} object Object.\n * @return {import(\"../geom/Geometry.js\").default} LineString.\n */\nfunction readLineStringGeometry(object) {\n  const layout = getGeometryLayout(object);\n  return new LineString(object.paths[0], layout);\n}\n\n/**\n * @param {EsriJSONPolyline} object Object.\n * @return {import(\"../geom/Geometry.js\").default} MultiLineString.\n */\nfunction readMultiLineStringGeometry(object) {\n  const layout = getGeometryLayout(object);\n  return new MultiLineString(object.paths, layout);\n}\n\n/**\n * @param {EsriJSONHasZM} object Object.\n * @return {import(\"../geom/Geometry.js\").GeometryLayout} The geometry layout to use.\n */\nfunction getGeometryLayout(object) {\n  /** @type {import(\"../geom/Geometry.js\").GeometryLayout} */\n  let layout = 'XY';\n  if (object.hasZ === true && object.hasM === true) {\n    layout = 'XYZM';\n  } else if (object.hasZ === true) {\n    layout = 'XYZ';\n  } else if (object.hasM === true) {\n    layout = 'XYM';\n  }\n  return layout;\n}\n\n/**\n * @param {EsriJSONMultipoint} object Object.\n * @return {import(\"../geom/Geometry.js\").default} MultiPoint.\n */\nfunction readMultiPointGeometry(object) {\n  const layout = getGeometryLayout(object);\n  return new MultiPoint(object.points, layout);\n}\n\n/**\n * @param {EsriJSONMultiPolygon} object Object.\n * @return {import(\"../geom/Geometry.js\").default} MultiPolygon.\n */\nfunction readMultiPolygonGeometry(object) {\n  const layout = getGeometryLayout(object);\n  return new MultiPolygon(object.rings, layout);\n}\n\n/**\n * @param {EsriJSONPolygon} object Object.\n * @return {import(\"../geom/Geometry.js\").default} Polygon.\n */\nfunction readPolygonGeometry(object) {\n  const layout = getGeometryLayout(object);\n  return new Polygon(object.rings, layout);\n}\n\n/**\n * @param {import(\"../geom/Point.js\").default} geometry Geometry.\n * @param {import(\"./Feature.js\").WriteOptions} [options] Write options.\n * @return {EsriJSONPoint} EsriJSON geometry.\n */\nfunction writePointGeometry(geometry, options) {\n  const coordinates = geometry.getCoordinates();\n  /** @type {EsriJSONPoint} */\n  let esriJSON;\n  const layout = geometry.getLayout();\n  if (layout === 'XYZ') {\n    esriJSON = {\n      x: coordinates[0],\n      y: coordinates[1],\n      z: coordinates[2],\n    };\n  } else if (layout === 'XYM') {\n    esriJSON = {\n      x: coordinates[0],\n      y: coordinates[1],\n      m: coordinates[2],\n    };\n  } else if (layout === 'XYZM') {\n    esriJSON = {\n      x: coordinates[0],\n      y: coordinates[1],\n      z: coordinates[2],\n      m: coordinates[3],\n    };\n  } else if (layout === 'XY') {\n    esriJSON = {\n      x: coordinates[0],\n      y: coordinates[1],\n    };\n  } else {\n    assert(false, 34); // Invalid geometry layout\n  }\n  return esriJSON;\n}\n\n/**\n * @param {import(\"../geom/SimpleGeometry.js\").default} geometry Geometry.\n * @return {Object} Object with boolean hasZ and hasM keys.\n */\nfunction getHasZM(geometry) {\n  const layout = geometry.getLayout();\n  return {\n    hasZ: layout === 'XYZ' || layout === 'XYZM',\n    hasM: layout === 'XYM' || layout === 'XYZM',\n  };\n}\n\n/**\n * @param {import(\"../geom/LineString.js\").default} lineString Geometry.\n * @param {import(\"./Feature.js\").WriteOptions} [options] Write options.\n * @return {EsriJSONPolyline} EsriJSON geometry.\n */\nfunction writeLineStringGeometry(lineString, options) {\n  const hasZM = getHasZM(lineString);\n  return {\n    hasZ: hasZM.hasZ,\n    hasM: hasZM.hasM,\n    paths: [\n      /** @type {Array<EsriJSONPosition>} */ (lineString.getCoordinates()),\n    ],\n  };\n}\n\n/**\n * @param {import(\"../geom/Polygon.js\").default} polygon Geometry.\n * @param {import(\"./Feature.js\").WriteOptions} [options] Write options.\n * @return {EsriJSONPolygon} EsriJSON geometry.\n */\nfunction writePolygonGeometry(polygon, options) {\n  // Esri geometries use the left-hand rule\n  const hasZM = getHasZM(polygon);\n  return {\n    hasZ: hasZM.hasZ,\n    hasM: hasZM.hasM,\n    rings: /** @type {Array<Array<EsriJSONPosition>>} */ (\n      polygon.getCoordinates(false)\n    ),\n  };\n}\n\n/**\n * @param {import(\"../geom/MultiLineString.js\").default} multiLineString Geometry.\n * @param {import(\"./Feature.js\").WriteOptions} [options] Write options.\n * @return {EsriJSONPolyline} EsriJSON geometry.\n */\nfunction writeMultiLineStringGeometry(multiLineString, options) {\n  const hasZM = getHasZM(multiLineString);\n  return {\n    hasZ: hasZM.hasZ,\n    hasM: hasZM.hasM,\n    paths: /** @type {Array<Array<EsriJSONPosition>>} */ (\n      multiLineString.getCoordinates()\n    ),\n  };\n}\n\n/**\n * @param {import(\"../geom/MultiPoint.js\").default} multiPoint Geometry.\n * @param {import(\"./Feature.js\").WriteOptions} [options] Write options.\n * @return {EsriJSONMultipoint} EsriJSON geometry.\n */\nfunction writeMultiPointGeometry(multiPoint, options) {\n  const hasZM = getHasZM(multiPoint);\n  return {\n    hasZ: hasZM.hasZ,\n    hasM: hasZM.hasM,\n    points: /** @type {Array<EsriJSONPosition>} */ (\n      multiPoint.getCoordinates()\n    ),\n  };\n}\n\n/**\n * @param {import(\"../geom/MultiPolygon.js\").default} geometry Geometry.\n * @param {import(\"./Feature.js\").WriteOptions} [options] Write options.\n * @return {EsriJSONPolygon} EsriJSON geometry.\n */\nfunction writeMultiPolygonGeometry(geometry, options) {\n  const hasZM = getHasZM(geometry);\n  const coordinates = geometry.getCoordinates(false);\n  const output = [];\n  for (let i = 0; i < coordinates.length; i++) {\n    for (let x = coordinates[i].length - 1; x >= 0; x--) {\n      output.push(coordinates[i][x]);\n    }\n  }\n  return {\n    hasZ: hasZM.hasZ,\n    hasM: hasZM.hasM,\n    rings: /** @type {Array<Array<EsriJSONPosition>>} */ (output),\n  };\n}\n\n/**\n * @param {import(\"../geom/Geometry.js\").default} geometry Geometry.\n * @param {import(\"./Feature.js\").WriteOptions} [options] Write options.\n * @return {EsriJSONGeometry} EsriJSON geometry.\n */\nfunction writeGeometry(geometry, options) {\n  const geometryWriter = GEOMETRY_WRITERS[geometry.getType()];\n  return geometryWriter(\n    transformGeometryWithOptions(geometry, true, options),\n    options\n  );\n}\n\nexport default EsriJSON;\n","import { useSlots, onBeforeMount, onMounted, onBeforeUnmount, ref, reactive, computed, watch, nextTick, defineAsyncComponent, useCssModule, inject, getCurrentInstance } from 'vue'\r\nimport $ from 'jquery'\r\n\r\nimport { Map, View, Feature } from 'ol' // 引入容器绑定模塊和視圖模塊\r\n\r\nimport { TileArcGISRest } from 'ol/source.js'\r\n\r\nimport XYZ from 'ol/source/XYZ' // 引入XYZ地圖格式\r\nimport VectorSource from 'ol/source/Vector.js'\r\nimport { Fill, Stroke, Style, Icon } from 'ol/style.js'\r\nimport { Tile, Tile as TileLayer, Image as ImageLayer, Vector, Vector as VectorLayer } from 'ol/layer.js'\r\nimport TileWMS from 'ol/source/TileWMS.js'\r\nimport ImageWMS from 'ol/source/ImageWMS.js'\r\nimport TileGrid from 'ol/tilegrid/TileGrid.js'\r\nimport * as olTilegrid from 'ol/tilegrid'\r\nimport * as olProj from 'ol/proj'\r\n\r\nimport { ImageArcGISRest, OSM } from 'ol/source.js'\r\nimport PerspectiveMap from \"ol-ext/map/PerspectiveMap\"\r\n\r\nimport WFS from 'ol/format/WFS.js'\r\nimport EsriJSON from 'ol/format/EsriJSON.js'\r\nimport { createXYZ } from 'ol/tilegrid.js'\r\nimport { tile as tileStrategy } from 'ol/loadingstrategy.js'\r\nimport { Circle, Polygon, Point } from 'ol/geom.js'\r\nimport Projection from 'ol/proj/Projection.js'\r\nimport GeoJSON from 'ol/format/GeoJSON.js'\r\n\r\nimport 'ol/ol.css' // ol提供的css样式\r\nimport { format } from 'ol/coordinate'\r\nimport { get as getProjection, transformExtent } from 'ol/proj.js'\r\nimport { getTopLeft, getWidth } from 'ol/extent.js'\r\n\r\nexport const tribeIdList = {\r\n    88: '石磊部',\r\n    89: '平論文部',\r\n    90: '抬耀部',\r\n    91: '帛納外部',\r\n    133: '河頭部落',\r\n    118: '十八兒部落',\r\n    119: '五峰部落',\r\n    134: '泰平部落'\r\n}\r\n\r\nexport const initLayers = async function() {\r\n    const obj = await $.ajax({\r\n        url: 'https://api.edtest.site/layers',\r\n        method: 'GET'\r\n    })\r\n    return obj\r\n}\r\n\r\nexport async function getTribeData (tribeId) {\r\n    const result = await $.ajax({\r\n        url: `https://api.edtest.site/tribe?tribeCode=${tribeId}`,\r\n        method: \"GET\"\r\n    }).done(res => {\r\n        return res\r\n        }).fail(FailMethod => {\r\n        console.log('Fail', FailMethod)\r\n        return false\r\n        })\r\n    return result\r\n}\r\n\r\nexport default {\r\n    america: () => {\r\n        return new TileLayer({\r\n            name: 'america',\r\n            className: 'america',\r\n            preload: Infinity,\r\n            source: new TileArcGISRest({\r\n                url: 'https://sampleserver6.arcgisonline.com/ArcGIS/rest/services/' + 'USA/MapServer',\r\n            }),\r\n        })\r\n    },\r\n    EsriJSON: () => {\r\n        const serviceUrl = 'https://services8.arcgis.com/jz4Cju60Wi6R7jAW/arcgis/rest/services/' + 'RIVERPOLY_(1)/FeatureServer/0'\r\n        const style = new Style({\r\n            fill: new Fill(),\r\n            stroke: new Stroke({\r\n                color: [0, 38, 115, 1],\r\n                width: 0.5,\r\n            }),\r\n        });\r\n\r\n        const newVectorSource = new VectorSource({\r\n            format: new EsriJSON(),\r\n            url: function (extent, resolution, projection) {\r\n                const srid = projection.getCode().split(/:(?=\\d+$)/).pop();\r\n                const url = serviceUrl + '/query/?f=json&' + 'returnGeometry=true&spatialRel=esriSpatialRelIntersects&geometry=' +\r\n                    encodeURIComponent(`{\"xmin\":${extent[0]},\"ymin\":${extent[1]},\"xmax\":${extent[2]},\"ymax\":${extent[3]},\"spatialReference\":{\"wkid\":${srid}}}`) +\r\n                    '&geometryType=esriGeometryEnvelope&inSR=' + srid + '&outFields=*' + '&outSR=' + srid;\r\n                return url;\r\n            },\r\n            strategy: tileStrategy(\r\n                createXYZ({\r\n                    tileSize: 512,\r\n                })\r\n            ),\r\n        });\r\n\r\n        return new VectorLayer({\r\n            name: 'EsriJSON',\r\n            source: newVectorSource,\r\n            style: function (feature) {\r\n                const color = [0, 38, 115, 1];\r\n                style.getFill().setColor(color);\r\n                return style;\r\n            },\r\n            opacity: 0.7,\r\n        });\r\n    },\r\n    BsriJSON: () => {\r\n        const serviceUrl = 'https://services8.arcgis.com/jz4Cju60Wi6R7jAW/arcgis/rest/services/' + '河川支流/FeatureServer/0'\r\n        const style = new Style({\r\n            fill: new Fill(),\r\n            stroke: new Stroke({\r\n                color: [0, 0, 0, 1],\r\n                width: 0.5,\r\n            }),\r\n        });\r\n\r\n        const newVectorSource = new VectorSource({\r\n            format: new EsriJSON(),\r\n            url: function (extent, resolution, projection) {\r\n                const srid = projection.getCode().split(/:(?=\\d+$)/).pop();\r\n                const url = serviceUrl + '/query/?f=json&' + 'returnGeometry=true&spatialRel=esriSpatialRelIntersects&geometry=' +\r\n                    encodeURIComponent(`{\"xmin\":${extent[0]},\"ymin\":${extent[1]},\"xmax\":${extent[2]},\"ymax\":${extent[3]},\"spatialReference\":{\"wkid\":${srid}}}`) +\r\n                    '&geometryType=esriGeometryEnvelope&inSR=' + srid + '&outFields=*' + '&outSR=' + srid;\r\n                return url;\r\n            },\r\n            strategy: tileStrategy(\r\n                createXYZ({\r\n                    tileSize: 512,\r\n                })\r\n            ),\r\n        });\r\n\r\n        return new VectorLayer({\r\n            name: 'BsriJSON',\r\n            type: 'BsriJSON',\r\n            source: newVectorSource,\r\n            style: function (feature) {\r\n                const color = [0, 0, 0, 1];\r\n                style.getFill().setColor(color);\r\n                return style;\r\n            },\r\n            opacity: 1,\r\n        });\r\n    },\r\n    DimensionMap: () => {\r\n            // 95TM2:\r\n            //     x: 283076.26\r\n            //     y: 2727660.24\r\n            // WGS84:\r\n            //     lat: 24.655499\r\n            //     lng: 121.326776\r\n        const circleFeature = new Feature({\r\n            name: 'DimensionMap',\r\n            title: 'DimensionMap',\r\n            geometry: new Circle([120.9984423386347, 24.791781619336316], 0.005),\r\n        })\r\n\r\n        const circleStyle = new Style({\r\n            renderer(coordinates, state) {\r\n                const [[x, y], [x1, y1]] = coordinates;\r\n                const ctx = state.context;\r\n                const dx = x1 - x;\r\n                const dy = y1 - y;\r\n                const radius = Math.sqrt(dx * dx + dy * dy);\r\n                ctx.beginPath();\r\n                ctx.arc(x, y, radius, 0, 2 * Math.PI, true);\r\n                ctx.fillStyle = 'rgba(255,0,0)';\r\n                ctx.fill();\r\n            },\r\n        })\r\n        const raster = new VectorLayer({\r\n            source: new VectorSource({\r\n                features: [circleFeature],\r\n            }),\r\n            style: circleStyle\r\n        })\r\n\r\n        const coordinates = [\r\n            [120.971859, 24.801583],\r\n            [120.970000, 24.809583],\r\n            [120.985000, 24.808583],\r\n            [120.990000, 24.806583],\r\n            [120.971859, 24.801583]\r\n        ]\r\n\r\n\r\n        const areaLineLayer = new Vector({\r\n            name: 'DimensionMap',\r\n            title: 'DimensionMap',\r\n            source: new VectorSource({\r\n                features: [new Feature({\r\n                    name: 'areaLineLayer',\r\n                    title: 'areaLineLayer',\r\n                    geometry: new Polygon([coordinates]),\r\n                })],\r\n            }),\r\n            style: new Style({\r\n                fill: new Fill({\r\n                    color: '#0f9ce2'\r\n                }),\r\n            })\r\n        })\r\n\r\n        return [raster, areaLineLayer]\r\n        // 關閉地圖細節事件\r\n    },\r\n    getLayer: (layer, nestedSubNodeIndex, id) => {\r\n        let result, layerSource\r\n        let layerType = layer.layer_type\r\n        let figureType = layer.figure_type\r\n        if (layerType === 'WMS') {\r\n            let request = [], sub = {}\r\n            const url = isNaN(nestedSubNodeIndex) ? layer.tiles_url : layer.tiles_list[nestedSubNodeIndex].tile_url\r\n            switch (figureType) {\r\n                case 'Point':\r\n                    // needFix: 樣式尚未套用\r\n                    // const myStyle = new Style({\r\n                    //     image: new Icon({\r\n                    //         anchor: [0.5, 0.96],\r\n                    //         src: 'https://pixlr.com/img/icon/premium-tick.svg',\r\n                    //         crossOrigin: 'anonymous',\r\n                    //         scale: 2,\r\n                    //         // src: layer.tiles_url,\r\n                    //         // width: 300,\r\n                    //         // height: 300,\r\n                    //     }),\r\n                    //     stroke: new Stroke({\r\n                    //         color: '#319FD3',\r\n                    //         width: 1\r\n                    //     }),\r\n                    //     fill: new Fill({\r\n                    //         color: '#000000',\r\n                    //     }),\r\n                    //     text: new Text({\r\n                    //         font: '12px Calibri,sans-serif',\r\n                    //         fill: new Fill({\r\n                    //             color: '#ff0'\r\n                    //         }),\r\n                    //         stroke: new Stroke({\r\n                    //             color: '#09C',\r\n                    //             width: 3\r\n                    //         })\r\n                    //     })\r\n                    // })\r\n\r\n                    if ( url ) {\r\n                        request = url.split(\"WMSServer?\")\r\n                        request[1] = request[1].split('&')\r\n                        request[1].forEach(node=>{\r\n                            const subNode = node.split('=')\r\n                            sub[subNode[0]] = subNode[1]\r\n                        })\r\n                    }\r\n                    layerSource = new TileWMS({\r\n                        maxzoom: 18,\r\n                        minzoom: 3,\r\n                        url: 'https://dwgis1.ncdr.nat.gov.tw/server/services/MAP0627/Map2022FloodingPoint1721/MapServer/WMSServer',\r\n                        params: {\r\n                            'SERVICE': 'WMS',\r\n                            'BGCOLOR': '0xFFFFFF',\r\n                            'TRANSPARENT': 'TRUE',\r\n                            'SRS': 'EPSG:3826',\r\n                            'LAYERS': '0',\r\n                            'VERSION': '1.1.1',\r\n                            'FORMAT': 'image/png',\r\n                        },\r\n                        serverType: 'mapserver',\r\n                        crossOrigin: 'anonymous',\r\n                    })\r\n                    layerSource = new TileWMS({\r\n                        maxzoom: 18,\r\n                        minzoom: 3,\r\n                        url: request[0] + 'WMSServer?',\r\n                        params: sub,\r\n                        serverType: 'mapserver'\r\n                    })\r\n                    break;\r\n                case 'Surface':\r\n                    // needFix: 要是連結格式不對，該如何處理\r\n                    if ( url ) {\r\n                        request = url.split(\"WMSServer?\")\r\n                        request[1] = request[1].split('&')\r\n                        request[1].forEach(node=>{\r\n                            const subNode = node.split('=')\r\n                            sub[subNode[0]] = subNode[1]\r\n                        })\r\n                    }\r\n                    // \"https://dwgis.ncdr.nat.gov.tw/arcgis/services/ncdr/NCDR_Maps/MapServer/WmsServerhttps://dwgis1.ncdr.nat.gov.tw/server/services/MAP0627/Map2022PotentialSeaZone/MapServer/WMSServer?REQUEST=GetMap&SERVICE=WMS&VERSION=1.1.1&LAYERS=1&STYLES=&FORMAT=image/png&BGCOLOR=0xFFFFFF&TRANSPARENT=TRUE&SRS=EPSG:3826\"\r\n                    // url: 'https://dwgis1.ncdr.nat.gov.tw/server/services/MAP0627/Map2022FloodingArea1721/MapServer/WMSServer?REQUEST=GetMap&SERVICE=WMS&BGCOLOR=0xFFFFFF&TRANSPARENT=TRUE&SRS=EPSG:3826&LAYERS=0&VERSION=1.1.1&FORMAT=image/png&STYLES=',\r\n                    // url: 'https://dwgis1.ncdr.nat.gov.tw/server/services/MAP0627/Map2022FloodingArea1721/MapServer/WMSServer',\r\n                    // items_group\r\n                    layerSource = new TileWMS({\r\n                        maxzoom: 18,\r\n                        minzoom: 3,\r\n                        url: request[0] + 'WMSServer?',\r\n                        params: sub,\r\n                        serverType: 'mapserver'\r\n                    })\r\n                    break;\r\n                    case 'Line':\r\n                        // 活動斷層\r\n                        if ( url ) {\r\n                            request = url.split(\"WMSServer?\")\r\n                            request[1] = request[1].split('&')\r\n                            request[1].forEach(node=>{\r\n                                const subNode = node.split('=')\r\n                                sub[subNode[0]] = subNode[1]\r\n                            })\r\n                        }\r\n                        layerSource = new TileWMS({\r\n                            maxzoom: 18,\r\n                            minzoom: 3,\r\n                            url: request[0] + 'WMSServer?',\r\n                            params: sub,\r\n                            serverType: 'mapserver'\r\n                        })\r\n                        break;\r\n                default:\r\n                    console.log('otherWMSLayer', figureType)\r\n            }\r\n            let tileTitle = isNaN(nestedSubNodeIndex) ? '' : `- ${ layer.tiles_list[nestedSubNodeIndex]?.title }`\r\n            result = new TileLayer({\r\n                id: id,\r\n                label: `${ layer.title } ${ tileTitle }`,\r\n                source: layerSource,\r\n            })\r\n        }\r\n        if (layerType === 'GeoJson') {\r\n            console.log('GeoJsonLayer', figureType)\r\n            switch (figureType) {\r\n                case 'Line':\r\n                    console.log('1')\r\n                    result = new VectorLayer({\r\n                        source: new VectorSource({\r\n                            url: 'http://gis.edtest.site:8010/ogc/temp',\r\n                            params: {\r\n                                // http://gis.edtest.site:8010/ogc/temp\r\n                                SERVICE: 'WMS',\r\n                                VERSION: '1.3.0',\r\n                                REQUEST: 'GetMap',\r\n                                FORMAT: 'image/png',\r\n                                STYLE: 'default',\r\n                                SLD_VERSION: '1.1.0'\r\n                                // LAYER: '%E6%96%B0%E7%AB%B9%E7%B8%A3%E5%8E%9F%E4%BD%8F%E6%B0%91%E9%83%A8%E8%90%BD%E7%AF%84%E5%9C%8D',\r\n                            }\r\n                            // url: 'https://dmap.ncdr.nat.gov.tw/GeoJson/土石流潛勢溪流.geojson',\r\n                            // url: 'https://openlyersbook.github.io/openlayers_book_samples/assets/data/countries.geojson',\r\n                            // format: new GeoJSON(),\r\n                        }),\r\n                    });\r\n\r\n                    // help_btn_display true\r\n                    // help_memo \"<p>資料來源：農委會水土保持局</p>\\n<p>111年土石流災害潛勢溪流總計為1,729條。</p>\"\r\n                    // icon \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAOUlEQVQ4jWNhoDJgGTVw1MDBYuBKhqcNjAxM9pQY9J/h38FwBukG2rgwnEG6gaoGUhOMGjhqIBkAAHaXB0Oou38UAAAAAElFTkSuQmCC\"\r\n                    // prop_show_list ['Debrisno']\r\n                    // tile_url null\r\n                    // tiles_list null\r\n                    // tiles_list_description \"\"\r\n                    // tiles_url \"https://dmap.ncdr.nat.gov.tw/GeoJson/土石流潛勢溪流.geojson\"\r\n                    // title \"土石流潛勢溪流\"\r\n                    break;\r\n                case 'Point':\r\n                    const wmsSource = new TileWMS({\r\n                        maxzoom: 18,\r\n                        minzoom: 3,\r\n                        url: 'https://dwgis1.ncdr.nat.gov.tw/server/services/MAP0627/Map2022FloodingPoint1721/MapServer/WMSServer',\r\n                        params: {\r\n                            'SERVICE': 'WMS',\r\n                            'BGCOLOR': '0xFFFFFF',\r\n                            'TRANSPARENT': 'TRUE',\r\n                            'SRS': 'EPSG:3826',\r\n                            'LAYERS': '0',\r\n                            'VERSION': '1.1.1',\r\n                            'FORMAT': 'image/png',\r\n                        },\r\n                        // serverType: 'mapserver',\r\n                        crossOrigin: 'anonymous',\r\n                    })\r\n                    result = new TileLayer({\r\n                        source: wmsSource,\r\n                    })\r\n\r\n                    // help_btn_display:true\r\n                    // help_memo:\"<p>資料來源:國家災害防救科技中心</p>\\n<p>收整水利署、新聞、媒體及現勘資料2017年~2021年</p>\"\r\n                    break;\r\n                default:\r\n                    console.log(figureType)\r\n            }\r\n        }\r\n\r\n        return result\r\n    },\r\n    getLayerIndex: (layeredIndex) => {\r\n        let nodeIndex, subNodeIndex = undefined, nestedSubNodeIndex = undefined\r\n        layeredIndex.split('_').forEach((element, key)=>{\r\n            switch(key) {\r\n                case 0:\r\n                    nodeIndex = Number(element.split('node')[1])\r\n                    break;\r\n                case 1:\r\n                    subNodeIndex = Number(element.split('subNode')[1])\r\n                    break;\r\n                case 2:\r\n                    nestedSubNodeIndex = element.split('nestedSubNode')[1] !== 'undefined' ? Number(element.split('nestedSubNode')[1]) : 'undefined'\r\n                    break;\r\n            }\r\n        })\r\n        return {nodeIndex, subNodeIndex, nestedSubNodeIndex, layeredIndex}\r\n    },\r\n}\r\n\r\n\r\n// [230, 0, 0, 1] 紅色\r\n// [104, 104, 104, 1] 灰色\r\n// [115, 76, 0, 1] 土黃色","export default \"__VITE_ASSET__e32a2a13__\"","export default \"__VITE_ASSET__204bf141__\"","<script>\r\nimport { useSlots, onBeforeMount, onMounted, onBeforeUnmount, ref, reactive, computed, watch, nextTick, defineAsyncComponent, useCssModule, inject } from 'vue'\r\nimport $ from 'jquery'\r\nimport { getTribeData } from '@/config/mapLayerList'\r\n\r\nexport default {\r\n    props: {\r\n        id:{\r\n            Type: String,\r\n            default: 0\r\n        },\r\n        closeMapData: {\r\n            Type: Function,\r\n            default: ()=>{}\r\n        }\r\n    },\r\n    setup(props, { emit }){\r\n        const state = reactive({\r\n            media: 'photo',\r\n            tribeData: (()=> getTribeData(props.id)),\r\n            // tribeData: {},\r\n        })\r\n\r\n        watch(()=>{props.id, (newValue, oldValue)=>{\r\n            console.log(newValue, oldValue)\r\n        }})\r\n\r\n        onMounted(()=>{\r\n            getTribeData(props.id).then((result)=>{\r\n                state.tribeData = result\r\n            })\r\n        })\r\n\r\n        return {\r\n            props,\r\n            state,\r\n        }\r\n    }\r\n}\r\n\r\n</script>\r\n\r\n<template>\r\n    <div class=\"bg-white rounded py-2\">\r\n        <div class=\"row mx-0 align-items-center flex-nowrap text-center p-2 fw-bold\">\r\n            <p>詳細資訊</p>\r\n            <!-- needfix:尚未加入關閉地圖資訊按鈕事件 -->\r\n            <a href=\"\" class=\"position-absolute col-auto end-0\" style=\"top: 10px;\" >\r\n                <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10s-4.477 10-10 10zm0-11.414L9.172 7.757L7.757 9.172L10.586 12l-2.829 2.828l1.415 1.415L12 13.414l2.828 2.829l1.415-1.415L13.414 12l2.829-2.828l-1.415-1.415L12 10.586z\"/></svg>\r\n            </a>\r\n        </div>\r\n        <img src=\"@/assets/example-AddressData.jpg\" class=\"w-100\" alt=\"\">\r\n        <div class=\"row mx-0 align-items-center p-2 position-relative\">\r\n            <p>title: {{ props?.id }} {{ state?.tribeData?.basicInformation?.tribeName }} </p>\r\n            <p>描述: {{ state?.tribeData?.basicInformation?.description }}</p>\r\n            <div class=\"position-absolute w-auto top-0 end-0 mt-2\">更多資訊</div>\r\n            <p>{{ state?.tribeData?.basicInformation?.area }}</p>\r\n            <a href=\"\">\r\n                <img src=\"@/assets/img/icon/vector.svg\" alt=\"\">\r\n                {{ state?.tribeData?.basicInformation?.coordinates?.WGS84?.lat}}\r\n                ,\r\n                {{state?.tribeData?.basicInformation?.coordinates?.WGS84?.lng }}\r\n            </a>\r\n        </div>\r\n        <div>\r\n            <div class=\"border-bottom row flex-nowrap p-2 my-3 cursor-pointer\">\r\n                <div class=\"col-6 cursor-pointer\" @click=\"state.media = 'photo'\">相片</div>\r\n                <div class=\"col-6 cursor-pointer\" @click=\"state.media = 'video'\">影片</div>\r\n            </div>\r\n            <div class=\"py-2 px-4\" v-if=\"state.media === 'photo'\">\r\n                <div class=\"d-flex flex-wrap justify-content-between\">\r\n                    <div class=\"w-50 mb-4\" v-for=\"item in state?.tribeData?.culturalLandscape\">\r\n                        <p class=\"mb-0\">{{ item.name }}</p>\r\n                        <img :src=\"item.image\" alt=\"\" class=\"w-100\">\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"py-2 px-4\" v-if=\"state.media === 'video'\">\r\n                <div>影片影片影片影片影片影片</div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<style lang=\"sass\" scoped>\r\n@import '@/assets/styles/all.module.scss'\r\n// .lightbox\r\n//     top: 20%\r\n//     left: 50%\r\n</style>\r\n","<script>\r\nimport { useSlots, onBeforeMount, onMounted, onBeforeUnmount, ref, reactive, computed, watch, nextTick, defineAsyncComponent, useCssModule, inject } from 'vue'\r\nimport $ from 'jquery'\r\nimport { Layer } from 'ol/layer'\r\n\r\nexport default {\r\n    props: {\r\n        onClose: {\r\n            type: Function,\r\n            default: ()=>{}\r\n        },\r\n        onChangLayerVisible: {\r\n            type: Function,\r\n            default: ()=>{}\r\n        },\r\n        onDeleteLayer: {\r\n            type: Function,\r\n            default: ()=>{}\r\n        },\r\n        onLockLayer: {\r\n            type: Function,\r\n            default: ()=>{}\r\n        },\r\n        onChangeOrderLayer: {\r\n            type: Function,\r\n            default: ()=>{}\r\n        },\r\n        currentLayers: {\r\n            type: Array,\r\n            default: []\r\n        },\r\n        selectLock: {\r\n            type: Boolean,\r\n            default: false\r\n        }\r\n    },\r\n    setup(props, { emit }) {\r\n        const state = reactive({\r\n        })\r\n\r\n        return {\r\n            props,\r\n            state,\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<template>\r\n    <div class=\"rounded-4 bg-white\">\r\n        <div class=\"row mx-0 align-items-center flex-nowrap text-center p-2 fw-bold\">\r\n            <p class=\"mb-0 fs-5\">已選擇的圖層</p>\r\n            <a href=\"\" class=\"closeBtn position-absolute col-auto\" @click.prevent=\"props.onClose\">\r\n                <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10s-4.477 10-10 10zm0-11.414L9.172 7.757L7.757 9.172L10.586 12l-2.829 2.828l1.415 1.415L12 13.414l2.828 2.829l1.415-1.415L13.414 12l2.829-2.828l-1.415-1.415L12 10.586z\"/></svg>\r\n            </a>\r\n        </div>\r\n        <hr class=\"my-0\">\r\n        <div class=\"py-3 px-4 content\">\r\n            <div class=\"allControl d-flex align-items-center justify-content-end mb-0\">\r\n                <a href=\"\" class=\"d-flex align-items-center text-decoration-none me-4\"\r\n                :class=\"{'lockUp': props.selectLock, 'unlock': !props.selectLock}\"\r\n                @click.prevent=\"()=>{\r\n                    props.onLockLayer()\r\n                }\">\r\n                    <svg viewBox=\"0 0 25 24\" fill=\"currentColor\">\r\n                        <path d=\"M8.02381 9.33333H14.881V7.80952C14.881 7.1746 14.6587 6.63492 14.2143 6.19048C13.7698 5.74603 13.2302 5.52381 12.5952 5.52381C11.9603 5.52381 11.4206 5.74603 10.9762 6.19048C10.5317 6.63492 10.3095 7.1746 10.3095 7.80952H8.78571C8.78571 6.75556 9.15727 5.85702 9.90038 5.1139C10.643 4.3713 11.5413 4 12.5952 4C13.6492 4 14.5477 4.3713 15.2909 5.1139C16.0335 5.85702 16.4048 6.75556 16.4048 7.80952V9.33333H17.1667C17.5857 9.33333 17.9446 9.48241 18.2432 9.78057C18.5414 10.0792 18.6905 10.4381 18.6905 10.8571V18.4762C18.6905 18.8952 18.5414 19.2541 18.2432 19.5528C17.9446 19.8509 17.5857 20 17.1667 20H8.02381C7.60476 20 7.24616 19.8509 6.948 19.5528C6.64933 19.2541 6.5 18.8952 6.5 18.4762V10.8571C6.5 10.4381 6.64933 10.0792 6.948 9.78057C7.24616 9.48241 7.60476 9.33333 8.02381 9.33333ZM12.5952 16.1905C13.0143 16.1905 13.3731 16.0414 13.6718 15.7432C13.97 15.4446 14.119 15.0857 14.119 14.6667C14.119 14.2476 13.97 13.8888 13.6718 13.5901C13.3731 13.2919 13.0143 13.1429 12.5952 13.1429C12.1762 13.1429 11.8176 13.2919 11.5194 13.5901C11.2208 13.8888 11.0714 14.2476 11.0714 14.6667C11.0714 15.0857 11.2208 15.4446 11.5194 15.7432C11.8176 16.0414 12.1762 16.1905 12.5952 16.1905Z\" />\r\n                    </svg>\r\n                    鎖定圖層\r\n                </a>\r\n                <a href=\"\" class=\"d-flex align-items-center text-decoration-none\"\r\n                :class=\"{'disabled':props.currentLayers.length <= 1}\"\r\n                @click.prevent=\"()=>{\r\n                    if (props.currentLayers.length > 0) {\r\n                        props.onDeleteLayer({\r\n                            action: 'selectLayerMode',\r\n                            value: {\r\n                                layerName: 'all'\r\n                            }\r\n                        })\r\n                    }\r\n                }\">\r\n                    <svg viewBox=\"0 0 25 24\" fill=\"currentColor\">\r\n                        <path d=\"M7.5 21C6.95 21 6.47933 20.8043 6.088 20.413C5.696 20.021 5.5 19.55 5.5 19V6H4.5V4H9.5V3H15.5V4H20.5V6H19.5V19C19.5 19.55 19.3043 20.021 18.913 20.413C18.521 20.8043 18.05 21 17.5 21H7.5ZM9.5 17H11.5V8H9.5V17ZM13.5 17H15.5V8H13.5V17Z\" />\r\n                    </svg>\r\n                    全部刪除\r\n                </a>\r\n            </div>\r\n            <ul class=\"list-unstyled d-flex flex-wrap flex-column-reverse\">\r\n                <li v-for=\"(node, nodeIndex) in props.currentLayers\">\r\n                    <div class=\"d-flex justify-content-between align-items-center border-bottom py-2\" v-if=\"node.id\">\r\n                        <div>\r\n                            {{ node?.label }}\r\n                        </div>\r\n                        <div class=\"tool\">\r\n                            <a href=\"\"\r\n                            @click.prevent=\"props.onChangeOrderLayer({\r\n                                action: 'changeOrder',\r\n                                value: {\r\n                                    movement:'up',\r\n                                    id: node.id,\r\n                                    key: nodeIndex\r\n                                },\r\n                            })\">\r\n                                <svg viewBox=\"0 0 25 24\" fill=\"currentColor\">\r\n                                    <path d=\"M9.49991 19.84H15.4999V11.84H20.3399L12.4999 4.00003L4.65991 11.84H9.49991V19.84Z\" fill=\"#808080\" />\r\n                                </svg>\r\n                            </a>\r\n                            <a href=\"\"\r\n                            @click.prevent=\"props.onChangeOrderLayer({\r\n                                action: 'changeOrder',\r\n                                value: {\r\n                                    movement: 'down',\r\n                                    id: node.id,\r\n                                    key: nodeIndex\r\n                                }\r\n                            })\">\r\n                                <svg viewBox=\"0 0 25 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                                    <path d=\"M9.49991 4H15.4999V12H20.3399L12.4999 19.84L4.65991 12H9.49991V4Z\" fill=\"#808080\"/>\r\n                                </svg>\r\n                            </a>\r\n                            <a href=\"\"\r\n                            :class=\"{\r\n                                'Invisible': !node?.visible\r\n                            }\"\r\n                            @click.prevent=\"()=>{\r\n                                props.onChangLayerVisible({\r\n                                    action: 'changeLayerVisible',\r\n                                    value: {\r\n                                        key: nodeIndex,\r\n                                    }\r\n                                })\r\n                            }\">\r\n                                <svg viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n                                    <path d=\"M12.3333 10C11.8029 10 11.2942 10.2107 10.9191 10.5858C10.544 10.9609 10.3333 11.4696 10.3333 12C10.3333 12.5304 10.544 13.0391 10.9191 13.4142C11.2942 13.7893 11.8029 14 12.3333 14C12.8638 14 13.3725 13.7893 13.7475 13.4142C14.1226 13.0391 14.3333 12.5304 14.3333 12C14.3333 11.4696 14.1226 10.9609 13.7475 10.5858C13.3725 10.2107 12.8638 10 12.3333 10ZM12.3333 15.3333C11.4493 15.3333 10.6014 14.9821 9.97631 14.357C9.35119 13.7319 9 12.8841 9 12C9 11.1159 9.35119 10.2681 9.97631 9.64298C10.6014 9.01786 11.4493 8.66667 12.3333 8.66667C13.2174 8.66667 14.0652 9.01786 14.6904 9.64298C15.3155 10.2681 15.6667 11.1159 15.6667 12C15.6667 12.8841 15.3155 13.7319 14.6904 14.357C14.0652 14.9821 13.2174 15.3333 12.3333 15.3333ZM12.3333 7C9 7 6.15333 9.07333 5 12C6.15333 14.9267 9 17 12.3333 17C15.6667 17 18.5133 14.9267 19.6667 12C18.5133 9.07333 15.6667 7 12.3333 7Z\" fill=\"#808080\"/>\r\n                                </svg>\r\n                            </a>\r\n                            <a href=\"\"\r\n                            @click.prevent=\"props.onDeleteLayer({\r\n                                action: 'selectLayerMode',\r\n                                value: {\r\n                                    id: node?.id,\r\n                                }\r\n                            })\">\r\n                                <svg viewBox=\"0 0 25 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n                                    <path d=\"M7.5 21C6.95 21 6.47933 20.8043 6.088 20.413C5.696 20.021 5.5 19.55 5.5 19V6H4.5V4H9.5V3H15.5V4H20.5V6H19.5V19C19.5 19.55 19.3043 20.021 18.913 20.413C18.521 20.8043 18.05 21 17.5 21H7.5ZM9.5 17H11.5V8H9.5V17ZM13.5 17H15.5V8H13.5V17Z\" fill=\"#808080\"/>\r\n                                </svg>\r\n                            </a>\r\n                        </div>\r\n                    </div>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<style lang=\"sass\" scoped>\r\n@import '@/assets/styles/all.module.scss'\r\n.closeBtn\r\n    right:10px\r\n    svg\r\n        width: 20px\r\n        height: 20px\r\n.content\r\n    .title\r\n        cursor: pointer\r\n        svg\r\n            transform: rotateZ(0)\r\n        .openTitle\r\n            transform: rotateZ(90deg)\r\n    svg\r\n        width: 28px\r\n        height: 28px\r\n    img\r\n        width: 16px\r\n        height: 16px\r\n.tool\r\n    a\r\n        padding: 5px 0\r\n    .visible\r\n        color: red\r\n    .Invisible\r\n        color: blue\r\n        position: relative\r\n        &::after\r\n            content: ''\r\n            position: absolute\r\n            top: 55%\r\n            left: 20%\r\n            width: 60%\r\n            height: 2px\r\n            background: $grey\r\n            transform-origin: 50% 50%\r\n            transform: rotateZ(45deg)\r\n            display: block\r\n.allControl\r\n    a\r\n        color: $grey\r\n    .lockUp\r\n        color: #247BA0\r\n    .unlock\r\n        color: $grey\r\n</style>\r\n","<script>\r\nimport { useSlots, onBeforeMount, onMounted, onBeforeUnmount, ref, reactive, computed, watch, nextTick, defineAsyncComponent, useCssModule, inject } from 'vue'\r\nimport $ from 'jquery'\r\n\r\nimport mapLayerList, { initLayers } from '@/config/mapLayerList'\r\nimport baseMapList from '@/config/baseMapList'\r\nimport VectorImageLayer from 'ol/layer/VectorImage.js'\r\nimport TileState from 'ol/TileState.js'\r\nimport { useRouter } from 'vue-router'\r\n\r\n\r\nimport 'ol-ext/dist/ol-ext.css'\r\n\r\nexport default {\r\n    props: {\r\n        onClose: {\r\n            type: Function,\r\n            default: () => {}\r\n        },\r\n        mapLayers: {\r\n            type: Array,\r\n            default: []\r\n        },\r\n        currentLayers: {\r\n            type: Array,\r\n            default: []\r\n        },\r\n        tribeIdList: {\r\n            type: Object,\r\n            default: () => {}\r\n        }\r\n    },\r\n    setup(props, { emit }) {\r\n        const mapLayers = mapLayerList\r\n        const router = useRouter()\r\n        const state = reactive({\r\n            DropDown: null,\r\n            TilesListValue: 0\r\n        })\r\n\r\n        function onMapControl(action, value) {\r\n            emit('onMapControl', { action, value })\r\n        }\r\n\r\n        function onLayerControl(action, value) {\r\n            emit('onLayerControl', { action, value })\r\n        }\r\n        function openLayerList(value) {\r\n            if (state.DropDown !== value) {\r\n                state.DropDown = value\r\n            } else {\r\n                state.DropDown = null\r\n            }\r\n            console.log(state.DropDown)\r\n        }\r\n        function LayerCheckBoxChange(e, item) {\r\n            if (item.subNode.single_tiles || !(isNaN(item.nestedSubNodeIndex))) {\r\n                let defaultChecked = e.target.checked || ((typeof e.target.checked == 'undefined') ? true : false )\r\n                // itemId有問題\r\n                onLayerControl('layerMode', {\r\n                    checked: defaultChecked,\r\n                    nodeIndex: item.nodeIndex,\r\n                    subNodeIndex: item.subNodeIndex,\r\n                    nestedSubNodeIndex: String(item.nestedSubNodeIndex) ? item.nestedSubNodeIndex : undefined,\r\n                    id: item.id\r\n                })\r\n            } else {\r\n                console.log('還有子選項')\r\n            }\r\n        }\r\n\r\n        function checkTribe(e) {\r\n            let defaultChecked = e.target.checked || ((typeof e.target.checked == 'undefined') ? true : false )\r\n            onLayerControl('layerMode', {\r\n                checked: defaultChecked,\r\n                // needfix: 進入layerMode的新增圖層需要重構\r\n                type: 'tribe',\r\n                // tribeId: e.target.value\r\n            })\r\n        }\r\n\r\n        return {\r\n            props,\r\n            state,\r\n            router,\r\n            mapLayers,\r\n            onMapControl,\r\n            onLayerControl,\r\n            openLayerList,\r\n            LayerCheckBoxChange,\r\n            checkTribe\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<template>\r\n    <div class=\"rounded-4 bg-white\">\r\n        <div class=\"row mx-0 align-items-center flex-nowrap text-center p-2 fw-bold border-bottom\">\r\n            <p class=\"mb-0 fs-5\">圖層選項</p>\r\n            <a href=\"\" class=\"closeBtn position-absolute col-auto\" @click.prevent=\"props.onClose\">\r\n                <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\">\r\n                    <path fill=\"currentColor\"\r\n                        d=\"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10s-4.477 10-10 10zm0-11.414L9.172 7.757L7.757 9.172L10.586 12l-2.829 2.828l1.415 1.415L12 13.414l2.828 2.829l1.415-1.415L13.414 12l2.829-2.828l-1.415-1.415L12 10.586z\" />\r\n                </svg>\r\n            </a>\r\n        </div>\r\n        <div class=\"py-3 px-4 content\">\r\n            <div class=\"mb-2 landBoundary\">\r\n                <div @click=\"router.push({ path: '/Map_Demo/detail' })\" class=\"my-3 fw-bold h5 text-primary cursor-pointer\">前往地圖細節</div>\r\n                <div v-for=\"(node, nodeIndex) in props.mapLayers\" class=\"mb-2\">\r\n                    <div class=\"title d-flex align-items-center fw-bold text-black order-1 mb-1 text-decoration-none\"\r\n                        @click=\"openLayerList(nodeIndex)\">\r\n                        <div :class=\"node.groupClass\"></div>\r\n                        <div>{{ node.label }}</div>\r\n                        <svg viewBox=\"0 0 24 24\" :class=\"{ 'openTitle': state.DropDown == nodeIndex }\">\r\n                            <path fill=\"currentColor\" d=\"M8 5v14l11-7z\" />\r\n                        </svg>\r\n                    </div>\r\n                    <div class=\"ms-3 mb-1\" v-for=\"(subNode, subNodeIndex) in node.layers\" v-if=\"state.DropDown == nodeIndex\">\r\n                        <div v-if=\"subNode.single_tiles\">\r\n                            <input type=\"checkbox\"\r\n                            :checked=\"props.currentLayers.some(node=> node.id === subNode.id)\"\r\n                            @change=\"(e) => {\r\n                                LayerCheckBoxChange(e, {\r\n                                    nodeIndex: nodeIndex,\r\n                                    subNode: subNode,\r\n                                    subNodeIndex: subNodeIndex,\r\n                                    nestedSubNodeIndex: '',\r\n                                    id: subNode.id\r\n                                })\r\n                            }\">\r\n                            {{ subNode.title }}\r\n                        </div>\r\n                        <div v-else>\r\n                            <input type=\"checkbox\"\r\n                            :checked=\"props.currentLayers.some(node=> node.id === subNode.id)\"\r\n                            @change=\"(e) => {\r\n                                LayerCheckBoxChange(e, {\r\n                                    nodeIndex: nodeIndex,\r\n                                    subNode: subNode,\r\n                                    subNodeIndex: subNodeIndex,\r\n                                    nestedSubNodeIndex: '',\r\n                                    id: subNode.id\r\n                                })\r\n                            }\">\r\n                            {{ subNode.title }}\r\n                                <select name=\"\" id=\"\" class=\"ms-3\"\r\n                                v-model=\"state.TilesListValue\"\r\n                                @change=\"(e) => {\r\n                                    LayerCheckBoxChange(e, {\r\n                                        nodeIndex: nodeIndex,\r\n                                        subNode: subNode,\r\n                                        subNodeIndex: subNodeIndex,\r\n                                        nestedSubNodeIndex: state.TilesListValue,\r\n                                        id: subNode.id\r\n                                    })\r\n                                }\">\r\n                                    <option :value=\"key\" v-for=\"(item, key) in subNode.tiles_list\">{{ item.title }}</option>\r\n                                </select>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div v-if=\"props.tribeIdList\">\r\n                    <div class=\"title d-flex align-items-center fw-bold text-black order-1 mb-1 text-decoration-none\">\r\n                        <!-- @click=\"openLayerList('tribeIdList')\" -->\r\n                        <input id=\"tribeItem\" type=\"checkbox\"\r\n                        @change=\"(e) => {\r\n                            checkTribe(e)\r\n                        }\">\r\n                        <!-- <div :class=\"node.groupClass\"></div> -->\r\n                        <label for=\"tribeItem\">選擇部落</label>\r\n                        <!-- <svg viewBox=\"0 0 24 24\" :class=\"{ 'openTitle': state.DropDown == 'tribeIdList' }\">\r\n                            <path fill=\"currentColor\" d=\"M8 5v14l11-7z\" />\r\n                        </svg> -->\r\n                    </div>\r\n                    <!-- v-if=\"state.DropDown == nodeIndex\" -->\r\n                    <!-- <div v-for=\"item in Object.entries(props.tribeIdList)\">\r\n                        <input type=\"checkbox\"\r\n                        :value=\"item[0]\"\r\n                        @change=\"(e) => {\r\n                            checkTribe(e)\r\n                        }\">\r\n                        {{ item[1] }}\r\n                    </div> -->\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<style lang=\"sass\" scoped>\r\n// @import '@/assets/styles/all.module.scss'\r\n.closeBtn\r\n    right:10px\r\n    svg\r\n        width: 20px\r\n        height: 20px\r\n.content\r\n    .title\r\n        cursor: pointer\r\n        svg\r\n            transform: rotateZ(0)\r\n        .openTitle\r\n            transform: rotateZ(90deg)\r\n    svg\r\n        width: 20px\r\n        height: 20px\r\n    img\r\n        width: 16px\r\n        height: 16px\r\n    .wrap\r\n        display: none\r\n</style>","export default \"__VITE_ASSET__a8c0f6d0__\"","export default \"__VITE_ASSET__630fe15b__\"","export default \"__VITE_ASSET__7e8d4017__\"","export default \"__VITE_ASSET__0ebcb08a__\"","export default \"__VITE_ASSET__185ae262__\"","<script>\r\nimport { useSlots, onBeforeMount, onMounted, onBeforeUnmount, ref, reactive, computed, watch, nextTick, defineAsyncComponent, useCssModule, inject } from 'vue'\r\nexport default {\r\n    props: {\r\n        id:{\r\n            Type: String,\r\n            default: 0\r\n        },\r\n        map:{}\r\n    },\r\n    setup(props, { emit }){\r\n\r\n        function onMapControl(action) {\r\n            emit('onMapControl', {action})\r\n        }\r\n\r\n        return {\r\n            onMapControl\r\n        }\r\n    }\r\n}\r\n\r\n</script>\r\n\r\n<template>\r\n    <div class=\"d-flex flex-nowrap flex-column\">\r\n        <a href=\"\" class=\"asideTool-btn order-1 mb-0\" @click.prevent=\"onMapControl('In')\">\r\n            <img src=\"@/assets/img/icon/zoomIn.svg\" alt=\"zoomIn\">\r\n        </a>\r\n        <a href=\"\" class=\"asideTool-btn order-1 mb-2\" @click.prevent=\"onMapControl('Out')\">\r\n            <img src=\"@/assets/img/icon/zoomOut.svg\" alt=\"zoomOut\">\r\n        </a>\r\n        <a href=\"\" class=\"asideTool-btn order-1 mb-2\" @click.prevent=\"onMapControl('toNorth')\">\r\n            <img src=\"@/assets/img/icon/compass.svg\" alt=\"compass\">\r\n        </a>\r\n        <a href=\"\" class=\"asideTool-btn order-1 mb-2\" @click.prevent=\"onMapControl('moveTo')\">\r\n            <img src=\"@/assets/img/icon/location.svg\" alt=\"location\">\r\n        </a>\r\n        <a href=\"\" class=\"asideTool-btn order-1 mb-2\" @click.prevent=\"onMapControl('fullScreen')\">\r\n            <img src=\"@/assets/img/icon/zoom.svg\" alt=\"zoom\">\r\n        </a>\r\n    </div>\r\n</template>\r\n\r\n<style lang=\"sass\">\r\n\r\n</style>\r\n","<script>\r\nimport { useSlots, onBeforeMount, onMounted, onBeforeUnmount, ref, reactive, computed, watch, nextTick, defineAsyncComponent, useCssModule, inject, getCurrentInstance } from 'vue'\r\nexport default {\r\n    props: {\r\n        baseMapsOptions: {\r\n            type: Array,\r\n            default: []\r\n        },\r\n        onChangeBaseMaps: {\r\n            type: Function,\r\n            default: ()=>{}\r\n        }\r\n    },\r\n    setup(props, { emit }) {\r\n        const state = reactive({\r\n            selectMap: props.baseMapsOptions[0]\r\n        })\r\n        function onChangeBaseMaps(name){\r\n            let action = 'baseMap'\r\n            let value = {\r\n                checked: true,\r\n                layerName: state.selectMap\r\n            }\r\n            emit('onChangeBaseMaps', { action, value })\r\n        }\r\n        return {\r\n            state,\r\n            props,\r\n            onChangeBaseMaps\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<template>\r\n    <div>\r\n        <select name=\"\" id=\"\" v-model=\"state.selectMap\"\r\n        @change=\"(e) => {\r\n            onChangeBaseMaps()\r\n        }\">\r\n            <option :value=\"node.name\" v-for=\"(node, node_i) in props.baseMapsOptions\">{{ node.label }}</option>\r\n        </select>\r\n    </div>\r\n</template>\r\n\r\n<style lang=\"sass\" scoped>\r\nselect\r\n    border: 0\r\n    box-shadow: 0px 4px 4px #999\r\n    border-radius: 5px\r\n    padding: 8px 20px\r\n    option\r\n        padding: 8px 20px\r\n</style>\r\n","export default \"__VITE_ASSET__4d1de3c5__\"","export default \"__VITE_ASSET__e0369fb4__\"","export default \"__VITE_ASSET__9216d299__\"","export default \"__VITE_ASSET__f20fa25d__\"","export default \"__VITE_ASSET__62f11e0f__\"","<script>\r\nimport { useSlots, onBeforeMount, onMounted, onBeforeUnmount, ref, reactive, computed, watch, nextTick, defineAsyncComponent, useCssModule, inject } from 'vue'\r\nimport $ from 'jquery'\r\n\r\nexport default {\r\n    props: {\r\n        currentLayers: {\r\n            type: Array,\r\n            default: []\r\n        },\r\n        mapCount: {\r\n            type: Number,\r\n            default: 1\r\n        },\r\n        dimensionMapStatus: {\r\n            type: Boolean,\r\n            default: false\r\n        }\r\n    },\r\n    setup(props, { emit }) {\r\n        const state = reactive({\r\n            toolSwitch: {\r\n                threeDimensionalBtn: false,\r\n                layerConditionBtn: false,\r\n                splitWindowBtn: false,\r\n            },\r\n            targetNum: 1,\r\n        })\r\n\r\n        function toolSwitch(target, value) {\r\n            // 其他全部關掉\r\n            Object.keys(state.toolSwitch).forEach(node => {\r\n                if (node === target) {\r\n                    if(state.toolSwitch[target]) {\r\n                        state.toolSwitch[target] = false\r\n                    } else {\r\n                        state.toolSwitch[target] = true\r\n                    }\r\n                } else {\r\n                    state.toolSwitch[node] = false\r\n                }\r\n            })\r\n        }\r\n        function onLayerControl(action, value) {\r\n            if (action === 'changeMapCount') {\r\n                state.toolSwitch['splitWindowBtn'] = false\r\n            }\r\n            emit('onLayerControl', { action, value })\r\n        }\r\n\r\n        function conditionWrap() {\r\n            emit('conditionWrap')\r\n        }\r\n\r\n        function onChangeTarget(value) {\r\n            state.targetNum = value\r\n            emit('onChangeTarget', value)\r\n        }\r\n\r\n        return {\r\n            props,\r\n            state,\r\n            toolSwitch,\r\n            onLayerControl,\r\n            conditionWrap,\r\n            onChangeTarget\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<template>\r\n    <div>\r\n        <ul class=\"list-unstyled d-flex align-items-center flex-nowrap w-full\">\r\n            <li class=\"me-4 position-relative\">\r\n                <div class=\"MapFeatureBtn text-white\">\r\n                    <a href=\"\" v-if=\"props.dimensionMapStatus\"\r\n                    @click.prevent=\"toolSwitch('threeDimensionalBtn'), onLayerControl('changeDimensionMap', '3D')\">\r\n                        <img src=\"@/assets/img/icon/twoDimensional.svg\">\r\n                    </a>\r\n                    <a href=\"\" v-else\r\n                    @click.prevent=\"toolSwitch('threeDimensionalBtn'), onLayerControl('changeDimensionMap', '2D')\">\r\n                        <img src=\"@/assets/img/icon/threeDimensional.svg\">\r\n                    </a>\r\n                </div>\r\n            </li>\r\n            <li class=\"me-4 position-relative\">\r\n                <a href=\"\" class=\"MapFeatureBtn text-white\"\r\n                    @click.prevent=\"toolSwitch('layerConditionBtn'), conditionWrap()\">\r\n                    <img src=\"@/assets/img/icon/baseLayer.svg\" alt=\"\">\r\n                </a>\r\n            </li>\r\n            <li class=\"me-4 position-relative\">\r\n                <a href=\"\" class=\"MapFeatureBtn text-white\" @click.prevent=\"toolSwitch('splitWindowBtn')\">\r\n                    <img src=\"@/assets/img/icon/singleWindow.svg\" alt=\"\" v-if=\"props.mapCount === 1\">\r\n                    <img src=\"@/assets/img/icon/doubleWindows.svg\" alt=\"\" v-if=\"props.mapCount === 2\">\r\n                </a>\r\n                <ul class=\"list-unstyled position-absolute start-0 top-100 p-0\" v-if=\"state.toolSwitch.splitWindowBtn\">\r\n                    <li class=\"mt-2\">\r\n                        <a href=\"\" class=\"text-white MapFeatureBtn\" @click.prevent=\"onLayerControl('changeMapCount', 1)\">\r\n                            <img src=\"@/assets/img/icon/singleWindow.svg\" alt=\"\">\r\n                        </a>\r\n                    </li>\r\n                    <li class=\"mt-2\">\r\n                        <a href=\"\" class=\"text-white MapFeatureBtn\" @click.prevent=\"onLayerControl('changeMapCount', 2)\">\r\n                            <img src=\"@/assets/img/icon/doubleWindows.svg\" alt=\"\">\r\n                        </a>\r\n                    </li>\r\n                </ul>\r\n            </li>\r\n        </ul>\r\n\r\n        <div class=\"switchControl d-flex position-fixed rounded-pill translate-middle-x p-2\" id=\"switchControl\" style=\"z-index: 99;\">\r\n            <div class=\"fs-3 text-white rounded-pill\" :class=\"{ 'active': state.targetNum === 1 }\" @click=\"() => {\r\n                onChangeTarget(1)\r\n            }\">左</div>\r\n            <div class=\"fs-3 text-white rounded-pill\" :class=\"{ 'active': state.targetNum === 2 }\" @click=\"() => {\r\n                onChangeTarget(2)\r\n            }\">右</div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<style lang=\"sass\">\r\n.MapFeatureBtn\r\n    display: block\r\n    border-radius: 10px\r\n    width: 68px\r\n    height: 68px\r\n    box-sizing: border-box\r\n    img\r\n        width: 100%\r\n        height: 100%\r\n        &:hover\r\n            filter: brightness(0.5)\r\n    svg\r\n        font-size: 24px\r\n        width: 100%\r\n        height: 100%\r\n\r\n.switchControl\r\n    top: 10px\r\n    left: 50%\r\n    background: rgba(30, 30, 30, 0.9)\r\n    box-sizing: border-box\r\n    div\r\n        padding:5px 28px\r\n        cursor: pointer\r\n        box-sizing: border-box\r\n    .active\r\n        background: #247BA0\r\n\r\n</style>","/**\n * @module olcs.AutoRenderLoop\n */\n\nclass AutoRenderLoop {\n  /**\n   * @constructor\n   * @param {olcs.OLCesium} ol3d\n   */\n  constructor(ol3d) {\n    this.ol3d = ol3d;\n    this.scene_ = ol3d.getCesiumScene();\n    this.canvas_ = this.scene_.canvas;\n    this._boundNotifyRepaintRequired = this.notifyRepaintRequired.bind(this);\n\n    this.repaintEventNames_ = [\n      'mousemove', 'mousedown', 'mouseup',\n      'touchstart', 'touchend', 'touchmove',\n      'pointerdown', 'pointerup', 'pointermove',\n      'wheel'\n    ];\n\n    this.enable();\n  }\n\n  /**\n   * Enable.\n   */\n  enable() {\n    this.scene_.requestRenderMode = true;\n    this.scene_.maximumRenderTimeChange = 1000;\n    for (const repaintKey of this.repaintEventNames_) {\n      this.canvas_.addEventListener(repaintKey, this._boundNotifyRepaintRequired, false);\n    }\n\n    window.addEventListener('resize', this._boundNotifyRepaintRequired, false);\n\n    // Listen for changes on the layer group\n    this.ol3d.getOlMap().getLayerGroup().on('change', this._boundNotifyRepaintRequired);\n  }\n\n  /**\n   * Disable.\n   */\n  disable() {\n    for (const repaintKey of this.repaintEventNames_) {\n      this.canvas_.removeEventListener(repaintKey, this._boundNotifyRepaintRequired, false);\n    }\n\n    window.removeEventListener('resize', this._boundNotifyRepaintRequired, false);\n\n    this.ol3d.getOlMap().getLayerGroup().un('change', this._boundNotifyRepaintRequired);\n    this.scene_.requestRenderMode = false;\n  }\n\n  /**\n   * Restart render loop.\n   * Force a restart of the render loop.\n   * @api\n   */\n  restartRenderLoop() {\n    this.notifyRepaintRequired();\n  }\n\n  notifyRepaintRequired() {\n    this.scene_.requestRender();\n  }\n}\n\n\nexport default AutoRenderLoop;\n","/**\n * Converts radians to to degrees.\n *\n * @param {number} angleInRadians Angle in radians.\n * @return {number} Angle in degrees.\n */\nexport function toDegrees(angleInRadians) {\n  return angleInRadians * 180 / Math.PI;\n}\n\n\n/**\n * Converts degrees to radians.\n *\n * @param {number} angleInDegrees Angle in degrees.\n * @return {number} Angle in radians.\n */\nexport function toRadians(angleInDegrees) {\n  return angleInDegrees * Math.PI / 180;\n}\n","/**\n * @module olcs.Camera\n */\n\nimport {unByKey as olObservableUnByKey} from 'ol/Observable.js';\nimport {toRadians, toDegrees} from './math.js';\nimport {getTransform} from 'ol/proj.js';\nimport olcsCore, {calcDistanceForResolution, calcResolutionForDistance} from './core.js';\n\nclass Camera {\n  /**\n   * This object takes care of additional 3d-specific properties of the view and\n   * ensures proper synchronization with the underlying raw Cesium.Camera object.\n   * @param {!Cesium.Scene} scene\n   * @param {!ol.Map} map\n   * @api\n   */\n  constructor(scene, map) {\n    /**\n     * @type {!Cesium.Scene}\n     * @private\n     */\n    this.scene_ = scene;\n\n    /**\n     * @type {!Cesium.Camera}\n     * @private\n     */\n    this.cam_ = scene.camera;\n\n    /**\n     * @type {!ol.Map}\n     * @private\n     */\n    this.map_ = map;\n\n    /**\n     * @type {?ol.View}\n     * @private\n     */\n    this.view_ = null;\n\n    /**\n     * @type {?ol.EventsKey}\n     * @private\n     */\n    this.viewListenKey_ = null;\n\n    /**\n     * @type {!ol.TransformFunction}\n     * @private\n     */\n    this.toLonLat_ = Camera.identityProjection;\n\n    /**\n     * @type {!ol.TransformFunction}\n     * @private\n     */\n    this.fromLonLat_ = Camera.identityProjection;\n\n    /**\n     * 0 -- topdown, PI/2 -- the horizon\n     * @type {number}\n     * @private\n     */\n    this.tilt_ = 0;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.distance_ = 0;\n\n    /**\n     * @type {?Cesium.Matrix4}\n     * @private\n     */\n    this.lastCameraViewMatrix_ = null;\n\n    /**\n     * This is used to discard change events on view caused by updateView method.\n     * @type {boolean}\n     * @private\n     */\n    this.viewUpdateInProgress_ = false;\n\n    this.map_.on('change:view', (e) => {\n      this.setView_(this.map_.getView());\n    });\n    this.setView_(this.map_.getView());\n  }\n\n  /**\n   * @param {Array.<number>} input Input coordinate array.\n   * @param {Array.<number>=} opt_output Output array of coordinate values.\n   * @param {number=} opt_dimension Dimension.\n   * @return {Array.<number>} Input coordinate array (same array as input).\n   */\n  static identityProjection(input, opt_output, opt_dimension) {\n    const dim = opt_dimension || input.length;\n    if (opt_output) {\n      for (let i = 0; i < dim; ++i) {\n        opt_output[i] = input[i];\n      }\n    }\n    return input;\n  }\n\n  /**\n   * @param {?ol.View} view New view to use.\n   * @private\n   */\n  setView_(view) {\n    if (this.view_) {\n      olObservableUnByKey(this.viewListenKey_);\n      this.viewListenKey_ = null;\n    }\n\n    this.view_ = view;\n    if (view) {\n      const toLonLat = getTransform(view.getProjection(), 'EPSG:4326');\n      const fromLonLat = getTransform('EPSG:4326', view.getProjection());\n      console.assert(toLonLat && fromLonLat);\n\n      this.toLonLat_ = toLonLat;\n      this.fromLonLat_ = fromLonLat;\n\n      this.viewListenKey_ = view.on('propertychange', e => this.handleViewEvent_(e));\n\n      this.readFromView();\n    } else {\n      this.toLonLat_ = Camera.identityProjection;\n      this.fromLonLat_ = Camera.identityProjection;\n    }\n  }\n\n  /**\n   * @param {?} e\n   * @private\n   */\n  handleViewEvent_(e) {\n    if (!this.viewUpdateInProgress_) {\n      this.readFromView();\n    }\n  }\n\n  /**\n   * @param {number} heading In radians.\n   * @api\n   */\n  setHeading(heading) {\n    if (!this.view_) {\n      return;\n    }\n\n    this.view_.setRotation(heading);\n  }\n\n  /**\n   * @return {number|undefined} Heading in radians.\n   * @api\n   */\n  getHeading() {\n    if (!this.view_) {\n      return undefined;\n    }\n    const rotation = this.view_.getRotation();\n    return rotation || 0;\n  }\n\n  /**\n   * @param {number} tilt In radians.\n   * @api\n   */\n  setTilt(tilt) {\n    this.tilt_ = tilt;\n    this.updateCamera_();\n  }\n\n  /**\n   * @return {number} Tilt in radians.\n   * @api\n   */\n  getTilt() {\n    return this.tilt_;\n  }\n\n  /**\n   * @param {number} distance In meters.\n   * @api\n   */\n  setDistance(distance) {\n    this.distance_ = distance;\n    this.updateCamera_();\n    this.updateView();\n  }\n\n  /**\n   * @return {number} Distance in meters.\n   * @api\n   */\n  getDistance() {\n    return this.distance_;\n  }\n\n  /**\n   * Shortcut for ol.View.setCenter().\n   * @param {!ol.Coordinate} center Same projection as the ol.View.\n   * @api\n   */\n  setCenter(center) {\n    if (!this.view_) {\n      return;\n    }\n    this.view_.setCenter(center);\n  }\n\n  /**\n   * Shortcut for ol.View.getCenter().\n   * @return {ol.Coordinate|undefined} Same projection as the ol.View.\n   * @api\n   */\n  getCenter() {\n    if (!this.view_) {\n      return undefined;\n    }\n    return this.view_.getCenter();\n  }\n\n  /**\n   * Sets the position of the camera.\n   * @param {!ol.Coordinate} position Same projection as the ol.View.\n   * @api\n   */\n  setPosition(position) {\n    if (!this.toLonLat_) {\n      return;\n    }\n    const ll = this.toLonLat_(position);\n    console.assert(ll);\n\n    const carto = new Cesium.Cartographic(\n        toRadians(ll[0]),\n        toRadians(ll[1]),\n        this.getAltitude());\n\n    this.cam_.setView({\n      destination: Cesium.Ellipsoid.WGS84.cartographicToCartesian(carto)\n    });\n    this.updateView();\n  }\n\n  /**\n   * Calculates position under the camera.\n   * @return {!ol.Coordinate|undefined} Same projection as the ol.View.\n   * @api\n   */\n  getPosition() {\n    if (!this.fromLonLat_) {\n      return undefined;\n    }\n    const carto = Cesium.Ellipsoid.WGS84.cartesianToCartographic(this.cam_.position);\n\n    const pos = this.fromLonLat_([\n      toDegrees(carto.longitude),\n      toDegrees(carto.latitude)\n    ]);\n    console.assert(pos);\n    return pos;\n  }\n\n  /**\n   * @param {number} altitude In meters.\n   * @api\n   */\n  setAltitude(altitude) {\n    const carto = Cesium.Ellipsoid.WGS84.cartesianToCartographic(\n        this.cam_.position);\n    carto.height = altitude;\n    this.cam_.position = Cesium.Ellipsoid.WGS84.cartographicToCartesian(carto);\n\n    this.updateView();\n  }\n\n  /**\n   * @return {number} Altitude in meters.\n   * @api\n   */\n  getAltitude() {\n    const carto = Cesium.Ellipsoid.WGS84.cartesianToCartographic(\n        this.cam_.position);\n\n    return carto.height;\n  }\n\n  /**\n   * Updates the state of the underlying Cesium.Camera\n   * according to the current values of the properties.\n   * @private\n   */\n  updateCamera_() {\n    if (!this.view_ || !this.toLonLat_) {\n      return;\n    }\n    const center = this.view_.getCenter();\n    if (!center) {\n      return;\n    }\n    const ll = this.toLonLat_(center);\n    console.assert(ll);\n\n    const carto = new Cesium.Cartographic(toRadians(ll[0]),\n        toRadians(ll[1]));\n    if (this.scene_.globe) {\n      const height = this.scene_.globe.getHeight(carto);\n      carto.height = height || 0;\n    }\n\n    const destination = Cesium.Ellipsoid.WGS84.cartographicToCartesian(carto);\n\n    /** @type {Cesium.optionsOrientation} */\n    const orientation = {\n      pitch: this.tilt_ - Cesium.Math.PI_OVER_TWO,\n      heading: -this.view_.getRotation(),\n      roll: undefined\n    };\n    this.cam_.setView({\n      destination,\n      orientation\n    });\n\n    this.cam_.moveBackward(this.distance_);\n\n    this.checkCameraChange(true);\n  }\n\n  /**\n   * Calculates the values of the properties from the current ol.View state.\n   * @api\n   */\n  readFromView() {\n    if (!this.view_ || !this.toLonLat_) {\n      return;\n    }\n    const center = this.view_.getCenter();\n    if (center === undefined || center === null) {\n      return;\n    }\n    const ll = this.toLonLat_(center);\n    console.assert(ll);\n\n    const resolution = this.view_.getResolution();\n    this.distance_ = this.calcDistanceForResolution(\n        resolution || 0, toRadians(ll[1]));\n\n    this.updateCamera_();\n  }\n\n  /**\n   * Calculates the values of the properties from the current Cesium.Camera state.\n   * Modifies the center, resolution and rotation properties of the view.\n   * @api\n   */\n  updateView() {\n    if (!this.view_ || !this.fromLonLat_) {\n      return;\n    }\n    this.viewUpdateInProgress_ = true;\n\n    // target & distance\n    const ellipsoid = Cesium.Ellipsoid.WGS84;\n    const scene = this.scene_;\n    const target = olcsCore.pickCenterPoint(scene);\n\n    let bestTarget = target;\n    if (!bestTarget) {\n      //TODO: how to handle this properly ?\n      const globe = scene.globe;\n      const carto = this.cam_.positionCartographic.clone();\n      const height = globe.getHeight(carto);\n      carto.height = height || 0;\n      bestTarget = Cesium.Ellipsoid.WGS84.cartographicToCartesian(carto);\n    }\n    this.distance_ = Cesium.Cartesian3.distance(bestTarget, this.cam_.position);\n    const bestTargetCartographic = ellipsoid.cartesianToCartographic(bestTarget);\n    this.view_.setCenter(this.fromLonLat_([\n      toDegrees(bestTargetCartographic.longitude),\n      toDegrees(bestTargetCartographic.latitude)]));\n\n    // resolution\n    this.view_.setResolution(\n        this.calcResolutionForDistance(this.distance_,\n            bestTargetCartographic ? bestTargetCartographic.latitude : 0));\n\n\n    /*\n     * Since we are positioning the target, the values of heading and tilt\n     * need to be calculated _at the target_.\n     */\n    if (target) {\n      const pos = this.cam_.position;\n\n      // normal to the ellipsoid at the target\n      const targetNormal = new Cesium.Cartesian3();\n      ellipsoid.geocentricSurfaceNormal(target, targetNormal);\n\n      // vector from the target to the camera\n      const targetToCamera = new Cesium.Cartesian3();\n      Cesium.Cartesian3.subtract(pos, target, targetToCamera);\n      Cesium.Cartesian3.normalize(targetToCamera, targetToCamera);\n\n\n      // HEADING\n      const up = this.cam_.up;\n      const right = this.cam_.right;\n      const normal = new Cesium.Cartesian3(-target.y, target.x, 0); // what is it?\n      const heading = Cesium.Cartesian3.angleBetween(right, normal);\n      const cross = Cesium.Cartesian3.cross(target, up, new Cesium.Cartesian3());\n      const orientation = cross.z;\n\n      this.view_.setRotation((orientation < 0 ? heading : -heading));\n\n      // TILT\n      const tiltAngle = Math.acos(\n          Cesium.Cartesian3.dot(targetNormal, targetToCamera));\n      this.tilt_ = isNaN(tiltAngle) ? 0 : tiltAngle;\n    } else {\n      // fallback when there is no target\n      this.view_.setRotation(this.cam_.heading);\n      this.tilt_ = -this.cam_.pitch + Math.PI / 2;\n    }\n\n    this.viewUpdateInProgress_ = false;\n  }\n\n  /**\n   * Check if the underlying camera state has changed and ensure synchronization.\n   * @param {boolean=} opt_dontSync Do not synchronize the view.\n   */\n  checkCameraChange(opt_dontSync) {\n    const old = this.lastCameraViewMatrix_;\n    const current = this.cam_.viewMatrix;\n\n    if (!old || !Cesium.Matrix4.equalsEpsilon(old, current, 1e-5)) {\n      this.lastCameraViewMatrix_ = current.clone();\n      if (opt_dontSync !== true) {\n        this.updateView();\n      }\n    }\n  }\n\n  /**\n   * calculate the distance between camera and centerpoint based on the resolution and latitude value\n   * @param {number} resolution Number of map units per pixel.\n   * @param {number} latitude Latitude in radians.\n   * @return {number} The calculated distance.\n   * @api\n   */\n  calcDistanceForResolution(resolution, latitude) {\n    return calcDistanceForResolution(resolution, latitude, this.scene_, this.view_.getProjection());\n  }\n\n  /**\n   * calculate the resolution based on a distance(camera to position) and latitude value\n   * @param {number} distance\n   * @param {number} latitude\n   * @return {number} The calculated resolution.\n   * @api\n   */\n  calcResolutionForDistance(distance, latitude) {\n    return calcResolutionForDistance(distance, latitude, this.scene_, this.view_.getProjection());\n  }\n}\n\n\nexport default Camera;\n","/**\n * @module olcs.AbstractSynchronizer\n */\nimport {unByKey as olObservableUnByKey} from 'ol/Observable.js';\nimport olLayerGroup from 'ol/layer/Group.js';\nimport {olcsListen, getUid} from './util.js';\n\n\nclass AbstractSynchronizer {\n  /**\n   * @param {!ol.Map} map\n   * @param {!Cesium.Scene} scene\n   * @template T\n   * @abstract\n   * @api\n   */\n  constructor(map, scene) {\n    /**\n     * @type {!ol.Map}\n     * @protected\n     */\n    this.map = map;\n\n    /**\n     * @type {ol.View}\n     * @protected\n     */\n    this.view = map.getView();\n\n    /**\n     * @type {!Cesium.Scene}\n     * @protected\n     */\n    this.scene = scene;\n\n    /**\n     * @type {ol.Collection.<ol.layer.Base>}\n     * @protected\n     */\n    this.olLayers = map.getLayerGroup().getLayers();\n\n    /**\n     * @type {ol.layer.Group}\n     */\n    this.mapLayerGroup = map.getLayerGroup();\n\n    /**\n     * Map of OpenLayers layer ids (from getUid) to the Cesium ImageryLayers.\n     * Null value means, that we are unable to create equivalent layers.\n     * @type {Object.<string, ?Array.<T>>}\n     * @protected\n     */\n    this.layerMap = {};\n\n    /**\n     * Map of listen keys for OpenLayers layer layers ids (from getUid).\n     * @type {!Object.<string, Array<ol.EventsKey>>}\n     * @protected\n     */\n    this.olLayerListenKeys = {};\n\n    /**\n     * Map of listen keys for OpenLayers layer groups ids (from getUid).\n     * @type {!Object.<string, !Array.<ol.EventsKey>>}\n     * @private\n     */\n    this.olGroupListenKeys_ = {};\n  }\n\n  /**\n   * Destroy all and perform complete synchronization of the layers.\n   * @api\n   */\n  synchronize() {\n    this.destroyAll();\n    this.addLayers_(this.mapLayerGroup);\n  }\n\n  /**\n   * Order counterparts using the same algorithm as the Openlayers renderer:\n   * z-index then original sequence order.\n   * @protected\n   */\n  orderLayers() {\n    // Ordering logics is handled in subclasses.\n  }\n\n  /**\n   * Add a layer hierarchy.\n   * @param {ol.layer.Base} root\n   * @private\n   */\n  addLayers_(root) {\n    /** @type {Array<import('olsc/core.js').LayerWithParents>} */\n    const fifo = [{\n      layer: root,\n      parents: []\n    }];\n    while (fifo.length > 0) {\n      const olLayerWithParents = fifo.splice(0, 1)[0];\n      const olLayer = olLayerWithParents.layer;\n      const olLayerId = getUid(olLayer).toString();\n      this.olLayerListenKeys[olLayerId] = [];\n      console.assert(!this.layerMap[olLayerId]);\n\n      let cesiumObjects = null;\n      if (olLayer instanceof olLayerGroup) {\n        this.listenForGroupChanges_(olLayer);\n        if (olLayer !== this.mapLayerGroup) {\n          cesiumObjects = this.createSingleLayerCounterparts(olLayerWithParents);\n        }\n        if (!cesiumObjects) {\n          olLayer.getLayers().forEach((l) => {\n            if (l) {\n              const newOlLayerWithParents = {\n                layer: l,\n                parents: olLayer === this.mapLayerGroup ?\n                  [] :\n                  [olLayerWithParents.layer].concat(olLayerWithParents.parents)\n              };\n              fifo.push(newOlLayerWithParents);\n            }\n          });\n        }\n      } else {\n        cesiumObjects = this.createSingleLayerCounterparts(olLayerWithParents);\n        if (!cesiumObjects) {\n          // keep an eye on the layers that once failed to be added (might work when the layer is updated)\n          // for example when a source is set after the layer is added to the map\n          const layerId = olLayerId;\n          const layerWithParents = olLayerWithParents;\n          const onLayerChange = (e) => {\n            const cesiumObjs = this.createSingleLayerCounterparts(layerWithParents);\n            if (cesiumObjs) {\n              // unsubscribe event listener\n              layerWithParents.layer.un('change', onLayerChange);\n              this.addCesiumObjects_(cesiumObjs, layerId, layerWithParents.layer);\n              this.orderLayers();\n            }\n          };\n          this.olLayerListenKeys[olLayerId].push(olcsListen(layerWithParents.layer, 'change', onLayerChange));\n        }\n      }\n      // add Cesium layers\n      if (cesiumObjects) {\n        this.addCesiumObjects_(cesiumObjects, olLayerId, olLayer);\n      }\n    }\n\n    this.orderLayers();\n  }\n\n  /**\n   * Add Cesium objects.\n   * @param {Array.<T>} cesiumObjects\n   * @param {string} layerId\n   * @param {ol.layer.Base} layer\n   * @private\n   */\n  addCesiumObjects_(cesiumObjects, layerId, layer) {\n    this.layerMap[layerId] = cesiumObjects;\n    this.olLayerListenKeys[layerId].push(olcsListen(layer, 'change:zIndex', () => this.orderLayers()));\n    cesiumObjects.forEach((cesiumObject) => {\n      this.addCesiumObject(cesiumObject);\n    });\n  }\n\n  /**\n   * Remove and destroy a single layer.\n   * @param {ol.layer.Layer} layer\n   * @return {boolean} counterpart destroyed\n   * @private\n   */\n  removeAndDestroySingleLayer_(layer) {\n    const uid = getUid(layer).toString();\n    const counterparts = this.layerMap[uid];\n    if (!!counterparts) {\n      counterparts.forEach((counterpart) => {\n        this.removeSingleCesiumObject(counterpart, false);\n        this.destroyCesiumObject(counterpart);\n      });\n      this.olLayerListenKeys[uid].forEach(olObservableUnByKey);\n      delete this.olLayerListenKeys[uid];\n    }\n    delete this.layerMap[uid];\n    return !!counterparts;\n  }\n\n  /**\n   * Unlisten a single layer group.\n   * @param {ol.layer.Group} group\n   * @private\n   */\n  unlistenSingleGroup_(group) {\n    if (group === this.mapLayerGroup) {\n      return;\n    }\n    const uid = getUid(group).toString();\n    const keys = this.olGroupListenKeys_[uid];\n    keys.forEach((key) => {\n      olObservableUnByKey(key);\n    });\n    delete this.olGroupListenKeys_[uid];\n    delete this.layerMap[uid];\n  }\n\n  /**\n   * Remove layer hierarchy.\n   * @param {ol.layer.Base} root\n   * @private\n   */\n  removeLayer_(root) {\n    if (!!root) {\n      const fifo = [root];\n      while (fifo.length > 0) {\n        const olLayer = fifo.splice(0, 1)[0];\n        const done = this.removeAndDestroySingleLayer_(olLayer);\n        if (olLayer instanceof olLayerGroup) {\n          this.unlistenSingleGroup_(olLayer);\n          if (!done) {\n            // No counterpart for the group itself so removing\n            // each of the child layers.\n            olLayer.getLayers().forEach((l) => {\n              fifo.push(l);\n            });\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * Register listeners for single layer group change.\n   * @param {ol.layer.Group} group\n   * @private\n   */\n  listenForGroupChanges_(group) {\n    const uuid = getUid(group).toString();\n\n    console.assert(this.olGroupListenKeys_[uuid] === undefined);\n\n    const listenKeyArray = [];\n    this.olGroupListenKeys_[uuid] = listenKeyArray;\n\n    // only the keys that need to be relistened when collection changes\n    let contentKeys = [];\n    const listenAddRemove = (function() {\n      const collection = group.getLayers();\n      if (collection) {\n        contentKeys = [\n          collection.on('add', (event) => {\n            this.addLayers_(event.element);\n          }),\n          collection.on('remove', (event) => {\n            this.removeLayer_(event.element);\n          })\n        ];\n        listenKeyArray.push(...contentKeys);\n      }\n    }).bind(this);\n\n    listenAddRemove();\n\n    listenKeyArray.push(group.on('change:layers', (e) => {\n      contentKeys.forEach((el) => {\n        const i = listenKeyArray.indexOf(el);\n        if (i >= 0) {\n          listenKeyArray.splice(i, 1);\n        }\n        olObservableUnByKey(el);\n      });\n      listenAddRemove();\n    }));\n  }\n\n  /**\n   * Destroys all the created Cesium objects.\n   * @protected\n   */\n  destroyAll() {\n    this.removeAllCesiumObjects(true); // destroy\n    let objKey;\n    for (objKey in this.olGroupListenKeys_) {\n      const keys = this.olGroupListenKeys_[objKey];\n      keys.forEach(olObservableUnByKey);\n    }\n    for (objKey in this.olLayerListenKeys) {\n      this.olLayerListenKeys[objKey].forEach(olObservableUnByKey);\n    }\n    this.olGroupListenKeys_ = {};\n    this.olLayerListenKeys = {};\n    this.layerMap = {};\n  }\n\n  /**\n   * Adds a single Cesium object to the collection.\n   * @param {!T} object\n   * @abstract\n   * @protected\n   */\n  addCesiumObject(object) {}\n\n  /**\n   * @param {!T} object\n   * @abstract\n   * @protected\n   */\n  destroyCesiumObject(object) {}\n\n  /**\n   * Remove single Cesium object from the collection.\n   * @param {!T} object\n   * @param {boolean} destroy\n   * @abstract\n   * @protected\n   */\n  removeSingleCesiumObject(object, destroy) {}\n\n  /**\n   * Remove all Cesium objects from the collection.\n   * @param {boolean} destroy\n   * @abstract\n   * @protected\n   */\n  removeAllCesiumObjects(destroy) {}\n\n  /**\n   * @param {import('olsc/core.js').LayerWithParents} olLayerWithParents\n   * @return {?Array.<T>}\n   * @abstract\n   * @protected\n   */\n  createSingleLayerCounterparts(olLayerWithParents) {}\n}\n\n\nexport default AbstractSynchronizer;\n","/**\n * @module olcs.RasterSynchronizer\n */\nimport olLayerGroup from 'ol/layer/Group.js';\nimport {getUid, stableSort} from './util.js';\nimport olcsAbstractSynchronizer from './AbstractSynchronizer.js';\nimport olcsCore from './core.js';\n\nclass RasterSynchronizer extends olcsAbstractSynchronizer {\n  /**\n   * This object takes care of one-directional synchronization of\n   * Openlayers raster layers to the given Cesium globe.\n   * @param {!ol.Map} map\n   * @param {!Cesium.Scene} scene\n   * @constructor\n   * @extends {olcsAbstractSynchronizer.<Cesium.ImageryLayer>}\n   * @api\n   */\n  constructor(map, scene) {\n    super(map, scene);\n\n    /**\n     * @type {!Cesium.ImageryLayerCollection}\n     * @private\n     */\n    this.cesiumLayers_ = scene.imageryLayers;\n\n    /**\n     * @type {!Cesium.ImageryLayerCollection}\n     * @private\n     */\n    this.ourLayers_ = new Cesium.ImageryLayerCollection();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  addCesiumObject(object) {\n    this.cesiumLayers_.add(object);\n    this.ourLayers_.add(object);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  destroyCesiumObject(object) {\n    object.destroy();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  removeSingleCesiumObject(object, destroy) {\n    this.cesiumLayers_.remove(object, destroy);\n    this.ourLayers_.remove(object, false);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  removeAllCesiumObjects(destroy) {\n    for (let i = 0; i < this.ourLayers_.length; ++i) {\n      this.cesiumLayers_.remove(this.ourLayers_.get(i), destroy);\n    }\n    this.ourLayers_.removeAll(false);\n  }\n\n  /**\n   * Creates an array of Cesium.ImageryLayer.\n   * May be overriden by child classes to implement custom behavior.\n   * The default implementation handles tiled imageries in EPSG:4326 or\n   * EPSG:3859.\n   * @param {!ol.layer.Base} olLayer\n   * @param {!ol.proj.Projection} viewProj Projection of the view.\n   * @return {?Array.<!Cesium.ImageryLayer>} array or null if not possible\n   * (or supported)\n   * @protected\n   */\n  convertLayerToCesiumImageries(olLayer, viewProj) {\n    const result = olcsCore.tileLayerToImageryLayer(this.map, olLayer, viewProj);\n    return result ? [result] : null;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  createSingleLayerCounterparts(olLayerWithParents) {\n    const olLayer = olLayerWithParents.layer;\n    const uid = getUid(olLayer).toString();\n    const viewProj = this.view.getProjection();\n    console.assert(viewProj);\n    const cesiumObjects = this.convertLayerToCesiumImageries(olLayer, viewProj);\n    if (cesiumObjects) {\n      const listenKeyArray = [];\n      [olLayerWithParents.layer].concat(olLayerWithParents.parents).forEach((olLayerItem) => {\n        listenKeyArray.push(olLayerItem.on(['change:opacity', 'change:visible'], () => {\n          // the compiler does not seem to be able to infer this\n          console.assert(cesiumObjects);\n          for (let i = 0; i < cesiumObjects.length; ++i) {\n            olcsCore.updateCesiumLayerProperties(olLayerWithParents, cesiumObjects[i]);\n          }\n        }));\n      });\n\n      if (olLayer.getStyleFunction) {\n        let previousStyleFunction = olLayer.getStyleFunction();\n        // there is no convenient way to detect a style function change in OL\n        listenKeyArray.push(olLayer.on('change', () => {\n          const currentStyleFunction = olLayer.getStyleFunction();\n          if (previousStyleFunction === currentStyleFunction) {\n            return;\n          }\n          previousStyleFunction = currentStyleFunction;\n          for (let i = 0; i < cesiumObjects.length; ++i) {\n            const csObj = cesiumObjects[i];\n            // clear cache and set new style\n            if (csObj._imageryCache && csObj.imageryProvider.cache_) {\n              csObj._imageryCache = {};\n              csObj.imageryProvider.cache_ = {};\n              csObj.imageryProvider.styleFunction_ = currentStyleFunction;\n            }\n          }\n          this.scene.requestRender();\n        }));\n      }\n\n      for (let i = 0; i < cesiumObjects.length; ++i) {\n        olcsCore.updateCesiumLayerProperties(olLayerWithParents, cesiumObjects[i]);\n      }\n\n      // there is no way to modify Cesium layer extent,\n      // we have to recreate when OpenLayers layer extent changes:\n      listenKeyArray.push(olLayer.on('change:extent', (e) => {\n        for (let i = 0; i < cesiumObjects.length; ++i) {\n          this.cesiumLayers_.remove(cesiumObjects[i], true); // destroy\n          this.ourLayers_.remove(cesiumObjects[i], false);\n        }\n        delete this.layerMap[getUid(olLayer)]; // invalidate the map entry\n        this.synchronize();\n      }));\n\n      listenKeyArray.push(olLayer.on('change', (e) => {\n        // when the source changes, re-add the layer to force update\n        for (let i = 0; i < cesiumObjects.length; ++i) {\n          const position = this.cesiumLayers_.indexOf(cesiumObjects[i]);\n          if (position >= 0) {\n            this.cesiumLayers_.remove(cesiumObjects[i], false);\n            this.cesiumLayers_.add(cesiumObjects[i], position);\n          }\n        }\n      }));\n\n      this.olLayerListenKeys[uid].push(...listenKeyArray);\n    }\n\n    return Array.isArray(cesiumObjects) ? cesiumObjects : null;\n  }\n\n  /**\n   * Order counterparts using the same algorithm as the Openlayers renderer:\n   * z-index then original sequence order.\n   * @override\n   * @protected\n   */\n  orderLayers() {\n    const layers = [];\n    const zIndices = {};\n    const queue = [this.mapLayerGroup];\n\n    while (queue.length > 0) {\n      const olLayer = queue.splice(0, 1)[0];\n      layers.push(olLayer);\n      zIndices[getUid(olLayer)] = olLayer.getZIndex() || 0;\n\n      if (olLayer instanceof olLayerGroup) {\n        const sublayers = olLayer.getLayers();\n        if (sublayers) {\n          // Prepend queue with sublayers in order\n          queue.unshift(...sublayers.getArray());\n        }\n      }\n    }\n\n    stableSort(layers, (layer1, layer2) =>\n      zIndices[getUid(layer1)] - zIndices[getUid(layer2)]\n    );\n\n    layers.forEach((olLayer) => {\n      const olLayerId = getUid(olLayer).toString();\n      const cesiumObjects = this.layerMap[olLayerId];\n      if (cesiumObjects) {\n        cesiumObjects.forEach((cesiumObject) => { this.raiseToTop(cesiumObject); });\n      }\n    });\n  }\n\n  /**\n   * @param {Cesium.ImageryLayer} counterpart\n   */\n  raiseToTop(counterpart) {\n    this.cesiumLayers_.raiseToTop(counterpart);\n  }\n}\n\n\nexport default RasterSynchronizer;\n","/**\n * @module olcs.core.VectorLayerCounterpart\n */\nimport {unByKey as olObservableUnByKey} from 'ol/Observable.js';\n\n\n/**\n * Context for feature conversion.\n * @typedef {Object} OlFeatureToCesiumContext\n * @property {!(import('ol/Projection.js').default|string)} projection\n * @property {!Cesium.PrimitiveCollection} primitives\n * @property {Object<number, Array<!Cesium.Primitive|!Cesium.Billboard>>} featureToCesiumMap\n * @property {!Cesium.BillboardCollection} billboards\n */\n\n\nclass VectorLayerCounterpart {\n  /**\n  * Result of the conversion of an OpenLayers layer to Cesium.\n  * @param {!(ol.proj.Projection|string)} layerProjection\n  * @param {!Cesium.Scene} scene\n  */\n  constructor(layerProjection, scene) {\n    const billboards = new Cesium.BillboardCollection({scene});\n    const primitives = new Cesium.PrimitiveCollection();\n\n    /**\n    * @type {!Array.<ol.EventsKey>}\n    */\n    this.olListenKeys = [];\n\n    this.rootCollection_ = new Cesium.PrimitiveCollection();\n    /**\n    * @type {!OlFeatureToCesiumContext}\n    */\n    this.context = {\n      projection: layerProjection,\n      billboards,\n      featureToCesiumMap: {},\n      primitives\n    };\n\n    this.rootCollection_.add(billboards);\n    this.rootCollection_.add(primitives);\n  }\n\n  /**\n  * Unlisten.\n  */\n  destroy() {\n    this.olListenKeys.forEach(olObservableUnByKey);\n    this.olListenKeys.length = 0;\n  }\n\n  /**\n  * @return {!Cesium.Primitive}\n  */\n  getRootPrimitive() {\n    return this.rootCollection_;\n  }\n}\n\n\nexport default VectorLayerCounterpart;\n","/**\n * @module olcs.FeatureConverter\n */\nimport olGeomGeometry from 'ol/geom/Geometry.js';\nimport olStyleIcon from 'ol/style/Icon.js';\nimport olSourceVector from 'ol/source/Vector.js';\nimport olSourceCluster from 'ol/source/Cluster.js';\nimport {circular as olCreateCircularPolygon} from 'ol/geom/Polygon.js';\nimport {boundingExtent, getCenter} from 'ol/extent.js';\nimport olGeomSimpleGeometry from 'ol/geom/SimpleGeometry.js';\nimport olcsCore from './core.js';\nimport olcsCoreVectorLayerCounterpart from './core/VectorLayerCounterpart.js';\nimport olcsUtil, {getUid, isGroundPolylinePrimitiveSupported} from './util.js';\n\n\n/**\n * @typedef {Object} ModelStyle\n * @property {Cesium.Matrix4} [debugModelMatrix]\n * @property {Cesium.ModelFromGltfOptions} cesiumOptions\n */\n\n\nclass FeatureConverter {\n  /**\n   * Concrete base class for converting from OpenLayers3 vectors to Cesium\n   * primitives.\n   * Extending this class is possible provided that the extending class and\n   * the library are compiled together by the closure compiler.\n   * @param {!Cesium.Scene} scene Cesium scene.\n   * @constructor\n   * @api\n   */\n  constructor(scene) {\n\n    /**\n     * @protected\n     */\n    this.scene = scene;\n\n    /**\n     * Bind once to have a unique function for using as a listener\n     * @type {function(ol.source.Vector.Event)}\n     * @private\n     */\n    this.boundOnRemoveOrClearFeatureListener_ = this.onRemoveOrClearFeature_.bind(this);\n\n    /**\n     * @type {Cesium.Cartesian3}\n     * @private\n     */\n    this.defaultBillboardEyeOffset_ = new Cesium.Cartesian3(0, 0, 10);\n  }\n\n  /**\n   * @param {ol.source.Vector.Event} evt\n   * @private\n   */\n  onRemoveOrClearFeature_(evt) {\n    const source = evt.target;\n    console.assert(source instanceof olSourceVector);\n\n    const cancellers = olcsUtil.obj(source)['olcs_cancellers'];\n    if (cancellers) {\n      const feature = evt.feature;\n      if (feature) {\n        // remove\n        const id = getUid(feature);\n        const canceller = cancellers[id];\n        if (canceller) {\n          canceller();\n          delete cancellers[id];\n        }\n      } else {\n        // clear\n        for (const key in cancellers) {\n          if (cancellers.hasOwnProperty(key)) {\n            cancellers[key]();\n          }\n        }\n        olcsUtil.obj(source)['olcs_cancellers'] = {};\n      }\n    }\n  }\n\n  /**\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature.\n   * @param {!Cesium.Primitive|Cesium.Label|Cesium.Billboard} primitive\n   * @protected\n   */\n  setReferenceForPicking(layer, feature, primitive) {\n    primitive.olLayer = layer;\n    primitive.olFeature = feature;\n  }\n\n  /**\n   * Basics primitive creation using a color attribute.\n   * Note that Cesium has 'interior' and outline geometries.\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature.\n   * @param {!ol.geom.Geometry} olGeometry OpenLayers geometry.\n   * @param {!Cesium.Geometry} geometry\n   * @param {!Cesium.Color} color\n   * @param {number=} opt_lineWidth\n   * @return {Cesium.Primitive}\n   * @protected\n   */\n  createColoredPrimitive(layer, feature, olGeometry, geometry, color, opt_lineWidth) {\n    const createInstance = function(geometry, color) {\n      const instance = new Cesium.GeometryInstance({\n        // always update Cesium externs before adding a property\n        geometry\n      });\n      if (color && !(color instanceof Cesium.ImageMaterialProperty)) {\n        instance.attributes = {\n          color: Cesium.ColorGeometryInstanceAttribute.fromColor(color)\n        };\n      }\n      return instance;\n    };\n\n    const options = {\n      // always update Cesium externs before adding a property\n      flat: true, // work with all geometries\n      renderState: {\n        depthTest: {\n          enabled: true\n        }\n      }\n    };\n\n    if (opt_lineWidth !== undefined) {\n      if (!options.renderState) {\n        options.renderState = {};\n      }\n      options.renderState.lineWidth = opt_lineWidth;\n    }\n\n    const instances = createInstance(geometry, color);\n\n    const heightReference = this.getHeightReference(layer, feature, olGeometry);\n\n    let primitive;\n\n    if (heightReference === Cesium.HeightReference.CLAMP_TO_GROUND) {\n      const ctor = instances.geometry.constructor;\n      if (ctor && !ctor['createShadowVolume']) {\n        return null;\n      }\n      primitive = new Cesium.GroundPrimitive({\n        geometryInstances: instances\n      });\n    } else {\n      primitive = new Cesium.Primitive({\n        geometryInstances: instances\n      });\n    }\n\n    if (color instanceof Cesium.ImageMaterialProperty) {\n      const dataUri = color.image.getValue().toDataURL();\n\n      primitive.appearance = new Cesium.MaterialAppearance({\n        flat: true,\n        renderState: {\n          depthTest: {\n            enabled: true\n          }\n        },\n        material: new Cesium.Material({\n          fabric: {\n            type: 'Image',\n            uniforms: {\n              image: dataUri\n            }\n          }\n        })\n      });\n    } else {\n      primitive.appearance = new Cesium.PerInstanceColorAppearance(options);\n    }\n\n    this.setReferenceForPicking(layer, feature, primitive);\n    return primitive;\n  }\n\n  /**\n   * Return the fill or stroke color from a plain ol style.\n   * @param {!ol.style.Style|ol.style.Text} style\n   * @param {boolean} outline\n   * @return {!Cesium.Color}\n   * @protected\n   */\n  extractColorFromOlStyle(style, outline) {\n    const fillColor = style.getFill() ? style.getFill().getColor() : null;\n    const strokeColor = style.getStroke() ? style.getStroke().getColor() : null;\n\n    let olColor = 'black';\n    if (strokeColor && outline) {\n      olColor = strokeColor;\n    } else if (fillColor) {\n      olColor = fillColor;\n    }\n\n    return olcsCore.convertColorToCesium(olColor);\n  }\n\n  /**\n   * Return the width of stroke from a plain ol style.\n   * @param {!ol.style.Style|ol.style.Text} style\n   * @return {number}\n   * @protected\n   */\n  extractLineWidthFromOlStyle(style) {\n    // Handling of line width WebGL limitations is handled by Cesium.\n    const width = style.getStroke() ? style.getStroke().getWidth() : undefined;\n    return width !== undefined ? width : 1;\n  }\n\n  /**\n   * Create a primitive collection out of two Cesium geometries.\n   * Only the OpenLayers style colors will be used.\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature.\n   * @param {!ol.geom.Geometry} olGeometry OpenLayers geometry.\n   * @param {!Cesium.Geometry} fillGeometry\n   * @param {!Cesium.Geometry} outlineGeometry\n   * @param {!ol.style.Style} olStyle\n   * @return {!Cesium.PrimitiveCollection}\n   * @protected\n   */\n  wrapFillAndOutlineGeometries(layer, feature, olGeometry, fillGeometry, outlineGeometry, olStyle) {\n    const fillColor = this.extractColorFromOlStyle(olStyle, false);\n    const outlineColor = this.extractColorFromOlStyle(olStyle, true);\n\n    const primitives = new Cesium.PrimitiveCollection();\n    if (olStyle.getFill()) {\n      const p1 = this.createColoredPrimitive(layer, feature, olGeometry,\n          fillGeometry, fillColor);\n      console.assert(!!p1);\n      primitives.add(p1);\n    }\n\n    if (olStyle.getStroke() && outlineGeometry) {\n      const width = this.extractLineWidthFromOlStyle(olStyle);\n      const p2 = this.createColoredPrimitive(layer, feature, olGeometry,\n          outlineGeometry, outlineColor, width);\n      if (p2) {\n        // Some outline geometries are not supported by Cesium in clamp to ground\n        // mode. These primitives are skipped.\n        primitives.add(p2);\n      }\n    }\n\n    return primitives;\n  }\n\n  // Geometry converters\n  /**\n   * Create a Cesium primitive if style has a text component.\n   * Eventually return a PrimitiveCollection including current primitive.\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature..\n   * @param {!ol.geom.Geometry} geometry\n   * @param {!ol.style.Style} style\n   * @param {!Cesium.Primitive} primitive current primitive\n   * @return {!Cesium.PrimitiveCollection}\n   * @protected\n   */\n  addTextStyle(layer, feature, geometry, style, primitive) {\n    let primitives;\n    if (!(primitive instanceof Cesium.PrimitiveCollection)) {\n      primitives = new Cesium.PrimitiveCollection();\n      primitives.add(primitive);\n    } else {\n      primitives = primitive;\n    }\n\n    if (!style.getText()) {\n      return primitives;\n    }\n\n    const text = /** @type {!ol.style.Text} */ (style.getText());\n    const label = this.olGeometry4326TextPartToCesium(layer, feature, geometry,\n        text);\n    if (label) {\n      primitives.add(label);\n    }\n    return primitives;\n  }\n\n  /**\n   * Add a billboard to a Cesium.BillboardCollection.\n   * Overriding this wrapper allows manipulating the billboard options.\n   * @param {!Cesium.BillboardCollection} billboards\n   * @param {!Cesium.optionsBillboardCollectionAdd} bbOptions\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature.\n   * @param {!ol.geom.Geometry} geometry\n   * @param {!ol.style.Style} style\n   * @return {!Cesium.Billboard} newly created billboard\n   * @api\n   */\n  csAddBillboard(billboards, bbOptions, layer, feature, geometry, style) {\n    if (!bbOptions.eyeOffset) {\n      bbOptions.eyeOffset = this.defaultBillboardEyeOffset_;\n    }\n    const bb = billboards.add(bbOptions);\n    this.setReferenceForPicking(layer, feature, bb);\n    return bb;\n  }\n\n  /**\n   * Convert an OpenLayers circle geometry to Cesium.\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature..\n   * @param {!ol.geom.Circle} olGeometry OpenLayers circle geometry.\n   * @param {!ol.ProjectionLike} projection\n   * @param {!ol.style.Style} olStyle\n   * @return {!Cesium.PrimitiveCollection} primitives\n   * @api\n   */\n  olCircleGeometryToCesium(layer, feature, olGeometry, projection, olStyle) {\n\n    olGeometry = olcsCore.olGeometryCloneTo4326(olGeometry, projection);\n    console.assert(olGeometry.getType() == 'Circle');\n\n    // ol.Coordinate\n    let center = olGeometry.getCenter();\n    const height = center.length == 3 ? center[2] : 0.0;\n    let point = center.slice();\n    point[0] += olGeometry.getRadius();\n\n    // Cesium\n    center = olcsCore.ol4326CoordinateToCesiumCartesian(center);\n    point = olcsCore.ol4326CoordinateToCesiumCartesian(point);\n\n    // Accurate computation of straight distance\n    const radius = Cesium.Cartesian3.distance(center, point);\n\n    const fillGeometry = new Cesium.CircleGeometry({\n      // always update Cesium externs before adding a property\n      center,\n      radius,\n      height\n    });\n\n    let outlinePrimitive, outlineGeometry;\n    if (this.getHeightReference(layer, feature, olGeometry) === Cesium.HeightReference.CLAMP_TO_GROUND) {\n      const width = this.extractLineWidthFromOlStyle(olStyle);\n      if (width) {\n        const circlePolygon = olCreateCircularPolygon(olGeometry.getCenter(), radius);\n        const positions = olcsCore.ol4326CoordinateArrayToCsCartesians(circlePolygon.getLinearRing(0).getCoordinates());\n        if (!isGroundPolylinePrimitiveSupported(this.scene)) {\n          const color = this.extractColorFromOlStyle(olStyle, true);\n          outlinePrimitive = this.createStackedGroundCorridors(layer, feature, width, color, positions);\n        } else {\n          outlinePrimitive = new Cesium.GroundPolylinePrimitive({\n            geometryInstances: new Cesium.GeometryInstance({\n              geometry: new Cesium.GroundPolylineGeometry({positions, width}),\n            }),\n            appearance: new Cesium.PolylineMaterialAppearance({\n              material: this.olStyleToCesium(feature, olStyle, true),\n            }),\n            classificationType: Cesium.ClassificationType.TERRAIN,\n          });\n          outlinePrimitive.readyPromise.then(() => {\n            this.setReferenceForPicking(layer, feature, outlinePrimitive._primitive);\n          });\n        }\n      }\n    } else {\n      outlineGeometry = new Cesium.CircleOutlineGeometry({\n        // always update Cesium externs before adding a property\n        center,\n        radius,\n        extrudedHeight: height,\n        height\n      });\n    }\n\n    const primitives = this.wrapFillAndOutlineGeometries(\n        layer, feature, olGeometry, fillGeometry, outlineGeometry, olStyle);\n\n    if (outlinePrimitive) {\n      primitives.add(outlinePrimitive);\n    }\n    return this.addTextStyle(layer, feature, olGeometry, olStyle, primitives);\n  }\n\n  /**\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature..\n   * @param {!number} width The width of the line.\n   * @param {!Cesium.Color} color The color of the line.\n   * @param {!Array<Cesium.Cartesian3>|Array<Array<Cesium.Cartesian3>>} positions The vertices of the line(s).\n   * @return {!Cesium.GroundPrimitive} primitive\n   */\n  createStackedGroundCorridors(layer, feature, width, color, positions) {\n    // Convert positions to an Array if it isn't\n    if (!Array.isArray(positions[0])) {\n      positions = [positions];\n    }\n    width = Math.max(3, width); // A <3px width is too small for ground primitives\n    const geometryInstances = [];\n    let previousDistance = 0;\n    // A stack of ground lines with increasing width (in meters) are created.\n    // Only one of these lines is displayed at any time giving a feeling of continuity.\n    // The values for the distance and width factor are more or less arbitrary.\n    // Applications can override this logics by subclassing the FeatureConverter class.\n    for (const distance of [1000, 4000, 16000, 64000, 254000, 1000000, 10000000]) {\n      width *= 2.14;\n      const geometryOptions = {\n        // always update Cesium externs before adding a property\n        width,\n        vertexFormat: Cesium.VertexFormat.POSITION_ONLY\n      };\n      for (const linePositions of positions) {\n        geometryOptions.positions = linePositions;\n        geometryInstances.push(new Cesium.GeometryInstance({\n          geometry: new Cesium.CorridorGeometry(geometryOptions),\n          attributes: {\n            color: Cesium.ColorGeometryInstanceAttribute.fromColor(color),\n            distanceDisplayCondition: new Cesium.DistanceDisplayConditionGeometryInstanceAttribute(previousDistance, distance - 1)\n          }\n        }));\n      }\n      previousDistance = distance;\n    }\n    return new Cesium.GroundPrimitive({\n      // always update Cesium externs before adding a property\n      geometryInstances\n    });\n  }\n\n  /**\n   * Convert an OpenLayers line string geometry to Cesium.\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature..\n   * @param {!ol.geom.LineString} olGeometry OpenLayers line string geometry.\n   * @param {!ol.ProjectionLike} projection\n   * @param {!ol.style.Style} olStyle\n   * @return {!Cesium.PrimitiveCollection} primitives\n   * @api\n   */\n  olLineStringGeometryToCesium(layer, feature, olGeometry, projection, olStyle) {\n\n    olGeometry = olcsCore.olGeometryCloneTo4326(olGeometry, projection);\n    console.assert(olGeometry.getType() == 'LineString');\n\n    const positions = olcsCore.ol4326CoordinateArrayToCsCartesians(olGeometry.getCoordinates());\n    const width = this.extractLineWidthFromOlStyle(olStyle);\n\n    let outlinePrimitive;\n    const heightReference = this.getHeightReference(layer, feature, olGeometry);\n\n    if (heightReference === Cesium.HeightReference.CLAMP_TO_GROUND && !isGroundPolylinePrimitiveSupported(this.scene)) {\n      const color = this.extractColorFromOlStyle(olStyle, true);\n      outlinePrimitive = this.createStackedGroundCorridors(layer, feature, width, color, positions);\n    } else {\n      const appearance = new Cesium.PolylineMaterialAppearance({\n        // always update Cesium externs before adding a property\n        material: this.olStyleToCesium(feature, olStyle, true)\n      });\n      const geometryOptions = {\n        // always update Cesium externs before adding a property\n        positions,\n        width,\n      };\n      const primitiveOptions = {\n        // always update Cesium externs before adding a property\n        appearance\n      };\n      if (heightReference === Cesium.HeightReference.CLAMP_TO_GROUND) {\n        const geometry = new Cesium.GroundPolylineGeometry(geometryOptions);\n        primitiveOptions.geometryInstances = new Cesium.GeometryInstance({\n          geometry\n        }),\n        outlinePrimitive = new Cesium.GroundPolylinePrimitive(primitiveOptions);\n        outlinePrimitive.readyPromise.then(() => {\n          this.setReferenceForPicking(layer, feature, outlinePrimitive._primitive);\n        });\n      } else {\n        geometryOptions.vertexFormat = appearance.vertexFormat;\n        const geometry = new Cesium.PolylineGeometry(geometryOptions);\n        primitiveOptions.geometryInstances = new Cesium.GeometryInstance({\n          geometry\n        }),\n        outlinePrimitive = new Cesium.Primitive(primitiveOptions);\n      }\n    }\n\n    this.setReferenceForPicking(layer, feature, outlinePrimitive);\n\n    return this.addTextStyle(layer, feature, olGeometry, olStyle, outlinePrimitive);\n  }\n\n  /**\n   * Convert an OpenLayers polygon geometry to Cesium.\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature..\n   * @param {!ol.geom.Polygon} olGeometry OpenLayers polygon geometry.\n   * @param {!ol.ProjectionLike} projection\n   * @param {!ol.style.Style} olStyle\n   * @return {!Cesium.PrimitiveCollection} primitives\n   * @api\n   */\n  olPolygonGeometryToCesium(layer, feature, olGeometry, projection, olStyle) {\n\n    olGeometry = olcsCore.olGeometryCloneTo4326(olGeometry, projection);\n    console.assert(olGeometry.getType() == 'Polygon');\n\n    const heightReference = this.getHeightReference(layer, feature, olGeometry);\n\n    let fillGeometry, outlineGeometry, outlinePrimitive;\n    if ((olGeometry.getCoordinates()[0].length == 5) &&\n        (feature.getGeometry().get('olcs.polygon_kind') === 'rectangle')) {\n      // Create a rectangle according to the longitude and latitude curves\n      const coordinates = olGeometry.getCoordinates()[0];\n      // Extract the West, South, East, North coordinates\n      const extent = boundingExtent(coordinates);\n      const rectangle = Cesium.Rectangle.fromDegrees(extent[0], extent[1],\n          extent[2], extent[3]);\n\n      // Extract the average height of the vertices\n      let maxHeight = 0.0;\n      if (coordinates[0].length == 3) {\n        for (let c = 0; c < coordinates.length; c++) {\n          maxHeight = Math.max(maxHeight, coordinates[c][2]);\n        }\n      }\n\n      // Render the cartographic rectangle\n      fillGeometry = new Cesium.RectangleGeometry({\n        ellipsoid: Cesium.Ellipsoid.WGS84,\n        rectangle,\n        height: maxHeight\n      });\n\n      outlineGeometry = new Cesium.RectangleOutlineGeometry({\n        ellipsoid: Cesium.Ellipsoid.WGS84,\n        rectangle,\n        height: maxHeight\n      });\n    } else {\n      const rings = olGeometry.getLinearRings();\n      // always update Cesium externs before adding a property\n      const hierarchy = {};\n      const polygonHierarchy = hierarchy;\n      console.assert(rings.length > 0);\n\n      for (let i = 0; i < rings.length; ++i) {\n        const olPos = rings[i].getCoordinates();\n        const positions = olcsCore.ol4326CoordinateArrayToCsCartesians(olPos);\n        console.assert(positions && positions.length > 0);\n        if (i == 0) {\n          hierarchy.positions = positions;\n        } else {\n          if (!hierarchy.holes) {\n            hierarchy.holes = [];\n          }\n          hierarchy.holes.push({\n            positions\n          });\n        }\n      }\n\n      fillGeometry = new Cesium.PolygonGeometry({\n        // always update Cesium externs before adding a property\n        polygonHierarchy,\n        perPositionHeight: true\n      });\n\n      // Since Cesium doesn't yet support Polygon outlines on terrain yet (coming soon...?)\n      // we don't create an outline geometry if clamped, but instead do the polyline method\n      // for each ring. Most of this code should be removeable when Cesium adds\n      // support for Polygon outlines on terrain.\n      if (heightReference === Cesium.HeightReference.CLAMP_TO_GROUND) {\n        const width = this.extractLineWidthFromOlStyle(olStyle);\n        if (width > 0) {\n          const positions = [hierarchy.positions];\n          if (hierarchy.holes) {\n            for (let i = 0; i < hierarchy.holes.length; ++i) {\n              positions.push(hierarchy.holes[i].positions);\n            }\n          }\n          if (!isGroundPolylinePrimitiveSupported(this.scene)) {\n            const color = this.extractColorFromOlStyle(olStyle, true);\n            outlinePrimitive = this.createStackedGroundCorridors(layer, feature, width, color, positions);\n          } else {\n            const appearance = new Cesium.PolylineMaterialAppearance({\n              // always update Cesium externs before adding a property\n              material: this.olStyleToCesium(feature, olStyle, true)\n            });\n            const geometryInstances = [];\n            for (const linePositions of positions) {\n              const polylineGeometry = new Cesium.GroundPolylineGeometry({positions: linePositions, width});\n              geometryInstances.push(new Cesium.GeometryInstance({\n                geometry: polylineGeometry\n              }));\n            }\n            const primitiveOptions = {\n              // always update Cesium externs before adding a property\n              appearance,\n              geometryInstances\n            };\n            outlinePrimitive = new Cesium.GroundPolylinePrimitive(primitiveOptions);\n            outlinePrimitive.readyPromise.then(() => {\n              this.setReferenceForPicking(layer, feature, outlinePrimitive._primitive);\n            });\n          }\n        }\n      } else {\n        // Actually do the normal polygon thing. This should end the removable\n        // section of code described above.\n        outlineGeometry = new Cesium.PolygonOutlineGeometry({\n          // always update Cesium externs before adding a property\n          polygonHierarchy: hierarchy,\n          perPositionHeight: true\n        });\n      }\n    }\n\n    const primitives = this.wrapFillAndOutlineGeometries(\n        layer, feature, olGeometry, fillGeometry, outlineGeometry, olStyle);\n\n    if (outlinePrimitive) {\n      primitives.add(outlinePrimitive);\n    }\n\n    return this.addTextStyle(layer, feature, olGeometry, olStyle, primitives);\n  }\n\n  /**\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {ol.Feature} feature OpenLayers feature..\n   * @param {!ol.geom.Geometry} geometry\n   * @return {!Cesium.HeightReference}\n   * @api\n   */\n  getHeightReference(layer, feature, geometry) {\n\n    // Read from the geometry\n    let altitudeMode = geometry.get('altitudeMode');\n\n    // Or from the feature\n    if (altitudeMode === undefined) {\n      altitudeMode = feature.get('altitudeMode');\n    }\n\n    // Or from the layer\n    if (altitudeMode === undefined) {\n      altitudeMode = layer.get('altitudeMode');\n    }\n\n    let heightReference = Cesium.HeightReference.NONE;\n    if (altitudeMode === 'clampToGround') {\n      heightReference = Cesium.HeightReference.CLAMP_TO_GROUND;\n    } else if (altitudeMode === 'relativeToGround') {\n      heightReference = Cesium.HeightReference.RELATIVE_TO_GROUND;\n    }\n\n    return heightReference;\n  }\n\n  /**\n   * Convert a point geometry to a Cesium BillboardCollection.\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature..\n   * @param {!ol.geom.Point} olGeometry OpenLayers point geometry.\n   * @param {!ol.ProjectionLike} projection\n   * @param {!ol.style.Style} style\n   * @param {!ol.style.Image} imageStyle\n   * @param {!Cesium.BillboardCollection} billboards\n   * @param {function(!Cesium.Billboard)=} opt_newBillboardCallback Called when the new billboard is added.\n   * @api\n   */\n  createBillboardFromImage(\n      layer,\n      feature,\n      olGeometry,\n      projection,\n      style,\n      imageStyle,\n      billboards,\n      opt_newBillboardCallback\n  ) {\n\n    if (imageStyle instanceof olStyleIcon) {\n      // make sure the image is scheduled for load\n      imageStyle.load();\n    }\n\n    const image = imageStyle.getImage(1); // get normal density\n    const isImageLoaded = function(image) {\n      return image.src != '' &&\n          image.naturalHeight != 0 &&\n          image.naturalWidth != 0 &&\n          image.complete;\n    };\n    const reallyCreateBillboard = (function() {\n      if (!image) {\n        return;\n      }\n      if (!(image instanceof HTMLCanvasElement ||\n          image instanceof Image ||\n          image instanceof HTMLImageElement)) {\n        return;\n      }\n      const center = olGeometry.getCoordinates();\n      const position = olcsCore.ol4326CoordinateToCesiumCartesian(center);\n      let color;\n      const opacity = imageStyle.getOpacity();\n      if (opacity !== undefined) {\n        color = new Cesium.Color(1.0, 1.0, 1.0, opacity);\n      }\n\n      const scale = imageStyle.getScale();\n      const heightReference = this.getHeightReference(layer, feature, olGeometry);\n\n      const bbOptions = /** @type {Cesium.optionsBillboardCollectionAdd} */ ({\n        // always update Cesium externs before adding a property\n        image,\n        color,\n        scale,\n        heightReference,\n        position\n      });\n\n      // merge in cesium options from openlayers feature\n      Object.assign(bbOptions, feature.get('cesiumOptions'));\n\n      if (imageStyle instanceof olStyleIcon) {\n        const anchor = imageStyle.getAnchor();\n        if (anchor) {\n          bbOptions.pixelOffset = new Cesium.Cartesian2((image.width / 2 - anchor[0]) * scale, (image.height / 2 - anchor[1]) * scale);\n        }\n      }\n\n      const bb = this.csAddBillboard(billboards, bbOptions, layer, feature, olGeometry, style);\n      if (opt_newBillboardCallback) {\n        opt_newBillboardCallback(bb);\n      }\n    }).bind(this);\n\n    if (image instanceof Image && !isImageLoaded(image)) {\n      // Cesium requires the image to be loaded\n      let cancelled = false;\n      const source = layer.getSource();\n      const canceller = function() {\n        cancelled = true;\n      };\n      source.on(['removefeature', 'clear'],\n          this.boundOnRemoveOrClearFeatureListener_);\n      let cancellers = olcsUtil.obj(source)['olcs_cancellers'];\n      if (!cancellers) {\n        cancellers = olcsUtil.obj(source)['olcs_cancellers'] = {};\n      }\n\n      const fuid = getUid(feature);\n      if (cancellers[fuid]) {\n        // When the feature change quickly, a canceller may still be present so\n        // we cancel it here to prevent creation of a billboard.\n        cancellers[fuid]();\n      }\n      cancellers[fuid] = canceller;\n\n      const listener = function() {\n        image.removeEventListener('load', listener);\n        if (!billboards.isDestroyed() && !cancelled) {\n          // Create billboard if the feature is still displayed on the map.\n          reallyCreateBillboard();\n        }\n      };\n\n      image.addEventListener('load', listener);\n    } else {\n      reallyCreateBillboard();\n    }\n  }\n\n  /**\n   * Convert a point geometry to a Cesium BillboardCollection.\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature..\n   * @param {!ol.geom.Point} olGeometry OpenLayers point geometry.\n   * @param {!ol.ProjectionLike} projection\n   * @param {!ol.style.Style} style\n   * @param {!Cesium.BillboardCollection} billboards\n   * @param {function(!Cesium.Billboard)=} opt_newBillboardCallback Called when\n   * the new billboard is added.\n   * @return {Cesium.Primitive} primitives\n   * @api\n   */\n  olPointGeometryToCesium(\n      layer,\n      feature,\n      olGeometry,\n      projection,\n      style,\n      billboards,\n      opt_newBillboardCallback\n  ) {\n    console.assert(olGeometry.getType() == 'Point');\n    olGeometry = olcsCore.olGeometryCloneTo4326(olGeometry, projection);\n\n    let modelPrimitive = null;\n    const imageStyle = style.getImage();\n    if (imageStyle) {\n      const olcsModelFunction = /** @type {function():olcsx.ModelStyle} */ (olGeometry.get('olcs_model') || feature.get('olcs_model'));\n      if (olcsModelFunction) {\n        const olcsModel = olcsModelFunction();\n        const options = /** @type {Cesium.ModelFromGltfOptions} */ (Object.assign({}, {scene: this.scene}, olcsModel.cesiumOptions));\n        const model = Cesium.Model.fromGltf(options);\n        modelPrimitive = new Cesium.PrimitiveCollection();\n        modelPrimitive.add(model);\n        if (olcsModel.debugModelMatrix) {\n          modelPrimitive.add(new Cesium.DebugModelMatrixPrimitive({\n            modelMatrix: olcsModel.debugModelMatrix\n          }));\n        }\n      } else {\n        this.createBillboardFromImage(layer, feature, olGeometry, projection, style, imageStyle, billboards, opt_newBillboardCallback);\n      }\n    }\n\n    if (style.getText()) {\n      return this.addTextStyle(layer, feature, olGeometry, style, modelPrimitive || new Cesium.Primitive());\n    } else {\n      return modelPrimitive;\n    }\n  }\n\n  /**\n   * Convert an OpenLayers multi-something geometry to Cesium.\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature..\n   * @param {!ol.geom.Geometry} geometry OpenLayers geometry.\n   * @param {!ol.ProjectionLike} projection\n   * @param {!ol.style.Style} olStyle\n   * @param {!Cesium.BillboardCollection} billboards\n   * @param {function(!Cesium.Billboard)=} opt_newBillboardCallback Called when\n   * the new billboard is added.\n   * @return {Cesium.Primitive} primitives\n   * @api\n   */\n  olMultiGeometryToCesium(\n      layer,\n      feature,\n      geometry,\n      projection,\n      olStyle,\n      billboards,\n      opt_newBillboardCallback\n  ) {\n    // Do not reproject to 4326 now because it will be done later.\n\n    // FIXME: would be better to combine all child geometries in one primitive\n    // instead we create n primitives for simplicity.\n    const accumulate = function(geometries, functor) {\n      const primitives = new Cesium.PrimitiveCollection();\n      geometries.forEach((geometry) => {\n        primitives.add(functor(layer, feature, geometry, projection, olStyle));\n      });\n      return primitives;\n    };\n\n    let subgeos;\n    switch (geometry.getType()) {\n      case 'MultiPoint':\n        geometry = /** @type {!ol.geom.MultiPoint} */ (geometry);\n        subgeos = geometry.getPoints();\n        if (olStyle.getText()) {\n          const primitives = new Cesium.PrimitiveCollection();\n          subgeos.forEach((geometry) => {\n            console.assert(geometry);\n            const result = this.olPointGeometryToCesium(layer, feature, geometry,\n                projection, olStyle, billboards, opt_newBillboardCallback);\n            if (result) {\n              primitives.add(result);\n            }\n          });\n          return primitives;\n        } else {\n          subgeos.forEach((geometry) => {\n            console.assert(geometry);\n            this.olPointGeometryToCesium(layer, feature, geometry, projection,\n                olStyle, billboards, opt_newBillboardCallback);\n          });\n          return null;\n        }\n      case 'MultiLineString':\n        geometry = /** @type {!ol.geom.MultiLineString} */ (geometry);\n        subgeos = geometry.getLineStrings();\n        return accumulate(subgeos, this.olLineStringGeometryToCesium.bind(this));\n      case 'MultiPolygon':\n        geometry = /** @type {!ol.geom.MultiPolygon} */ (geometry);\n        subgeos = geometry.getPolygons();\n        return accumulate(subgeos, this.olPolygonGeometryToCesium.bind(this));\n      default:\n        console.assert(false, `Unhandled multi geometry type${geometry.getType()}`);\n    }\n  }\n\n  /**\n   * Convert an OpenLayers text style to Cesium.\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature..\n   * @param {!ol.geom.Geometry} geometry\n   * @param {!ol.style.Text} style\n   * @return {Cesium.LabelCollection} Cesium primitive\n   * @api\n   */\n  olGeometry4326TextPartToCesium(layer, feature, geometry, style) {\n    const text = style.getText();\n    if (!text) {\n      return null;\n    }\n\n    const labels = new Cesium.LabelCollection({scene: this.scene});\n    // TODO: export and use the text draw position from OpenLayers .\n    // See src/ol/render/vector.js\n    const extentCenter = getCenter(geometry.getExtent());\n    if (geometry instanceof olGeomSimpleGeometry) {\n      const first = geometry.getFirstCoordinate();\n      extentCenter[2] = first.length == 3 ? first[2] : 0.0;\n    }\n    const options = /** @type {Cesium.optionsLabelCollection} */ ({});\n\n    options.position = olcsCore.ol4326CoordinateToCesiumCartesian(extentCenter);\n\n    options.text = text;\n\n    options.heightReference = this.getHeightReference(layer, feature, geometry);\n\n    const offsetX = style.getOffsetX();\n    const offsetY = style.getOffsetY();\n    if (offsetX != 0 && offsetY != 0) {\n      const offset = new Cesium.Cartesian2(offsetX, offsetY);\n      options.pixelOffset = offset;\n    }\n\n    options.font = style.getFont() || '10px sans-serif'; // OpenLayers default\n\n    let labelStyle = undefined;\n    if (style.getFill()) {\n      options.fillColor = this.extractColorFromOlStyle(style, false);\n      labelStyle = Cesium.LabelStyle.FILL;\n    }\n    if (style.getStroke()) {\n      options.outlineWidth = this.extractLineWidthFromOlStyle(style);\n      options.outlineColor = this.extractColorFromOlStyle(style, true);\n      labelStyle = Cesium.LabelStyle.OUTLINE;\n    }\n    if (style.getFill() && style.getStroke()) {\n      labelStyle = Cesium.LabelStyle.FILL_AND_OUTLINE;\n    }\n    options.style = labelStyle;\n\n    let horizontalOrigin;\n    switch (style.getTextAlign()) {\n      case 'left':\n        horizontalOrigin = Cesium.HorizontalOrigin.LEFT;\n        break;\n      case 'right':\n        horizontalOrigin = Cesium.HorizontalOrigin.RIGHT;\n        break;\n      case 'center':\n      default:\n        horizontalOrigin = Cesium.HorizontalOrigin.CENTER;\n    }\n    options.horizontalOrigin = horizontalOrigin;\n\n    if (style.getTextBaseline()) {\n      let verticalOrigin;\n      switch (style.getTextBaseline()) {\n        case 'top':\n          verticalOrigin = Cesium.VerticalOrigin.TOP;\n          break;\n        case 'middle':\n          verticalOrigin = Cesium.VerticalOrigin.CENTER;\n          break;\n        case 'bottom':\n          verticalOrigin = Cesium.VerticalOrigin.BOTTOM;\n          break;\n        case 'alphabetic':\n          verticalOrigin = Cesium.VerticalOrigin.TOP;\n          break;\n        case 'hanging':\n          verticalOrigin = Cesium.VerticalOrigin.BOTTOM;\n          break;\n        default:\n          console.assert(false, `unhandled baseline ${style.getTextBaseline()}`);\n      }\n      options.verticalOrigin = verticalOrigin;\n    }\n\n\n    const l = labels.add(options);\n    this.setReferenceForPicking(layer, feature, l);\n    return labels;\n  }\n\n  /**\n   * Convert an OpenLayers style to a Cesium Material.\n   * @param {ol.Feature} feature OpenLayers feature..\n   * @param {!ol.style.Style} style\n   * @param {boolean} outline\n   * @return {Cesium.Material}\n   * @api\n   */\n  olStyleToCesium(feature, style, outline) {\n    const fill = style.getFill();\n    const stroke = style.getStroke();\n    if ((outline && !stroke) || (!outline && !fill)) {\n      return null; // FIXME use a default style? Developer error?\n    }\n\n    let color = outline ? stroke.getColor() : fill.getColor();\n    color = olcsCore.convertColorToCesium(color);\n\n    if (outline && stroke.getLineDash()) {\n      return Cesium.Material.fromType('Stripe', {\n        // always update Cesium externs before adding a property\n        horizontal: false,\n        repeat: 500, // TODO how to calculate this?\n        evenColor: color,\n        oddColor: new Cesium.Color(0, 0, 0, 0) // transparent\n      });\n    } else {\n      return Cesium.Material.fromType('Color', {\n        // always update Cesium externs before adding a property\n        color\n      });\n    }\n\n  }\n\n  /**\n   * Compute OpenLayers plain style.\n   * Evaluates style function, blend arrays, get default style.\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature\n   * @param {ol.StyleFunction|undefined} fallbackStyleFunction\n   * @param {number} resolution\n   * @return {Array.<!ol.style.Style>} null if no style is available\n   * @api\n   */\n  computePlainStyle(layer, feature, fallbackStyleFunction, resolution) {\n    /**\n     * @type {ol.FeatureStyleFunction|undefined}\n     */\n    const featureStyleFunction = feature.getStyleFunction();\n\n    /**\n     * @type {ol.style.Style|Array.<ol.style.Style>}\n     */\n    let style = null;\n\n    if (featureStyleFunction) {\n      style = featureStyleFunction(feature, resolution);\n    }\n\n    if (!style && fallbackStyleFunction) {\n      style = fallbackStyleFunction(feature, resolution);\n    }\n\n    if (!style) {\n      // The feature must not be displayed\n      return null;\n    }\n\n    // FIXME combine materials as in cesium-materials-pack?\n    // then this function must return a custom material\n    // More simply, could blend the colors like described in\n    // http://en.wikipedia.org/wiki/Alpha_compositing\n    return Array.isArray(style) ? style : [style];\n  }\n\n  /**\n   * @protected\n   * @param {!ol.Feature} feature\n   * @param {!ol.style.Style} style\n   * @param {!ol.geom.Geometry=} opt_geom Geometry to be converted.\n   * @return {ol.geom.Geometry|undefined}\n   */\n  getGeometryFromFeature(feature, style, opt_geom) {\n    if (opt_geom) {\n      return opt_geom;\n    }\n\n    const geom3d = /** @type {!ol.geom.Geometry} */(feature.get('olcs.3d_geometry'));\n    if (geom3d && geom3d instanceof olGeomGeometry) {\n      return geom3d;\n    }\n\n    if (style) {\n      const geomFuncRes = style.getGeometryFunction()(feature);\n      if (geomFuncRes instanceof olGeomGeometry) {\n        return geomFuncRes;\n      }\n    }\n\n    return feature.getGeometry();\n  }\n\n  /**\n   * Convert one OpenLayers feature up to a collection of Cesium primitives.\n   * @param {ol.layer.Vector|ol.layer.Image} layer\n   * @param {!ol.Feature} feature OpenLayers feature.\n   * @param {!ol.style.Style} style\n   * @param {!import('olcs/core/VectorLayerConterpart.js').OlFeatureToCesiumContext} context\n   * @param {!ol.geom.Geometry=} opt_geom Geometry to be converted.\n   * @return {Cesium.Primitive} primitives\n   * @api\n   */\n  olFeatureToCesium(layer, feature, style, context, opt_geom) {\n    let geom = this.getGeometryFromFeature(feature, style, opt_geom);\n\n    if (!geom) {\n      // OpenLayers features may not have a geometry\n      // See http://geojson.org/geojson-spec.html#feature-objects\n      return null;\n    }\n\n    const proj = context.projection;\n    const newBillboardAddedCallback = function(bb) {\n      const featureBb = context.featureToCesiumMap[getUid(feature)];\n      if (featureBb instanceof Array) {\n        featureBb.push(bb);\n      }\n      else {\n        context.featureToCesiumMap[getUid(feature)] = [bb];\n      }\n    };\n\n    switch (geom.getType()) {\n      case 'GeometryCollection':\n        const primitives = new Cesium.PrimitiveCollection();\n        const collection = /** @type {!ol.geom.GeometryCollection} */ (geom);\n        // TODO: use getGeometriesArray() instead\n        collection.getGeometries().forEach((geom) => {\n          if (geom) {\n            const prims = this.olFeatureToCesium(layer, feature, style, context,\n                geom);\n            if (prims) {\n              primitives.add(prims);\n            }\n          }\n        });\n        return primitives;\n      case 'Point':\n        geom = /** @type {!ol.geom.Point} */ (geom);\n        const bbs = context.billboards;\n        const result = this.olPointGeometryToCesium(layer, feature, geom, proj,\n            style, bbs, newBillboardAddedCallback);\n        if (!result) {\n          // no wrapping primitive\n          return null;\n        } else {\n          return result;\n        }\n      case 'Circle':\n        geom = /** @type {!ol.geom.Circle} */ (geom);\n        return this.olCircleGeometryToCesium(layer, feature, geom, proj,\n            style);\n      case 'LineString':\n        geom = /** @type {!ol.geom.LineString} */ (geom);\n        return this.olLineStringGeometryToCesium(layer, feature, geom, proj,\n            style);\n      case 'Polygon':\n        geom = /** @type {!ol.geom.Polygon} */ (geom);\n        return this.olPolygonGeometryToCesium(layer, feature, geom, proj,\n            style);\n      case 'MultiPoint':\n      case 'MultiLineString':\n      case 'MultiPolygon':\n        const result2 = this.olMultiGeometryToCesium(layer, feature, geom, proj,\n            style, context.billboards, newBillboardAddedCallback);\n        if (!result2) {\n          // no wrapping primitive\n          return null;\n        } else {\n          return result2;\n        }\n      case 'LinearRing':\n        throw new Error('LinearRing should only be part of polygon.');\n      default:\n        throw new Error(`Ol geom type not handled : ${geom.getType()}`);\n    }\n  }\n\n  /**\n   * Convert an OpenLayers vector layer to Cesium primitive collection.\n   * For each feature, the associated primitive will be stored in\n   * `featurePrimitiveMap`.\n   * @param {!(ol.layer.Vector|ol.layer.Image)} olLayer\n   * @param {!ol.View} olView\n   * @param {!Object.<number, !Cesium.Primitive>} featurePrimitiveMap\n   * @return {!olcs.core.VectorLayerCounterpart}\n   * @api\n   */\n  olVectorLayerToCesium(olLayer, olView, featurePrimitiveMap) {\n    const proj = olView.getProjection();\n    const resolution = olView.getResolution();\n\n    if (resolution === undefined || !proj) {\n      console.assert(false, 'View not ready');\n      // an assertion is not enough for closure to assume resolution and proj\n      // are defined\n      throw new Error('View not ready');\n    }\n\n    let source = olLayer.getSource();\n    if (source instanceof olSourceCluster) {\n      source = source.getSource();\n    }\n\n    console.assert(source instanceof olSourceVector);\n    const features = source.getFeatures();\n    const counterpart = new olcsCoreVectorLayerCounterpart(proj, this.scene);\n    const context = counterpart.context;\n    for (let i = 0; i < features.length; ++i) {\n      const feature = features[i];\n      if (!feature) {\n        continue;\n      }\n      /**\n       * @type {ol.StyleFunction|undefined}\n       */\n      const layerStyle = olLayer.getStyleFunction();\n      const styles = this.computePlainStyle(olLayer, feature, layerStyle,\n          resolution);\n      if (!styles || !styles.length) {\n        // only 'render' features with a style\n        continue;\n      }\n\n      /**\n       * @type {Cesium.Primitive|null}\n       */\n      let primitives = null;\n      for (let i = 0; i < styles.length; i++) {\n        const prims = this.olFeatureToCesium(olLayer, feature, styles[i], context);\n        if (prims) {\n          if (!primitives) {\n            primitives = prims;\n          } else if (prims) {\n            let i = 0, prim;\n            while ((prim = prims.get(i))) {\n              primitives.add(prim);\n              i++;\n            }\n          }\n        }\n      }\n      if (!primitives) {\n        continue;\n      }\n      featurePrimitiveMap[getUid(feature)] = primitives;\n      counterpart.getRootPrimitive().add(primitives);\n    }\n\n    return counterpart;\n  }\n\n  /**\n   * Convert an OpenLayers feature to Cesium primitive collection.\n   * @param {!(ol.layer.Vector|ol.layer.Image)} layer\n   * @param {!ol.View} view\n   * @param {!ol.Feature} feature\n   * @param {!import('olcs/core/VectorLayerConterpart.js').OlFeatureToCesiumContext} context\n   * @return {Cesium.Primitive}\n   * @api\n   */\n  convert(layer, view, feature, context) {\n    const proj = view.getProjection();\n    const resolution = view.getResolution();\n\n    if (resolution == undefined || !proj) {\n      return null;\n    }\n\n    /**\n     * @type {ol.StyleFunction|undefined}\n     */\n    const layerStyle = layer.getStyleFunction();\n\n    const styles = this.computePlainStyle(layer, feature, layerStyle, resolution);\n\n    if (!styles || !styles.length) {\n      // only 'render' features with a style\n      return null;\n    }\n\n    context.projection = proj;\n\n    /**\n     * @type {Cesium.Primitive|null}\n     */\n    let primitives = null;\n    for (let i = 0; i < styles.length; i++) {\n      const prims = this.olFeatureToCesium(layer, feature, styles[i], context);\n      if (!primitives) {\n        primitives = prims;\n      } else if (prims) {\n        let i = 0, prim;\n        while ((prim = prims.get(i))) {\n          primitives.add(prim);\n          i++;\n        }\n      }\n    }\n    return primitives;\n  }\n}\n\n\nexport default FeatureConverter;\n","/**\n * @module olcs.VectorSynchronizer\n */\nimport olSourceVector from 'ol/source/Vector.js';\nimport olLayerLayer from 'ol/layer/Layer.js';\nimport olSourceCluster from 'ol/source/Cluster.js';\nimport olLayerImage from 'ol/layer/Image.js';\nimport {olcsListen, getUid} from './util.js';\nimport olLayerVector from 'ol/layer/Vector.js';\nimport olLayerVectorTile from 'ol/layer/VectorTile.js';\nimport olcsAbstractSynchronizer from './AbstractSynchronizer.js';\nimport olcsFeatureConverter from './FeatureConverter.js';\n\nclass VectorSynchronizer extends olcsAbstractSynchronizer {\n  /**\n   * Unidirectionally synchronize OpenLayers vector layers to Cesium.\n   * @param {!ol.Map} map\n   * @param {!Cesium.Scene} scene\n   * @param {olcs.FeatureConverter=} opt_converter\n   * @extends {olcs.AbstractSynchronizer.<olcs.core.VectorLayerCounterpart>}\n   * @api\n   */\n  constructor(map, scene, opt_converter) {\n    super(map, scene);\n\n    /**\n     * @protected\n     */\n    this.converter = opt_converter || new olcsFeatureConverter(scene);\n\n    /**\n     * @private\n     */\n    this.csAllPrimitives_ = new Cesium.PrimitiveCollection();\n    scene.primitives.add(this.csAllPrimitives_);\n    this.csAllPrimitives_.destroyPrimitives = false;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  addCesiumObject(counterpart) {\n    console.assert(counterpart);\n    counterpart.getRootPrimitive()['counterpart'] = counterpart;\n    this.csAllPrimitives_.add(counterpart.getRootPrimitive());\n  }\n\n  /**\n   * @inheritDoc\n   */\n  destroyCesiumObject(object) {\n    object.getRootPrimitive().destroy();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  removeSingleCesiumObject(object, destroy) {\n    object.destroy();\n    this.csAllPrimitives_.destroyPrimitives = destroy;\n    this.csAllPrimitives_.remove(object.getRootPrimitive());\n    this.csAllPrimitives_.destroyPrimitives = false;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  removeAllCesiumObjects(destroy) {\n    this.csAllPrimitives_.destroyPrimitives = destroy;\n    if (destroy) {\n      for (let i = 0; i < this.csAllPrimitives_.length; ++i) {\n        this.csAllPrimitives_.get(i)['counterpart'].destroy();\n      }\n    }\n    this.csAllPrimitives_.removeAll();\n    this.csAllPrimitives_.destroyPrimitives = false;\n  }\n\n  /**\n   * Synchronizes the layer visibility properties\n   * to the given Cesium Primitive.\n   * @param {import('olsc/core.js').LayerWithParents} olLayerWithParents\n   * @param {!Cesium.Primitive} csPrimitive\n   */\n  updateLayerVisibility(olLayerWithParents, csPrimitive) {\n    let visible = true;\n    [olLayerWithParents.layer].concat(olLayerWithParents.parents).forEach((olLayer) => {\n      const layerVisible = olLayer.getVisible();\n      if (layerVisible !== undefined) {\n        visible &= layerVisible;\n      } else {\n        visible = false;\n      }\n    });\n    csPrimitive.show = visible;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  createSingleLayerCounterparts(olLayerWithParents) {\n    const olLayer = olLayerWithParents.layer;\n    if (!(olLayer instanceof olLayerVector) || olLayer instanceof olLayerVectorTile) {\n      return null;\n    }\n    console.assert(olLayer instanceof olLayerLayer);\n\n    let source = olLayer.getSource();\n    if (source instanceof olSourceCluster) {\n      source = source.getSource();\n    }\n\n    if (!source) {\n      return null;\n    }\n\n    console.assert(source instanceof olSourceVector);\n    console.assert(this.view);\n\n    const view = this.view;\n    const featurePrimitiveMap = {};\n    const counterpart = this.converter.olVectorLayerToCesium(olLayer, view,\n        featurePrimitiveMap);\n    const csPrimitives = counterpart.getRootPrimitive();\n    const olListenKeys = counterpart.olListenKeys;\n\n    [olLayerWithParents.layer].concat(olLayerWithParents.parents).forEach((olLayerItem) => {\n      olListenKeys.push(olcsListen(olLayerItem, 'change:visible', () => {\n        this.updateLayerVisibility(olLayerWithParents, csPrimitives);\n      }));\n    });\n    this.updateLayerVisibility(olLayerWithParents, csPrimitives);\n\n    const onAddFeature = (function(feature) {\n      console.assert(\n          (olLayer instanceof olLayerVector) ||\n          (olLayer instanceof olLayerImage)\n      );\n      const context = counterpart.context;\n      const prim = this.converter.convert(olLayer, view, feature, context);\n      if (prim) {\n        featurePrimitiveMap[getUid(feature)] = prim;\n        csPrimitives.add(prim);\n      }\n    }).bind(this);\n\n    const onRemoveFeature = (function(feature) {\n      const id = getUid(feature);\n      const context = counterpart.context;\n      const bbs = context.featureToCesiumMap[id];\n      if (bbs) {\n        delete context.featureToCesiumMap[id];\n        bbs.forEach((bb) => {\n          if (bb instanceof Cesium.Billboard) {\n            context.billboards.remove(bb);\n          }\n        });\n      }\n      const csPrimitive = featurePrimitiveMap[id];\n      delete featurePrimitiveMap[id];\n      if (csPrimitive) {\n        csPrimitives.remove(csPrimitive);\n      }\n    }).bind(this);\n\n    olListenKeys.push(olcsListen(source, 'addfeature', (e) => {\n      console.assert(e.feature);\n      onAddFeature(e.feature);\n    }, this));\n\n    olListenKeys.push(olcsListen(source, 'removefeature', (e) => {\n      console.assert(e.feature);\n      onRemoveFeature(e.feature);\n    }, this));\n\n    olListenKeys.push(olcsListen(source, 'changefeature', (e) => {\n      const feature = e.feature;\n      console.assert(feature);\n      onRemoveFeature(feature);\n      onAddFeature(feature);\n    }, this));\n\n    return counterpart ? [counterpart] : null;\n  }\n}\n\nexport default VectorSynchronizer;\n","/**\n * @module olcs.SynchronizedOverlay\n */\nimport olOverlay from 'ol/Overlay.js';\nimport {transform} from 'ol/proj.js';\nimport {removeNode, removeChildren} from './util.js';\nimport {unByKey as olObservableUnByKey} from 'ol/Observable.js';\n\n\n/**\n * Options for SynchronizedOverlay\n * @typedef {Object} SynchronizedOverlayOptions\n * @property {!Cesium.Scene} scene\n * @property {olOverlay} parent\n * @property {!import('olsc/OverlaySynchronizer.js').default} synchronizer\n */\n\n\nclass SynchronizedOverlay extends olOverlay {\n  /**\n   * @param {olcsx.SynchronizedOverlayOptions} options SynchronizedOverlay Options.\n   * @api\n   */\n  constructor(options) {\n    const parent = options.parent;\n    super(parent.getOptions());\n\n    /**\n     * @private\n     * @type {?Function}\n     */\n    this.scenePostRenderListenerRemover_ = null;\n\n    /**\n     * @private\n     * @type {!Cesium.Scene}\n     */\n    this.scene_ = options.scene;\n\n    /**\n     * @private\n     * @type {!olcs.OverlaySynchronizer}\n     */\n    this.synchronizer_ = options.synchronizer;\n\n    /**\n     * @private\n     * @type {!ol.Overlay}\n     */\n    this.parent_ = parent;\n\n    /**\n     * @private\n     * @type {ol.Coordinate|undefined}\n     */\n    this.positionWGS84_ = undefined;\n\n    /**\n     * @private\n     * @type {MutationObserver}\n     */\n    this.observer_ = new MutationObserver(this.handleElementChanged.bind(this));\n\n    /**\n     * @private\n     * @type {Array.<MutationObserver>}\n     */\n    this.attributeObserver_ = [];\n\n    /**\n     * @private\n     * @type {Array<ol.EventsKey>}\n     */\n    this.listenerKeys_ = [];\n    // synchronize our Overlay with the parent Overlay\n    const setPropertyFromEvent = event => this.setPropertyFromEvent_(event);\n    this.listenerKeys_.push(this.parent_.on('change:position', setPropertyFromEvent));\n    this.listenerKeys_.push(this.parent_.on('change:element', setPropertyFromEvent));\n    this.listenerKeys_.push(this.parent_.on('change:offset', setPropertyFromEvent));\n    this.listenerKeys_.push(this.parent_.on('change:position', setPropertyFromEvent));\n    this.listenerKeys_.push(this.parent_.on('change:positioning', setPropertyFromEvent));\n\n    this.setProperties(this.parent_.getProperties());\n\n    this.handleMapChanged();\n    this.handleElementChanged();\n  }\n\n  /**\n   * @param {Node} target\n   * @private\n   */\n  observeTarget_(target) {\n    if (!this.observer_) {\n      // not ready, skip the event (this occurs on construction)\n      return;\n    }\n    this.observer_.disconnect();\n    this.observer_.observe(target, {\n      attributes: false,\n      childList: true,\n      characterData: true,\n      subtree: true\n    });\n    this.attributeObserver_.forEach((observer) => {\n      observer.disconnect();\n    });\n    this.attributeObserver_.length = 0;\n    for (let i = 0; i < target.childNodes.length; i++) {\n      const node = target.childNodes[i];\n      if (node.nodeType === 1) {\n        const observer = new MutationObserver(this.handleElementChanged.bind(this));\n        observer.observe(node, {\n          attributes: true,\n          subtree: true\n        });\n        this.attributeObserver_.push(observer);\n      }\n    }\n  }\n\n  /**\n   *\n   * @param {ol.Object.Event} event\n   * @private\n   */\n  setPropertyFromEvent_(event) {\n    if (event.target && event.key) {\n      this.set(event.key, event.target.get(event.key));\n    }\n  }\n\n  /**\n   * Get the scene associated with this overlay.\n   * @see ol.Overlay.prototype.getMap\n   * @return {!Cesium.Scene} The scene that the overlay is part of.\n   * @api\n   */\n  getScene() {\n    return this.scene_;\n  }\n\n  /**\n   * @override\n   */\n  handleMapChanged() {\n    if (this.scenePostRenderListenerRemover_) {\n      this.scenePostRenderListenerRemover_();\n      removeNode(this.element);\n    }\n    this.scenePostRenderListenerRemover_ = null;\n    const scene = this.getScene();\n    if (scene) {\n      this.scenePostRenderListenerRemover_ = scene.postRender.addEventListener(this.updatePixelPosition.bind(this));\n      this.updatePixelPosition();\n      const container = this.stopEvent ?\n        this.synchronizer_.getOverlayContainerStopEvent() : this.synchronizer_.getOverlayContainer();\n      if (this.insertFirst) {\n        container.insertBefore(this.element, container.childNodes[0] || null);\n      } else {\n        container.appendChild(this.element);\n      }\n    }\n  }\n\n  /**\n   * @override\n   */\n  handlePositionChanged() {\n    // transform position to WGS84\n    const position = this.getPosition();\n    if (position) {\n      const sourceProjection = this.parent_.getMap().getView().getProjection();\n      this.positionWGS84_ = transform(position, sourceProjection, 'EPSG:4326');\n    } else {\n      this.positionWGS84_ = undefined;\n    }\n    this.updatePixelPosition();\n  }\n\n  /**\n   * @override\n   */\n  handleElementChanged() {\n    function cloneNode(node, parent) {\n      const clone = node.cloneNode();\n      if (node.nodeName === 'CANVAS') {\n        const ctx = clone.getContext('2d');\n        ctx.drawImage(node, 0, 0);\n      }\n      if (parent) {\n        parent.appendChild(clone);\n      }\n      if (node.nodeType != Node.TEXT_NODE) {\n        clone.addEventListener('click', (event) => {\n          node.dispatchEvent(new MouseEvent('click', event));\n          event.stopPropagation();\n        });\n      }\n      const nodes = node.childNodes;\n      for (let i = 0; i < nodes.length; i++) {\n        if (!nodes[i]) {\n          continue;\n        }\n        cloneNode(nodes[i], clone);\n      }\n      return clone;\n    }\n    removeChildren(this.element);\n    const element = this.getElement();\n    if (element) {\n      if (element.parentNode && element.parentNode.childNodes) {\n        for (const node of element.parentNode.childNodes) {\n          const clonedNode = cloneNode(node, null);\n          this.element.appendChild(clonedNode);\n        }\n      }\n    }\n    if (element.parentNode) {\n      // set new Observer\n      this.observeTarget_(element.parentNode);\n    }\n  }\n\n  /**\n   * @override\n   */\n  updatePixelPosition() {\n    const position = this.positionWGS84_;\n    if (!this.scene_ || !position) {\n      this.setVisible(false);\n      return;\n    }\n    let height = 0;\n    if (position.length === 2) {\n      const globeHeight = this.scene_.globe.getHeight(Cesium.Cartographic.fromDegrees(position[0], position[1]));\n      if (globeHeight && this.scene_.globe.tilesLoaded) {\n        position[2] = globeHeight;\n      }\n      if (globeHeight) {\n        height = globeHeight;\n      }\n    } else {\n      height = position[2];\n    }\n    const cartesian = Cesium.Cartesian3.fromDegrees(position[0], position[1], height);\n    const camera = this.scene_.camera;\n    const ellipsoidBoundingSphere = new Cesium.BoundingSphere(new Cesium.Cartesian3(), 6356752);\n    const occluder = new Cesium.Occluder(ellipsoidBoundingSphere, camera.position);\n    // check if overlay position is behind the horizon\n    if (!occluder.isPointVisible(cartesian)) {\n      this.setVisible(false);\n      return;\n    }\n    const cullingVolume = camera.frustum.computeCullingVolume(camera.position, camera.direction, camera.up);\n    // check if overlay position is visible from the camera\n    if (cullingVolume.computeVisibility(new Cesium.BoundingSphere(cartesian)) !== 1) {\n      this.setVisible(false);\n      return;\n    }\n    this.setVisible(true);\n\n    const pixelCartesian = this.scene_.cartesianToCanvasCoordinates(cartesian);\n    const pixel = [pixelCartesian.x, pixelCartesian.y];\n    const mapSize = [this.scene_.canvas.width, this.scene_.canvas.height];\n    this.updateRenderedPosition(pixel, mapSize);\n  }\n\n  /**\n   * Destroys the overlay, removing all its listeners and elements\n   * @api\n   */\n  destroy() {\n    if (this.scenePostRenderListenerRemover_) {\n      this.scenePostRenderListenerRemover_();\n    }\n    if (this.observer_) {\n      this.observer_.disconnect();\n    }\n    olObservableUnByKey(this.listenerKeys_);\n    this.listenerKeys_.splice(0);\n    if (this.element.removeNode) {\n      this.element.removeNode(true);\n    } else {\n      this.element.remove();\n    }\n    this.element = null;\n  }\n}\n\nexport default SynchronizedOverlay;\n","/**\n * @module olcs.OverlaySynchronizer\n */\nimport olcsSynchronizedOverlay from './SynchronizedOverlay.js';\nimport {getUid} from './util.js';\n\nclass OverlaySynchronizer {\n  /**\n  * @param {!ol.Map} map\n  * @param {!Cesium.Scene} scene\n  * @constructor\n  * @template T\n  * @api\n  */\n  constructor(map, scene) {\n    /**\n    * @type {!ol.Map}\n    * @protected\n    */\n    this.map = map;\n\n    /**\n    * @type {ol.Collection.<ol.Overlay>}\n    * @private\n    */\n    this.overlays_ = this.map.getOverlays();\n\n    /**\n    * @type {!Cesium.Scene}\n    * @protected\n    */\n    this.scene = scene;\n\n    /**\n    * @private\n    * @type {!Element}\n    */\n    this.overlayContainerStopEvent_ = document.createElement('DIV');\n    this.overlayContainerStopEvent_.className = 'ol-overlaycontainer-stopevent';\n    const overlayEvents = ['click', 'dblclick', 'mousedown', 'touchstart', 'MSPointerDown', 'pointerdown', 'mousewheel', 'wheel'];\n    overlayEvents.forEach((event) => {\n      this.overlayContainerStopEvent_.addEventListener(event, evt => evt.stopPropagation());\n    });\n    this.scene.canvas.parentElement.appendChild(this.overlayContainerStopEvent_);\n\n    /**\n    * @private\n    * @type {!Element}\n    */\n    this.overlayContainer_ = document.createElement('DIV');\n    this.overlayContainer_.className = 'ol-overlaycontainer';\n    this.scene.canvas.parentElement.appendChild(this.overlayContainer_);\n\n\n    /**\n    * @type {!Object<?,olcs.SynchronizedOverlay>}\n    * @private\n    */\n    this.overlayMap_ = {};\n  }\n\n  /**\n  * Get the element that serves as a container for overlays that don't allow\n  * event propagation. Elements added to this container won't let mousedown and\n  * touchstart events through to the map, so clicks and gestures on an overlay\n  * don't trigger any {@link ol.MapBrowserEvent}.\n  * @return {!Element} The map's overlay container that stops events.\n  */\n  getOverlayContainerStopEvent() {\n    return this.overlayContainerStopEvent_;\n  }\n\n  /**\n  * Get the element that serves as a container for overlays.\n  * @return {!Element} The map's overlay container.\n  */\n  getOverlayContainer() {\n    return this.overlayContainer_;\n  }\n\n  /**\n  * Destroy all and perform complete synchronization of the overlays.\n  * @api\n  */\n  synchronize() {\n    this.destroyAll();\n    this.addOverlays();\n    this.overlays_.on('add', this.addOverlayFromEvent_.bind(this));\n    this.overlays_.on('remove', this.removeOverlayFromEvent_.bind(this));\n  }\n\n  /**\n  * @param {ol.Collection.Event} event\n  * @private\n  */\n  addOverlayFromEvent_(event) {\n    const overlay = /** @type {ol.Overlay} */ (event.element);\n    this.addOverlay(overlay);\n  }\n\n  /**\n  * @api\n  */\n  addOverlays() {\n    this.overlays_.forEach((overlay) => { this.addOverlay(overlay); });\n  }\n\n  /**\n  * @param {ol.Overlay} overlay\n  * @api\n  */\n  addOverlay(overlay) {\n    if (!overlay) {\n      return;\n    }\n    const cesiumOverlay = new olcsSynchronizedOverlay({\n      scene: this.scene,\n      synchronizer: this,\n      parent: overlay\n    });\n\n    const overlayId = getUid(overlay).toString();\n    this.overlayMap_[overlayId] = cesiumOverlay;\n  }\n\n  /**\n  * @param {ol.Collection.Event} event\n  * @private\n  */\n  removeOverlayFromEvent_(event) {\n    const removedOverlay = /** @type {ol.Overlay} */ (event.element);\n    this.removeOverlay(removedOverlay);\n  }\n\n  /**\n  * Removes an overlay from the scene\n  * @param {ol.Overlay} overlay\n  * @api\n  */\n  removeOverlay(overlay) {\n    const overlayId = getUid(overlay).toString();\n    const csOverlay = this.overlayMap_[overlayId];\n    if (csOverlay) {\n      csOverlay.destroy();\n      delete this.overlayMap_[overlayId];\n    }\n  }\n\n  /**\n  * Destroys all the created Cesium objects.\n  * @protected\n  */\n  destroyAll() {\n    Object.keys(this.overlayMap_).forEach((key) => {\n      const overlay = this.overlayMap_[key];\n      overlay.destroy();\n      delete this.overlayMap_[key];\n    });\n  }\n}\n\n\nexport default OverlaySynchronizer;\n","/**\n * @module olcs.OLCesium\n */\nimport olGeomPoint from 'ol/geom/Point.js';\nimport {getTransform} from 'ol/proj.js';\nimport olcsUtil from './util.js';\nimport olcsCore from './core.js';\nimport olcsAutoRenderLoop from './AutoRenderLoop.js';\nimport olcsCamera from './Camera.js';\nimport olcsRasterSynchronizer from './RasterSynchronizer.js';\nimport olcsVectorSynchronizer from './VectorSynchronizer.js';\nimport olcsOverlaySynchronizer from './OverlaySynchronizer.js';\n\n\n/**\n * @typedef {Object} OLCesiumOptions\n * @property {import('ol/Map.js').default} map The OpenLayers map we want to show on a Cesium scene.\n * @property {Element|string} [target] Target element for the Cesium scene.\n * @property {function(!import('ol/Map.js').default, !Cesium.Scene, !Cesium.DataSourceCollection): Array<import('olcs/AbstractSynchronizer.js').default>}\n *      [createSynchronizers] Callback function which will be called by the {@link olcs.OLCesium}\n *      constructor to create custom synchronizers. Receives an `ol.Map` and a `Cesium.Scene` as arguments,\n *      and needs to return an array of {@link import('olcs/AbstractSynchronizer.js').default}.\n * @property {function(): Cesium.JulianDate} [time] Control the current time used by Cesium.\n * @property {boolean} [stopOpenLayersEventsPropagation] Prevent propagation of mouse/touch events to\n *      OpenLayers when Cesium is active.\n * @property {Cesium.SceneOptions} [sceneOptions] Allows the passing of property value to the\n *      `Cesium.Scene`.\n */\n\n\nclass OLCesium {\n  /**\n   * @param {!OLCesiumOptions} options Options.\n   * @constructor\n   * @api\n   */\n  constructor(options) {\n\n    /**\n     * @type {olcs.AutoRenderLoop}\n     * @private\n     */\n    this.autoRenderLoop_ = null;\n\n    /**\n     * @type {!ol.Map}\n     * @private\n     */\n    this.map_ = options.map;\n\n    /**\n     * @type {!function(): Cesium.JulianDate}\n     * @private\n     */\n    this.time_ = options.time || function() {\n      return Cesium.JulianDate.now();\n    };\n\n    /**\n     * No change of the view projection.\n     * @private\n     */\n    this.to4326Transform_ = getTransform(this.map_.getView().getProjection(), 'EPSG:4326');\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.resolutionScale_ = 1.0;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.canvasClientWidth_ = 0.0;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.canvasClientHeight_ = 0.0;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.resolutionScaleChanged_ = true; // force resize\n\n    const fillArea = 'position:absolute;top:0;left:0;width:100%;height:100%;';\n\n    /**\n     * @type {!Element}\n     * @private\n     */\n    this.container_ = document.createElement('DIV');\n    const containerAttribute = document.createAttribute('style');\n    containerAttribute.value = `${fillArea}visibility:hidden;`;\n    this.container_.setAttributeNode(containerAttribute);\n\n    let targetElement = options.target || this.map_.getViewport();\n    if (typeof targetElement === 'string') {\n      targetElement = document.getElementById(targetElement);\n    }\n    targetElement.appendChild(this.container_);\n\n    /**\n     * Whether the Cesium container is placed over the ol map.\n     * a target => side by side mode\n     * no target => over map mode\n     * @type {boolean}\n     * @private\n     */\n    this.isOverMap_ = !options.target;\n\n\n    if (this.isOverMap_ && options.stopOpenLayersEventsPropagation) {\n      const overlayEvents = ['click', 'dblclick', 'mousedown', 'touchstart', 'MSPointerDown', 'pointerdown', 'mousewheel', 'wheel'];\n      for (let i = 0, ii = overlayEvents.length; i < ii; ++i) {\n        this.container_.addEventListener(overlayEvents[i], evt => evt.stopPropagation());\n      }\n    }\n\n\n    /**\n     * @type {!HTMLCanvasElement}\n     * @private\n     */\n    this.canvas_ = /** @type {!HTMLCanvasElement} */ (document.createElement('CANVAS'));\n    const canvasAttribute = document.createAttribute('style');\n    canvasAttribute.value = fillArea;\n    this.canvas_.setAttributeNode(canvasAttribute);\n\n    if (olcsUtil.supportsImageRenderingPixelated()) {\n      // non standard CSS4\n      this.canvas_.style['imageRendering'] = olcsUtil.imageRenderingValue();\n    }\n\n    this.canvas_.oncontextmenu = function() { return false; };\n    this.canvas_.onselectstart = function() { return false; };\n\n    this.container_.appendChild(this.canvas_);\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.enabled_ = false;\n\n    /**\n     * @type {!Array.<ol.interaction.Interaction>}\n     * @private\n     */\n    this.pausedInteractions_ = [];\n\n    /**\n     * @type {?ol.layer.Group}\n     * @private\n     */\n    this.hiddenRootGroup_ = null;\n\n    const sceneOptions = options.sceneOptions !== undefined ? options.sceneOptions :\n      /** @type {Cesium.SceneOptions} */ ({});\n    sceneOptions.canvas = this.canvas_;\n    sceneOptions.scene3DOnly = true;\n\n    /**\n     * @type {!Cesium.Scene}\n     * @private\n     */\n    this.scene_ = new Cesium.Scene(sceneOptions);\n\n    const sscc = this.scene_.screenSpaceCameraController;\n\n    sscc.tiltEventTypes.push({\n      'eventType': Cesium.CameraEventType.LEFT_DRAG,\n      'modifier': Cesium.KeyboardEventModifier.SHIFT\n    });\n\n    sscc.tiltEventTypes.push({\n      'eventType': Cesium.CameraEventType.LEFT_DRAG,\n      'modifier': Cesium.KeyboardEventModifier.ALT\n    });\n\n    sscc.enableLook = false;\n\n    this.scene_.camera.constrainedAxis = Cesium.Cartesian3.UNIT_Z;\n\n    /**\n     * @type {!olcs.Camera}\n     * @private\n     */\n    this.camera_ = new olcsCamera(this.scene_, this.map_);\n\n    /**\n     * @type {!Cesium.Globe}\n     * @private\n     */\n    this.globe_ = new Cesium.Globe(Cesium.Ellipsoid.WGS84);\n    this.globe_.baseColor = Cesium.Color.WHITE;\n    this.scene_.globe = this.globe_;\n    this.scene_.skyAtmosphere = new Cesium.SkyAtmosphere();\n\n    // The first layer of Cesium is special; using a 1x1 transparent image to workaround it.\n    // See https://github.com/AnalyticalGraphicsInc/cesium/issues/1323 for details.\n    const firstImageryProvider = new Cesium.SingleTileImageryProvider({\n      url: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=',\n      rectangle: Cesium.Rectangle.fromDegrees(0, 0, 1, 1) // the Rectangle dimensions are arbitrary\n    });\n    this.globe_.imageryLayers.addImageryProvider(firstImageryProvider, 0);\n\n    this.dataSourceCollection_ = new Cesium.DataSourceCollection();\n    this.dataSourceDisplay_ = new Cesium.DataSourceDisplay({\n      scene: this.scene_,\n      dataSourceCollection: this.dataSourceCollection_\n    });\n\n    const synchronizers = options.createSynchronizers ?\n      options.createSynchronizers(this.map_, this.scene_, this.dataSourceCollection_) : [\n        new olcsRasterSynchronizer(this.map_, this.scene_),\n        new olcsVectorSynchronizer(this.map_, this.scene_),\n        new olcsOverlaySynchronizer(this.map_, this.scene_)\n      ];\n\n    // Assures correct canvas size after initialisation\n    this.handleResize_();\n\n    for (let i = synchronizers.length - 1; i >= 0; --i) {\n      synchronizers[i].synchronize();\n    }\n\n    /**\n     * Time of the last rendered frame, as returned by `performance.now()`.\n     * @type {number}\n     * @private\n     */\n    this.lastFrameTime_ = 0;\n\n    /**\n     * The identifier returned by `requestAnimationFrame`.\n     * @type {number|undefined}\n     * @private\n     */\n    this.renderId_ = undefined;\n\n    /**\n     * Target frame rate for the render loop.\n     * @type {number}\n     * @private\n     */\n    this.targetFrameRate_ = Number.POSITIVE_INFINITY;\n\n    /**\n     * If the Cesium render loop is being blocked.\n     * @type {boolean}\n     * @private\n     */\n    this.blockCesiumRendering_ = false;\n\n    /**\n     * If the warmup routine is active.\n     * @type {boolean}\n     * @private\n     */\n    this.warmingUp_ = false;\n\n    /**\n     * @type {ol.Feature}\n     * @private\n     */\n    this.trackedFeature_ = null;\n\n    /**\n     * @type {Cesium.Entity}\n     * @private\n     */\n    this.trackedEntity_ = null;\n\n    /**\n     * @type {Cesium.EntityView}\n     * @private\n     */\n    this.entityView_ = null;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.needTrackedEntityUpdate_ = false;\n\n    /**\n     * @type {!Cesium.BoundingSphere}\n     */\n    this.boundingSphereScratch_ = new Cesium.BoundingSphere();\n\n    const eventHelper = new Cesium.EventHelper();\n    eventHelper.add(this.scene_.postRender, OLCesium.prototype.updateTrackedEntity_, this);\n\n    // Cesium has a mechanism to prevent the camera to go under the terrain.\n    // Unfortunately, it is only active when all the terrain has been loaded, which:\n    // - does not prevent the camera to sink under terrain anymore;\n    // - introduce a jumping effect once all terrain has been loaded and the position of the camera is finally fixed.\n    // The property below enables a workaround found in the Camptocamp Cesium fork.\n    // See also https://github.com/AnalyticalGraphicsInc/cesium/issues/5999.\n    Cesium.Camera.enableSuspendTerrainAdjustment = false;\n  }\n\n  /**\n   * Render the Cesium scene.\n   * @private\n   */\n  render_() {\n    // if a call to `requestAnimationFrame` is pending, cancel it\n    if (this.renderId_ !== undefined) {\n      cancelAnimationFrame(this.renderId_);\n      this.renderId_ = undefined;\n    }\n\n    // only render if Cesium is enabled/warming and rendering hasn't been blocked\n    if ((this.enabled_ || this.warmingUp_) && !this.blockCesiumRendering_) {\n      this.renderId_ = requestAnimationFrame(this.onAnimationFrame_.bind(this));\n    }\n  }\n\n  /**\n   * Callback for `requestAnimationFrame`.\n   * @param {number} frameTime The frame time, from `performance.now()`.\n   * @private\n   */\n  onAnimationFrame_(frameTime) {\n    this.renderId_ = undefined;\n\n    // check if a frame was rendered within the target frame rate\n    const interval = 1000.0 / this.targetFrameRate_;\n    const delta = frameTime - this.lastFrameTime_;\n    if (delta < interval) {\n      // too soon, don't render yet\n      this.render_();\n      return;\n    }\n\n    // time to render a frame, save the time\n    this.lastFrameTime_ = frameTime;\n\n    const julianDate = this.time_();\n    this.scene_.initializeFrame();\n    this.handleResize_();\n    this.dataSourceDisplay_.update(julianDate);\n\n    // Update tracked entity\n    if (this.entityView_) {\n      const trackedEntity = this.trackedEntity_;\n      const trackedState = this.dataSourceDisplay_.getBoundingSphere(trackedEntity, false, this.boundingSphereScratch_);\n      if (trackedState === Cesium.BoundingSphereState.DONE) {\n        this.boundingSphereScratch_.radius = 1; // a radius of 1 is enough for tracking points\n        this.entityView_.update(julianDate, this.boundingSphereScratch_);\n      }\n    }\n\n    this.scene_.render(julianDate);\n    this.camera_.checkCameraChange();\n\n    // request the next render call after this one completes to ensure the browser doesn't get backed up\n    this.render_();\n  }\n\n  /**\n   * @private\n   */\n  updateTrackedEntity_() {\n    if (!this.needTrackedEntityUpdate_) {\n      return;\n    }\n\n    const trackedEntity = this.trackedEntity_;\n    const scene = this.scene_;\n\n    const state = this.dataSourceDisplay_.getBoundingSphere(trackedEntity, false, this.boundingSphereScratch_);\n    if (state === Cesium.BoundingSphereState.PENDING) {\n      return;\n    }\n\n    scene.screenSpaceCameraController.enableTilt = false;\n\n    const bs = state !== Cesium.BoundingSphereState.FAILED ? this.boundingSphereScratch_ : undefined;\n    if (bs) {\n      bs.radius = 1;\n    }\n    this.entityView_ = new Cesium.EntityView(trackedEntity, scene, scene.mapProjection.ellipsoid);\n    this.entityView_.update(this.time_(), bs);\n    this.needTrackedEntityUpdate_ = false;\n  }\n\n  /**\n   * @private\n   */\n  handleResize_() {\n    let width = this.canvas_.clientWidth;\n    let height = this.canvas_.clientHeight;\n\n    if (width === 0 | height === 0) {\n      // The canvas DOM element is not ready yet.\n      return;\n    }\n\n    if (width === this.canvasClientWidth_ &&\n        height === this.canvasClientHeight_ &&\n        !this.resolutionScaleChanged_) {\n      return;\n    }\n\n    let resolutionScale = this.resolutionScale_;\n    if (!olcsUtil.supportsImageRenderingPixelated()) {\n      resolutionScale *= window.devicePixelRatio || 1.0;\n    }\n    this.resolutionScaleChanged_ = false;\n\n    this.canvasClientWidth_ = width;\n    this.canvasClientHeight_ = height;\n\n    width *= resolutionScale;\n    height *= resolutionScale;\n\n    this.canvas_.width = width;\n    this.canvas_.height = height;\n    this.scene_.camera.frustum.aspectRatio = width / height;\n  }\n\n  /**\n   * @return {!olcs.Camera}\n   * @api\n   */\n  getCamera() {\n    return this.camera_;\n  }\n\n  /**\n   * @return {!ol.Map}\n   * @api\n   */\n  getOlMap() {\n    return this.map_;\n  }\n\n  /**\n   * @return {!ol.View}\n   * @api\n   */\n  getOlView() {\n    const view = this.map_.getView();\n    console.assert(view);\n    return view;\n  }\n\n  /**\n   * @return {!Cesium.Scene}\n   * @api\n   */\n  getCesiumScene() {\n    return this.scene_;\n  }\n\n  /**\n   * @return {!Cesium.DataSourceCollection}\n   * @api\n   */\n  getDataSources() {\n    return this.dataSourceCollection_;\n  }\n\n  /**\n   * @return {!Cesium.DataSourceDisplay}\n   * @api\n   */\n  getDataSourceDisplay() {\n    return this.dataSourceDisplay_;\n  }\n\n  /**\n   * @return {boolean}\n   * @api\n   */\n  getEnabled() {\n    return this.enabled_;\n  }\n\n  /**\n   * Enables/disables the Cesium.\n   * This modifies the visibility style of the container element.\n   * @param {boolean} enable\n   * @api\n   */\n  setEnabled(enable) {\n    if (this.enabled_ === enable) {\n      return;\n    }\n    this.enabled_ = enable;\n\n    // some Cesium operations are operating with canvas.clientWidth,\n    // so we can't remove it from DOM or even make display:none;\n    this.container_.style.visibility = this.enabled_ ? 'visible' : 'hidden';\n    let interactions;\n    if (this.enabled_) {\n      this.throwOnUnitializedMap_();\n      if (this.isOverMap_) {\n        interactions = this.map_.getInteractions();\n        interactions.forEach((el, i, arr) => {\n          this.pausedInteractions_.push(el);\n        });\n        interactions.clear();\n\n        this.map_.addInteraction = interaction => this.pausedInteractions_.push(interaction);\n        this.map_.removeInteraction = interaction =>\n          this.pausedInteractions_ = this.pausedInteractions_.filter(i => i !== interaction);\n\n        const rootGroup = this.map_.getLayerGroup();\n        if (rootGroup.getVisible()) {\n          this.hiddenRootGroup_ = rootGroup;\n          this.hiddenRootGroup_.setVisible(false);\n        }\n\n        this.map_.getOverlayContainer().classList.add('olcs-hideoverlay');\n      }\n\n      this.camera_.readFromView();\n      this.render_();\n    } else {\n      if (this.isOverMap_) {\n        interactions = this.map_.getInteractions();\n        this.pausedInteractions_.forEach((interaction) => {\n          interactions.push(interaction);\n        });\n        this.pausedInteractions_.length = 0;\n\n        this.map_.addInteraction = interaction => this.map_.getInteractions().push(interaction);\n        this.map_.removeInteraction = interaction => this.map_.getInteractions().remove(interaction);\n\n        this.map_.getOverlayContainer().classList.remove('olcs-hideoverlay');\n        if (this.hiddenRootGroup_) {\n          this.hiddenRootGroup_.setVisible(true);\n          this.hiddenRootGroup_ = null;\n        }\n      }\n\n      this.camera_.updateView();\n    }\n  }\n\n  /**\n   * Preload Cesium so that it is ready when transitioning from 2D to 3D.\n   * @param {number} height Target height of the camera\n   * @param {number} timeout Milliseconds after which the warming will stop\n   * @api\n  */\n  warmUp(height, timeout) {\n    if (this.enabled_) {\n      // already enabled\n      return;\n    }\n    this.throwOnUnitializedMap_();\n    this.camera_.readFromView();\n    const ellipsoid = this.globe_.ellipsoid;\n    const csCamera = this.scene_.camera;\n    const position = ellipsoid.cartesianToCartographic(csCamera.position);\n    if (position.height < height) {\n      position.height = height;\n      csCamera.position = ellipsoid.cartographicToCartesian(position);\n    }\n\n    this.warmingUp_ = true;\n    this.render_();\n\n    setTimeout(() => {\n      this.warmingUp_ = false;\n    }, timeout);\n  }\n\n  /**\n   * Block Cesium rendering to save resources.\n   * @param {boolean} block True to block.\n   * @api\n  */\n  setBlockCesiumRendering(block) {\n    if (this.blockCesiumRendering_ !== block) {\n      this.blockCesiumRendering_ = block;\n\n      // reset the render loop\n      this.render_();\n    }\n  }\n\n  /**\n   * Render the globe only when necessary in order to save resources.\n   * Experimental.\n   * @api\n   */\n  enableAutoRenderLoop() {\n    if (!this.autoRenderLoop_) {\n      this.autoRenderLoop_ = new olcsAutoRenderLoop(this);\n    }\n  }\n\n  /**\n   * Get the autorender loop.\n   * @return {?olcs.AutoRenderLoop}\n   * @api\n  */\n  getAutoRenderLoop() {\n    return this.autoRenderLoop_;\n  }\n\n  /**\n   * The 3D Cesium globe is rendered in a canvas with two different dimensions:\n   * clientWidth and clientHeight which are the dimension on the screen and\n   * width and height which are the dimensions of the drawing buffer.\n   *\n   * By using a resolution scale lower than 1.0, it is possible to render the\n   * globe in a buffer smaller than the canvas client dimensions and improve\n   * performance, at the cost of quality.\n   *\n   * Pixel ratio should also be taken into account; by default, a device with\n   * pixel ratio of 2.0 will have a buffer surface 4 times bigger than the client\n   * surface.\n   *\n   * @param {number} value\n   * @this {olcs.OLCesium}\n   * @api\n   */\n  setResolutionScale(value) {\n    value = Math.max(0, value);\n    if (value !== this.resolutionScale_) {\n      this.resolutionScale_ = Math.max(0, value);\n      this.resolutionScaleChanged_ = true;\n      if (this.autoRenderLoop_) {\n        this.autoRenderLoop_.restartRenderLoop();\n      }\n    }\n  }\n\n  /**\n   * Set the target frame rate for the renderer. Set to `Number.POSITIVE_INFINITY`\n   * to render as quickly as possible.\n   * @param {number} value The frame rate, in frames per second.\n   * @api\n   */\n  setTargetFrameRate(value) {\n    if (this.targetFrameRate_ !== value) {\n      this.targetFrameRate_ = value;\n\n      // reset the render loop\n      this.render_();\n    }\n  }\n\n  /**\n   * Check if OpenLayers map is not properly initialized.\n   * @private\n   */\n  throwOnUnitializedMap_() {\n    const map = this.map_;\n    const view = map.getView();\n    const center = view.getCenter();\n    if (!view.isDef() || isNaN(center[0]) || isNaN(center[1])) {\n      throw new Error(`The OpenLayers map is not properly initialized: ${center} / ${view.getResolution()}`);\n    }\n  }\n\n  /**\n   * @type {ol.Feature}\n   */\n  get trackedFeature() {\n    return this.trackedFeature_;\n  }\n\n  /**\n   * @param {ol.Feature} feature\n   */\n  set trackedFeature(feature) {\n    if (this.trackedFeature_ !== feature) {\n\n      const scene = this.scene_;\n\n      //Stop tracking\n      if (!feature || !feature.getGeometry()) {\n        this.needTrackedEntityUpdate_ = false;\n        scene.screenSpaceCameraController.enableTilt = true;\n\n        if (this.trackedEntity_) {\n          this.dataSourceDisplay_.defaultDataSource.entities.remove(this.trackedEntity_);\n        }\n        this.trackedEntity_ = null;\n        this.trackedFeature_ = null;\n        this.entityView_ = null;\n        scene.camera.lookAtTransform(Cesium.Matrix4.IDENTITY);\n        return;\n      }\n\n      this.trackedFeature_ = feature;\n\n      //We can't start tracking immediately, so we set a flag and start tracking\n      //when the bounding sphere is ready (most likely next frame).\n      this.needTrackedEntityUpdate_ = true;\n\n      const to4326Transform = this.to4326Transform_;\n      const toCesiumPosition = function() {\n        const geometry = feature.getGeometry();\n        console.assert(geometry instanceof olGeomPoint);\n        const coo = geometry.getCoordinates();\n        const coo4326 = to4326Transform(coo, undefined, coo.length);\n        return olcsCore.ol4326CoordinateToCesiumCartesian(coo4326);\n      };\n\n      // Create an invisible point entity for tracking.\n      // It is independant from the primitive/geometry created by the vector synchronizer.\n      const options = {\n        'position': new Cesium.CallbackProperty((time, result) => toCesiumPosition(), false),\n        'point': {\n          'pixelSize': 1,\n          'color': Cesium.Color.TRANSPARENT\n        }\n      };\n\n      this.trackedEntity_ = this.dataSourceDisplay_.defaultDataSource.entities.add(options);\n    }\n  }\n}\n\nexport default OLCesium;\n","export default \"__VITE_ASSET__c2b3a5f0__\"","<script>\r\nimport { useSlots, onBeforeMount, onMounted, onBeforeUnmount, ref, reactive, computed, watch, nextTick, defineAsyncComponent, useCssModule, inject, getCurrentInstance } from 'vue'\r\nimport $ from 'jquery'\r\n\r\nimport { Map, View, Feature } from 'ol'\r\nimport { ImageArcGISRest, OSM } from 'ol/source.js'\r\nimport TileWMS from 'ol/source/TileWMS'\r\nimport Overlay from 'ol/Overlay'// 引入覆蓋物模塊\r\n\r\nimport { TileArcGISRest } from 'ol/source.js'\r\n\r\nimport XYZ from 'ol/source/XYZ'\r\nimport VectorSource from 'ol/source/Vector.js'\r\nimport { Icon, Fill, Stroke, Style } from 'ol/style.js'\r\nimport { Tile, Tile as TileLayer, Image as ImageLayer, Vector, Vector as VectorLayer } from 'ol/layer.js'\r\nimport ImageWMS from 'ol/source/ImageWMS.js';\r\nimport TileGrid from 'ol/layer/Tile.js';\r\n\r\nimport PerspectiveMap from \"ol-ext/map/PerspectiveMap\"\r\n\r\nimport EsriJSON from 'ol/format/EsriJSON.js'\r\nimport { createXYZ } from 'ol/tilegrid.js'\r\nimport { tile as tileStrategy } from 'ol/loadingstrategy.js'\r\nimport { Circle, Polygon, Point } from 'ol/geom.js'\r\nimport Projection from 'ol/proj/Projection.js'\r\nimport GeoJSON from 'ol/format/GeoJSON.js'\r\n\r\nimport OLCesium from 'olcs/OLCesium.js';\r\nimport VectorImageLayer from 'ol/layer/VectorImage.js';\r\nimport TileState from 'ol/TileState.js';\r\n\r\nimport 'ol/ol.css'\r\n\r\nimport mapLayerList, { initLayers, tribeIdList, getTribeData } from '@/config/mapLayerList'\r\nimport baseMapList from '@/config/baseMapList'\r\n\r\nimport 'ol-ext/dist/ol-ext.css'\r\n\r\nimport { get as getProjection } from 'ol/proj';\r\nexport default {\r\n    props: {},\r\n    setup(props, { emit }) {\r\n        const mapLayers = mapLayerList\r\n        const baseMaps = baseMapList\r\n        const state = reactive({\r\n            // defaultCenter: [120.971859, 24.801583],\r\n            defaultCenter: [121.326776, 24.655499],\r\n            defaultCenterZoom: 14,\r\n            targetNum: 1,\r\n            conditionWrap: false,\r\n            layerSelect: false,\r\n            currentLayers: [],\r\n            layers: [],\r\n            mapLayers: computed(() => {\r\n                return state.layers.map((node, index) => {\r\n                    return {\r\n                        label: node.group_title,\r\n                        value: node.value,\r\n                        layers: node.group_layers,\r\n                        groupClass: node.group_class\r\n                    }\r\n                })\r\n            }),\r\n            baseMapsOptions: computed(() => baseMapList.sourceData()),\r\n            selectLock: false,\r\n\r\n            mapCount: 1,\r\n            map1: null,\r\n            map2: null,\r\n            map1LayerStatus: [],\r\n            map2LayerStatus: [],\r\n            deleteLightbox: false,\r\n            // 目前地圖狀態為2D or 3D\r\n            dimensionMap: {\r\n                map1: '2D',\r\n                map2: '2D'\r\n            },\r\n            toSearchDimensionStatus: computed(() => {\r\n                let target = state.targetNum == 1 ? 'map1' : 'map2'\r\n                return state.dimensionMap[target] === '2D'\r\n            }),\r\n            areaDataId: '',\r\n            ol3d: null,\r\n        })\r\n\r\n        const defaultView = new View({\r\n            projection: 'EPSG:4326',\r\n            center: state.defaultCenter,\r\n            zoom: state.defaultCenterZoom,\r\n        })\r\n\r\n        const overlay = ref(null)\r\n        const areaCom = ref(null) // 地圖細節小窗\r\n        let ol3d = null\r\n\r\n        // 初始化地圖\r\n        function initMap() {\r\n            overlay.value = new Overlay({\r\n                element: areaCom.value,\r\n                autoPan: true,\r\n                autoPanAnimation: {\r\n                    duration: 250\r\n                }\r\n            })\r\n            state.map1 = new Map({\r\n                target: 'map1',\r\n                layers: [baseMapList.sourceFun('default')],\r\n                view: defaultView,\r\n                controls: [],\r\n                // fix: !!!!有overlays，3D圖層無法使用\r\n                overlays: [overlay.value]\r\n            })\r\n        }\r\n\r\n        function addPoint(targetLng, targetLat) {\r\n            const marker = new Vector({\r\n                source: new VectorSource({\r\n                    features: [\r\n                        new Feature({\r\n                            geometry: new Point([targetLng, targetLat]),\r\n                            name: 'Null Island',\r\n                            population: 4000,\r\n                            rainfall: 500,\r\n                        })\r\n                    ]\r\n                }),\r\n                style: new Style({\r\n                    image: new Icon({\r\n                        anchor: [0.5, 100],\r\n                        anchorXUnits: 'fraction',\r\n                        anchorYUnits: 'pixels',\r\n                        // 圖片連結需修改\r\n                        src: 'https://www.ockert-cnc.de/wp-content/uploads/2016/12/map-marker-icon-100x100.png',\r\n                    }),\r\n                })\r\n            })\r\n\r\n            let target = state.targetNum == 1 ? 'map1' : 'map2'\r\n            state[target].addLayer(marker)\r\n        }\r\n\r\n        function mapControl({ action, value }) {\r\n            let mainMap = state.map1?.getTarget() == null ? 'map2' : 'map1'\r\n            let View = state[mainMap].getView()\r\n            switch (action) {\r\n                case 'In':\r\n                    View.animate({\r\n                        zoom: View.getZoom() + 1,\r\n                    })\r\n                    break;\r\n                case 'Out':\r\n                    View.animate({\r\n                        zoom: View.getZoom() - 1,\r\n                    })\r\n                    break;\r\n                case 'toNorth':\r\n                    View.animate({\r\n                        rotation: 0,\r\n                    })\r\n                    break;\r\n                case 'moveTo':\r\n                    if (value) {\r\n                        const { xAxis, yAxis } = value\r\n                        View.animate({\r\n                            center: [xAxis, yAxis],\r\n                            zoom: 10,\r\n                            duration: 100,\r\n                        });\r\n                    } else {\r\n                        navigator.geolocation.getCurrentPosition(function (pos) {\r\n                            View.animate({\r\n                                center: [pos.coords.longitude, pos.coords.latitude],\r\n                                zoom: 17,\r\n                                duration: 100,\r\n                            });\r\n                            addPoint(pos.coords.longitude, pos.coords.latitude)\r\n                        })\r\n                    }\r\n                    break;\r\n                case 'fullScreen':\r\n                    let target = document.getElementById(`map${state.targetNum}`)\r\n                    if (target.requestFullscreen) {\r\n                        target.requestFullscreen()\r\n                    } else if (target.msRequestFullscreen) {\r\n                        target.msRequestFullscreen()\r\n                    } else if (target.mozRequestFullScreen) {\r\n                        target.mozRequestFullScreen()\r\n                    } else if (target.webkitRequestFullscreen) {\r\n                        target.webkitRequestFullscreen()\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n\r\n        function layerControl({ action, value }) {\r\n            let target = state.targetNum == 1 ? state.map1 : state.map2\r\n            let targetLayers = target?.getLayers()\r\n            switch (action) {\r\n                case 'layerMode':\r\n                    // needfix: 部落進入layerMode的新增圖層需要重構\r\n                    if (value.checked) {\r\n                        if (value.type === 'tribe') {\r\n                            Object.entries(tribeIdList).forEach((element)=>{\r\n                                getTribeData(element[0]).then((e)=>{\r\n                                    const { lng, lat, tribeName } = e.basicInformation.coordinates.WGS84\r\n                                    const areaLineLayer = new Vector({\r\n                                        name: tribeName,\r\n                                        title: tribeName,\r\n                                        source: new VectorSource({\r\n                                            features: [new Feature({\r\n                                                title: e.basicInformation.tribeName,\r\n                                                type: `tribeFeature`,\r\n                                                tribeValue: element[0],\r\n                                                geometry: new Circle([lng, lat], 0.005),\r\n                                            })],\r\n                                        }),\r\n                                        style: new Style({\r\n                                            fill: new Fill({\r\n                                                color: '#0f9ce2'\r\n                                            }),\r\n                                        })\r\n                                    })\r\n                                    target.addLayer(areaLineLayer)\r\n                                })\r\n                            })\r\n\r\n                            target.on('click', (evt)=>{\r\n                                const feature = state.map1.forEachFeatureAtPixel(evt.pixel, function (feature, layer) {\r\n                                    return feature\r\n                                })\r\n                                if (feature) {\r\n                                    // needfix: 已抓入圖層.需要加入後續事件小視窗及後續另開連結事件\r\n                                    state.areaDataId = feature.get('tribeValue')\r\n                                }\r\n                            })\r\n                            onMapLayerStatus('add', target.getTarget(), value.id)\r\n                        } else {\r\n                            // needFix: 無法刪除全部subNodeIndex圖層\r\n                            if (`${value.nestedSubNodeIndex}`) {\r\n                                let layersAry = targetLayers.getArray()\r\n                                layersAry.forEach(element => {\r\n                                    if(!(element.get('id'))){return}\r\n                                    if (element.get('id').includes(`node${value.nodeIndex}_subNode${value.subNodeIndex}`)) {\r\n                                        target.removeLayer(element)\r\n                                    }\r\n                                })\r\n                                onMapLayerStatus('delete', target.getTarget(), value.id)\r\n                            }\r\n                            let targetLayer = mapLayers.getLayer(state.layers[value.nodeIndex].group_layers[value.subNodeIndex], value.nestedSubNodeIndex, value.id)\r\n                            target.addLayer(targetLayer)\r\n\r\n                            onMapLayerStatus('add', target.getTarget(), value.id)\r\n                        }\r\n\r\n                    } else {\r\n                        if (value.type === 'tribe') {\r\n                            targetLayers.forEach((layer) => {\r\n                                if (layer instanceof Vector) {\r\n                                    layer.getSource().getFeatures().forEach((feature) => {\r\n                                        if (feature.get('type') === 'tribeFeature') {\r\n                                            layer.getSource().removeFeature(feature)\r\n\r\n                                            // needFix: 如果要素存在于地图上，需要更新地图视图\r\n                                            // if (feature.getGeometry()) {\r\n                                            //     map.getView().fit(source.getExtent(), { size: map.getSize() });\r\n                                            // }\r\n                                        }\r\n                                    })\r\n                                }\r\n                            })\r\n\r\n                        } else{\r\n                            // needfix: 刪除部落圖層\r\n                            let layersAry = targetLayers.getArray()\r\n                            layersAry.forEach(element => {\r\n                                if (element.get('id') == value.id) {\r\n                                    target.removeLayer(element)\r\n                                }\r\n                            })\r\n                            onMapLayerStatus('delete', target.getTarget(), value.id)\r\n                        }\r\n                    }\r\n                    break;\r\n                case 'selectLayerMode':\r\n                    if (state.selectLock) { return }\r\n                    if (value.layerName === 'all') {\r\n                        let layersToRemove = []\r\n                        let layersAry = targetLayers.getArray()\r\n                        layersAry.forEach(element => {\r\n                            if (element.get('name') !== 'default') {\r\n                                layersToRemove.push(element)\r\n                            }\r\n                        })\r\n                        layersToRemove.forEach((node) => {\r\n                            target.removeLayer(node)\r\n                        })\r\n                    } else {\r\n                        let layersAry = targetLayers.getArray()\r\n                        layersAry.forEach(element => {\r\n                            if (element.get('id') == value.id) {\r\n                                target.removeLayer(element)\r\n                            }\r\n                        })\r\n                    }\r\n                    break;\r\n                case 'changeOrder':\r\n                    if (state.selectLock) { return }\r\n                    let layeredIndex = mapLayerList.getLayerIndex(value.id)\r\n                    let nowTileLayer = mapLayers.getLayer(state.layers[layeredIndex.nodeIndex].group_layers[layeredIndex.subNodeIndex], layeredIndex.nestedSubNodeIndex, value.id)\r\n                    if (value.movement === 'up') {\r\n                        if (value.key +1 == targetLayers.getArray().length) { return }\r\n                        value.checked = false\r\n                        layerControl({action: 'layerMode', value: value})\r\n                        targetLayers.insertAt(value.key + 1, nowTileLayer)\r\n                    }\r\n                    if (value.movement === 'down') {\r\n                        if (value.key - 1 == 0) { return }\r\n                        value.checked = false\r\n                        layerControl({action: 'layerMode', value: value})\r\n                        targetLayers.insertAt(value.key - 1, nowTileLayer)\r\n                    }\r\n                    break;\r\n                case 'changeLayerVisible':\r\n                    if (state.selectLock) { return }\r\n                    let visibleStatus = !(targetLayers.getArray()[value.key].getVisible())\r\n                    targetLayers.getArray()[value.key].setVisible(visibleStatus)\r\n                    break;\r\n                case 'baseMap':\r\n                    let newTileLayer = baseMaps.sourceFun(value.layerName)\r\n                    targetLayers.extend([newTileLayer])\r\n\r\n                    let layersAry = targetLayers.getArray()\r\n                    layersAry.forEach(element => {\r\n                        if (element.get('name') !== value.layerName) {\r\n                            target.removeLayer(element)\r\n                        }\r\n                    })\r\n                    break;\r\n                case 'changeMapCount':\r\n                    if (state.mapCount === value) { return }\r\n                    let otherMap = state.targetNum !== 1 ? 'map1' : 'map2'\r\n                    state.mapCount = value\r\n                    let otherLayers = state[`${otherMap}LayerStatus`].filter(node => node !== '3D')\r\n                    let otherLayersData = otherLayers.map(item=> mapLayerList.getLayerIndex(item))\r\n                    if (value === 2) {\r\n                        state[otherMap] = new Map({\r\n                            target: otherMap,\r\n                            layers: [\r\n                                baseMapList.sourceFun('default'),\r\n                                ...otherLayersData.map(node => mapLayers.getLayer(state.layers[node.nodeIndex].group_layers[node.subNodeIndex], node.nestedSubNodeIndex, node.id))\r\n                            ],\r\n                            view: defaultView,\r\n                            controls: [],\r\n                        })\r\n                        if (state[`${otherMap}LayerStatus`]?.indexOf('3D') !== -1) {\r\n                            ol3d = new OLCesium({\r\n                                map: state[otherMap],\r\n                            })\r\n                            ol3d.setEnabled(true)\r\n                        }\r\n                    }\r\n                    if (value === 1) {\r\n                        state[otherMap] = null\r\n                        const element = document.getElementById(otherMap)\r\n                        while (element.firstChild) {\r\n                            element.removeChild(element.firstChild)\r\n                        }\r\n                    }\r\n                    break;\r\n                case 'changeDimensionMap':\r\n                    console.log(value)\r\n                    let ta = state.targetNum == 1 ? 'map1' : 'map2'\r\n                    state.dimensionMap[ta] = value\r\n                    if (value === '3D') {\r\n                        ol3d = new OLCesium({\r\n                            map: target,\r\n                        })\r\n                        ol3d.setEnabled(true)\r\n                        state[`${ta}LayerStatus`].push('3D')\r\n                    } else {\r\n                        ol3d.setEnabled(false)\r\n                        state[`${ta}LayerStatus`] = state[`${ta}LayerStatus`].filter(node => node !== '3D')\r\n                    }\r\n                    break;\r\n            }\r\n            getCurrentLayerNames()\r\n        }\r\n\r\n        function changeTarget(value) {\r\n            state.targetNum = value\r\n            let delToMap = state.targetNum !== 1 ? 'map1' : 'map2'\r\n            if (state.mapCount === 1) {\r\n                // 目標地圖為空\r\n                if (!state[`map${value}`]) {\r\n                    let otherLayers = state[`map${value}LayerStatus`].filter(node => node !== '3D')\r\n                    let otherLayersData = otherLayers.map(item=> mapLayerList.getLayerIndex(item))\r\n\r\n                    state[`map${value}`] = new Map({\r\n                        target: `map${value}`,\r\n                        layers: [\r\n                            baseMapList.sourceFun('default'),\r\n                            ...otherLayersData.map(node => mapLayers.getLayer(state.layers[node.nodeIndex].group_layers[node.subNodeIndex], node.nestedSubNodeIndex, node.layeredIndex))\r\n                        ],\r\n                        view: defaultView,\r\n                        controls: [],\r\n                    })\r\n                    if (state[`map${value}LayerStatus`]?.indexOf('3D') !== -1) {\r\n                        ol3d = new OLCesium({\r\n                            map: state[`map${value}`],\r\n                        })\r\n                        ol3d.setEnabled(true)\r\n                    }\r\n\r\n                }\r\n                // 非目標地圖的刪除\r\n                if (state[delToMap]) {\r\n                    state[delToMap] = null\r\n                    const element = document.getElementById(delToMap)\r\n                    while (element.firstChild) {\r\n                        element.removeChild(element.firstChild)\r\n                    }\r\n                }\r\n            }\r\n            nextTick(() => {\r\n                getCurrentLayerNames()\r\n            })\r\n        }\r\n\r\n        function getCurrentLayerNames() {\r\n            // needfix: 修改成可自行加入特定layer\r\n            let target = state.targetNum == 1 ? state.map1 : state.map2\r\n            const layers = target?.getLayers()?.getArray()\r\n            state.currentLayers = layers?.map(layer => {\r\n                return {\r\n                    label: layer.get('label'),\r\n                    id: layer.get('id'),\r\n                    visible: layer.getVisible(),\r\n                }\r\n            })\r\n        }\r\n\r\n        function conditionWrap() {\r\n            state.conditionWrap = !state.conditionWrap\r\n        }\r\n\r\n        function onMapLayerStatus(action, target, id) {\r\n            if (action === 'add') {\r\n                state[`${target}LayerStatus`].push(id)\r\n            } else if (action === 'delete') {\r\n                let a = state[`${target}LayerStatus`].findIndex(node => node === id)\r\n                state[`${target}LayerStatus`].splice(a, 1)\r\n            } else {\r\n                console.log('error')\r\n            }\r\n        }\r\n\r\n        // function closeMapData() {\r\n        //     overlay.value.setPosition(undefined)\r\n        // }\r\n\r\n        // function switchMapDetail(id) {\r\n        //     if (feature) {\r\n        //         const coordinate = evt.coordinate\r\n        //         state.areaDataId = feature.get('name')\r\n        //         overlay.value.setPosition(coordinate)\r\n        //     } else {\r\n        //         overlay.value.setPosition(undefined)\r\n        //     }\r\n        // }\r\n\r\n        function tileLoadFunction(tile, src) {\r\n            var client = new XMLHttpRequest();\r\n            client.open('GET', src);\r\n            //client.setRequestHeader(\"Authorization\", \"Basic \" + window.btoa(user + \":\" + pass));\r\n            client.onload = function () {\r\n                client.setRequestHeader('Content-type','image/png');\r\n                tile.getImage().src = src;\r\n            };\r\n            client.send();\r\n        }\r\n\r\n        function addTest() {\r\n\r\n            const SurfaceSource = new TileWMS({\r\n                maxzoom: 18,\r\n                minzoom: 3,\r\n                url: 'https://dwgis1.ncdr.nat.gov.tw/server/services/MAP0627/Map2022FloodingArea1721/MapServer/WMSServer?REQUEST=GetMap&SERVICE=WMS&BGCOLOR=0xFFFFFF&TRANSPARENT=TRUE&SRS=EPSG:4326&LAYERS=0&VERSION=1.1.1&FORMAT=image/png&STYLES=',\r\n                params: {},\r\n                tileLoadFunction: tileLoadFunction,\r\n            })\r\n            const wmsLayer = new TileLayer({\r\n                source: SurfaceSource,\r\n            })\r\n            state.map1.addLayer(wmsLayer)\r\n            // onMapLayerStatus('add', state.map1.getTarget(), value.layerName)\r\n        }\r\n\r\n        onMounted(async () => {\r\n            await $.ajax({\r\n                url: 'https://api.edtest.site/layers',\r\n                method: \"GET\"\r\n            }).done(res => {\r\n                state.layers = res.map((node, index) => {\r\n                    node.group_layers.forEach((sub, subIndex) => {\r\n                        let subNodeIndex = undefined, nestedSubNodeIndex = undefined\r\n                        subNodeIndex = subIndex\r\n                        sub.id = `node${index}_subNode${subNodeIndex}_nestedSubNode${nestedSubNodeIndex}`\r\n                        if (!(sub.single_tiles)) {\r\n                            sub.tiles_list.forEach((nestedSub, nestedSubIndex)=>{\r\n                                nestedSubNodeIndex = nestedSubIndex\r\n                                nestedSub.id = `node${index}_subNode${subNodeIndex}_nestedSubNode${nestedSubNodeIndex}`\r\n                            })\r\n                        }\r\n                    })\r\n                    return {\r\n                        ...node,\r\n                        value: index,\r\n                    }\r\n                })\r\n                nextTick(()=>{\r\n                    // async ()\r\n                    initMap()\r\n                    getCurrentLayerNames()\r\n                })\r\n            }).fail(FailMethod => {\r\n                console.log('Fail', FailMethod)\r\n            })\r\n        })\r\n\r\n        return {\r\n            state,\r\n            props,\r\n            areaCom,\r\n            overlay,\r\n            tribeIdList,\r\n            mapControl,\r\n            layerControl,\r\n            getCurrentLayerNames,\r\n            changeTarget,\r\n            conditionWrap,\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<template>\r\n    <div>\r\n        <div class=\"SearchBar position-absolute\">\r\n            <img src=\"@/assets/logo.svg\" alt=\"\" class=\"mb-2\">\r\n            <SearchBar :dimensionMapStatus=\"state.toSearchDimensionStatus\" :currentLayers=\"state.currentLayers\"\r\n                :mapCount=\"state.mapCount\" @onLayerControl=\"({ action, value }) => { layerControl({ action, value }) }\"\r\n                @onChangeTarget=\"(value) => { changeTarget(value) }\" @conditionWrap=\"(value) => { conditionWrap(value) }\" />\r\n        </div>\r\n        <mapSourceOption\r\n        class=\"mapSourceOption\"\r\n        :baseMapsOptions=\"state.baseMapsOptions\"\r\n        @onChangeBaseMaps=\"({ action, value }) => { layerControl({ action, value }) }\" />\r\n\r\n        <asideTool\r\n        class=\"asideTool position-absolute top-50 translate-middle-y\" id=\"asideTool\"\r\n        @onMapControl=\"({ action, value }) => { mapControl({ action, value }) }\" />\r\n\r\n        <div class=\"w-100 d-flex flex-nowrap mapWrap\" id=\"mapWrap\">\r\n            <!-- needFix 寬度設定是否調整 -->\r\n            <div id=\"map1\" :class=\"{ 'w-100': state.map1?.getTarget() == 'map1' }\"></div>\r\n            <div class=\"middleLine\" v-if=\"state.mapCount === 2\"></div>\r\n            <div id=\"map2\" :class=\"{ 'w-100': state.map2?.getTarget() == 'map2' }\"></div>\r\n        </div>\r\n        <div class=\"condition position-absolute\">\r\n            <div class=\"mb-2\">\r\n                <button class=\"border-0 w-100 rounded-4 bg-steel text-white text-center p-2 fw-bold fs-5\"\r\n                    v-if=\"!state.conditionWrap\" @click=\"state.conditionWrap = true\">\r\n                    圖層選項\r\n                </button>\r\n                <div class=\"mb-4\" v-if=\"state.conditionWrap\">\r\n                    <condition\r\n                    v-bind=\"{\r\n                        mapLayers: state.mapLayers,\r\n                        currentLayers: state.currentLayers,\r\n                        tribeIdList: tribeIdList,\r\n                        onClose: () => {\r\n                            state.conditionWrap = false\r\n                        }\r\n                    }\"\r\n                    @onMapControl=\"({ action, value }) => { mapControl({ action, value }) }\"\r\n                    @onLayerControl=\"({ action, value }) => { layerControl({ action, value }) }\" />\r\n                    <!-- need continue -->\r\n                </div>\r\n            </div>\r\n\r\n            <div>\r\n                <button class=\"border-0 w-100 rounded-4 bg-steel text-white text-center p-2 fw-bold fs-5\"\r\n                    v-if=\"!state.layerSelect\" @click=\"state.layerSelect = true\">\r\n                    已選擇的圖層\r\n                </button>\r\n                <div v-if=\"state.layerSelect\">\r\n                    <layerSelect v-bind=\"{\r\n                        selectLock: state.selectLock,\r\n                        currentLayers: state.currentLayers,\r\n                        onClose: () => {\r\n                            state.layerSelect = false\r\n                        },\r\n                        onChangLayerVisible: (action) => {\r\n                            layerControl(action)\r\n                        },\r\n                        onChangeOrderLayer: ({ action, value }) => {\r\n                            layerControl({ action, value })\r\n                        },\r\n                        onLockLayer: () => {\r\n                            state.selectLock = !state.selectLock\r\n                        },\r\n                        onDeleteLayer: ({ action, value }) => {\r\n                            if (value.layerName == 'all') {\r\n                                state.deleteLightbox = true\r\n                            } else {\r\n                                layerControl({ action, value })\r\n                            }\r\n                        },\r\n                        onDeleteLayerAll: () => {\r\n                            state.deleteLightbox = true\r\n                        }\r\n                    }\" />\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"lightWrap w-100 h-100 d-flex justify-content-center align-items-center\" v-if=\"state.deleteLightbox\">\r\n            <div class=\"p-4 rounded bg-white\" style=\"width: 250px;\">\r\n                <p class=\"text-center fw-bold\">是否要刪除全部圖層</p>\r\n                <div class=\" d-flex justify-content-around\">\r\n                    <button class=\"rounded px-3 py-1 bg-steel text-white border-0\" @click=\"() => {\r\n                        layerControl({\r\n                            action: 'selectLayerMode',\r\n                            value: {\r\n                                layerName: 'all'\r\n                            }\r\n                        })\r\n                        state.deleteLightbox = false\r\n                    }\">確定</button>\r\n                    <button class=\"rounded px-3 py-1 bg-secondary bg-gradient text-white border-0\" @click=\"() => {\r\n                        state.deleteLightbox = false\r\n                    }\">取消</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- 地圖細節小窗 -->\r\n        <div ref=\"areaCom\" class=\"areaData\" v-if=\"state.areaDataId\">\r\n            <areaData :id=\"state.areaDataId\" />\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<style lang=\"sass\">\r\n@import '@/assets/styles/all.module.scss'\r\n.mapWrap\r\n    justify-content: space-between\r\n    height: 100vh\r\n\r\n.mapWrap .ol-viewport\r\n    height: 100vh\r\n    width: 100vw\r\n\r\n\r\n.asideTool\r\n    z-index: 220\r\n    left: 5px\r\n.SearchBar\r\n    position: absolute\r\n    top: 20px\r\n    left: 20px\r\n    z-index: 220\r\n.condition\r\n    width: 480px\r\n    right: 1%\r\n    bottom: 5%\r\n\r\n.mapSourceOption\r\n    position: fixed\r\n    top: 20px\r\n    right: 20px\r\n    z-index: 220\r\n\r\n.middleLine\r\n    width: 5px\r\n    background: $blue-steel\r\n\r\n\r\n.areaData\r\n    width: 450px\r\n    background: #fff\r\n    position: absolute\r\n    top: 0\r\n    right: 0\r\n    box-sizing: border-box\r\n    padding: 10px\r\n</style>\r\n"],"names":["Cluster","VectorSource","options","feature","geometry","assert","fast","extent","resolution","projection","distance","minDistance","source","EventType","ratio","changed","createEmpty","mapDistance","features","clustered","i","ii","getUid","coordinates","createOrUpdateFromCoordinate","buffer","neighbors","neighbor","uid","centroid","addCoordinate","scaleCoordinate","searchCenter","getCenter","Point","Feature","olSourceCluster","TileArcGISRest","TileImage","res","key","tileCoord","tileSize","tileExtent","pixelRatio","params","urls","srid","url","index","modulo","tileCoordHash","modifiedUrl","appendParams","tileGrid","toSize","scaleSize","baseParams","TileArcGISRest$1","JSONFeature","FeatureFormat","getObject","object","abstract","JSONFeature$1","GEOMETRY_READERS","readPointGeometry","readLineStringGeometry","readPolygonGeometry","readMultiPointGeometry","readMultiLineStringGeometry","readMultiPolygonGeometry","GEOMETRY_WRITERS","writePointGeometry","writeLineStringGeometry","writePolygonGeometry","writeMultiPointGeometry","writeMultiLineStringGeometry","writeMultiPolygonGeometry","EsriJSON","idField","esriJSONFeature","readGeometry","id","esriJSONFeatureSet","esriJSONFeatures","crs","getProjection","writeGeometry","properties","isEmpty","objects","type","esriJSONPolygon","layout","getGeometryLayout","rings","convertRings","geometryReader","transformGeometryWithOptions","flatRing","outerRings","holes","deflateCoordinates","linearRingIsClockwise","hole","matched","outerRing","containsExtent","LinearRing","point","LineString","MultiLineString","MultiPoint","MultiPolygon","Polygon","esriJSON","getHasZM","lineString","hasZM","polygon","multiLineString","multiPoint","output","x","geometryWriter","EsriJSON$1","tribeIdList","getTribeData","tribeId","$","FailMethod","mapLayerList","TileLayer","serviceUrl","style","Style","Fill","Stroke","newVectorSource","tileStrategy","createXYZ","VectorLayer","color","circleFeature","Circle","circleStyle","state","y","x1","y1","ctx","dx","dy","radius","raster","areaLineLayer","Vector","layer","nestedSubNodeIndex","result","layerSource","layerType","figureType","request","sub","node","subNode","TileWMS","tileTitle","_a","wmsSource","layeredIndex","nodeIndex","subNodeIndex","element","_imports_0$3","_imports_1$2","_sfc_main","props","emit","reactive","watch","onMounted","_hoisted_1","_hoisted_4","_hoisted_5","_withScopeId","_createElementVNode","_hoisted_6","_imports_1","_hoisted_8","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_15","_openBlock","_createElementBlock","_toDisplayString","$setup","_d","_c","_b","_j","_i","_h","_hoisted_9","_Fragment","_renderList","_v","_u","item","_hoisted_14","_hoisted_16","_hoisted_2","_hoisted_3","_hoisted_7","_hoisted_13","_cache","_withModifiers","args","_normalizeClass","onMapControl","action","value","onLayerControl","LayerCheckBoxChange","e","defaultChecked","checkTribe","router","mapLayers","_hoisted_20","_hoisted_21","_createTextVNode","$event","_hoisted_18","_vModelSelect","_imports_0$2","_imports_1$1","_imports_2$1","_imports_3$1","_imports_4$1","_imports_0","_imports_2","_imports_3","_imports_4","onChangeBaseMaps","name","node_i","_imports_0$1","toolSwitch","target","AutoRenderLoop","ol3d","repaintKey","toDegrees","angleInRadians","toRadians","angleInDegrees","Camera","scene","map","input","opt_output","opt_dimension","dim","view","olObservableUnByKey","toLonLat","getTransform","fromLonLat","heading","tilt","center","position","ll","carto","pos","altitude","height","destination","orientation","ellipsoid","olcsCore","bestTarget","globe","bestTargetCartographic","targetNormal","targetToCamera","up","right","normal","tiltAngle","opt_dontSync","old","current","latitude","calcDistanceForResolution","calcResolutionForDistance","AbstractSynchronizer","root","fifo","olLayerWithParents","olLayer","olLayerId","cesiumObjects","olLayerGroup","l","newOlLayerWithParents","layerId","layerWithParents","onLayerChange","cesiumObjs","olcsListen","cesiumObject","counterparts","counterpart","group","done","uuid","listenKeyArray","contentKeys","listenAddRemove","collection","event","el","objKey","destroy","RasterSynchronizer","olcsAbstractSynchronizer","viewProj","olLayerItem","previousStyleFunction","currentStyleFunction","csObj","layers","zIndices","queue","sublayers","stableSort","layer1","layer2","VectorLayerCounterpart","layerProjection","billboards","primitives","FeatureConverter","evt","olSourceVector","cancellers","olcsUtil","canceller","primitive","olGeometry","opt_lineWidth","createInstance","instance","instances","heightReference","ctor","dataUri","outline","fillColor","strokeColor","olColor","width","fillGeometry","outlineGeometry","olStyle","outlineColor","p1","p2","text","label","bbOptions","bb","outlinePrimitive","circlePolygon","olCreateCircularPolygon","positions","isGroundPolylinePrimitiveSupported","geometryInstances","previousDistance","geometryOptions","linePositions","appearance","primitiveOptions","boundingExtent","rectangle","maxHeight","c","hierarchy","polygonHierarchy","olPos","polylineGeometry","altitudeMode","imageStyle","opt_newBillboardCallback","olStyleIcon","image","isImageLoaded","reallyCreateBillboard","opacity","scale","anchor","cancelled","fuid","listener","modelPrimitive","olcsModelFunction","olcsModel","model","accumulate","geometries","functor","subgeos","labels","extentCenter","olGeomSimpleGeometry","first","offsetX","offsetY","offset","labelStyle","horizontalOrigin","verticalOrigin","fill","stroke","fallbackStyleFunction","featureStyleFunction","opt_geom","geom3d","olGeomGeometry","geomFuncRes","context","geom","proj","newBillboardAddedCallback","featureBb","prims","bbs","result2","olView","featurePrimitiveMap","olcsCoreVectorLayerCounterpart","layerStyle","styles","prim","VectorSynchronizer","opt_converter","olcsFeatureConverter","csPrimitive","visible","layerVisible","olLayerVector","olLayerVectorTile","olLayerLayer","csPrimitives","olListenKeys","onAddFeature","olLayerImage","onRemoveFeature","SynchronizedOverlay","olOverlay","parent","setPropertyFromEvent","observer","removeNode","container","sourceProjection","transform","cloneNode","clone","nodes","removeChildren","clonedNode","globeHeight","cartesian","camera","ellipsoidBoundingSphere","pixelCartesian","pixel","mapSize","OverlaySynchronizer","overlay","cesiumOverlay","olcsSynchronizedOverlay","overlayId","removedOverlay","csOverlay","OLCesium","fillArea","containerAttribute","targetElement","overlayEvents","canvasAttribute","sceneOptions","sscc","olcsCamera","firstImageryProvider","synchronizers","olcsRasterSynchronizer","olcsVectorSynchronizer","olcsOverlaySynchronizer","frameTime","interval","julianDate","trackedEntity","bs","resolutionScale","enable","interactions","arr","interaction","rootGroup","timeout","csCamera","block","olcsAutoRenderLoop","to4326Transform","toCesiumPosition","olGeomPoint","coo","coo4326","time","computed","ref","initMap","areaCom","Map","baseMapList","defaultView","addPoint","targetLng","targetLat","Icon","mapControl","View","mainMap","xAxis","yAxis","layerControl","targetLayers","tribeName","lng","lat","targetLayer","layersToRemove","nowTileLayer","visibleStatus","newTileLayer","otherMap","otherLayersData","ta","getCurrentLayerNames","delToMap","onMapLayerStatus","a","subIndex","nestedSubIndex","nestedSub","_createVNode","_component_condition","_mergeProps"],"mappings":"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","x_google_ignoreList":[0,1,2,3,23,24,25,26,27,28,29,30,31,32,33]}