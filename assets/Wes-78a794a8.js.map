{"version":3,"file":"Wes-78a794a8.js","sources":["../../node_modules/ol/source/OSM.js","../../src/view/Wes.vue"],"sourcesContent":["/**\n * @module ol/source/OSM\n */\n\nimport XYZ from './XYZ.js';\n\n/**\n * The attribution containing a link to the OpenStreetMap Copyright and License\n * page.\n * @const\n * @type {string}\n * @api\n */\nexport const ATTRIBUTION =\n  '&#169; ' +\n  '<a href=\"https://www.openstreetmap.org/copyright\" target=\"_blank\">OpenStreetMap</a> ' +\n  'contributors.';\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions] Attributions.\n * @property {number} [cacheSize] Initial tile cache size. Will auto-grow to hold at least the number of tiles in the viewport.\n * @property {null|string} [crossOrigin='anonymous'] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you want to access pixel data with the Canvas renderer.\n * See https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image for more detail.\n * @property {boolean} [interpolate=true] Use interpolated values when resampling.  By default,\n * linear interpolation is used when resampling.  Set to false to use the nearest neighbor instead.\n * @property {number} [maxZoom=19] Max zoom.\n * @property {boolean} [opaque=true] Whether the layer is opaque.\n * @property {number} [reprojectionErrorThreshold=0.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {import(\"../Tile.js\").LoadFunction} [tileLoadFunction] Optional function to load a tile given a URL. The default is\n * ```js\n * function(imageTile, src) {\n *   imageTile.getImage().src = src;\n * };\n * ```\n * @property {number} [transition=250] Duration of the opacity transition for rendering.\n * To disable the opacity transition, pass `transition: 0`.\n * @property {string} [url='https://tile.openstreetmap.org/{z}/{x}/{y}.png'] URL template.\n * Must include `{x}`, `{y}` or `{-y}`, and `{z}` placeholders.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n * @property {number|import(\"../array.js\").NearestDirectionFunction} [zDirection=0]\n * Choose whether to use tiles with a higher or lower zoom level when between integer\n * zoom levels. See {@link module:ol/tilegrid/TileGrid~TileGrid#getZForResolution}.\n */\n\n/**\n * @classdesc\n * Layer source for the OpenStreetMap tile server.\n * @api\n */\nclass OSM extends XYZ {\n  /**\n   * @param {Options} [options] Open Street Map options.\n   */\n  constructor(options) {\n    options = options || {};\n\n    let attributions;\n    if (options.attributions !== undefined) {\n      attributions = options.attributions;\n    } else {\n      attributions = [ATTRIBUTION];\n    }\n\n    const crossOrigin =\n      options.crossOrigin !== undefined ? options.crossOrigin : 'anonymous';\n\n    const url =\n      options.url !== undefined\n        ? options.url\n        : 'https://tile.openstreetmap.org/{z}/{x}/{y}.png';\n\n    super({\n      attributions: attributions,\n      attributionsCollapsible: false,\n      cacheSize: options.cacheSize,\n      crossOrigin: crossOrigin,\n      interpolate: options.interpolate,\n      maxZoom: options.maxZoom !== undefined ? options.maxZoom : 19,\n      opaque: options.opaque !== undefined ? options.opaque : true,\n      reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n      tileLoadFunction: options.tileLoadFunction,\n      transition: options.transition,\n      url: url,\n      wrapX: options.wrapX,\n      zDirection: options.zDirection,\n    });\n  }\n}\n\nexport default OSM;\n","<template>\r\n    <button @click=\"show()\">show</button>\r\n    <button @click=\"add()\">add</button>\r\n    <!-- 地图容器 -->\r\n    <div id=\"map\" class=\"map__x\" ref=\"mapCom\"></div>\r\n</template>\r\n\r\n<script setup>\r\nimport { useSlots, onBeforeMount, onMounted, onBeforeUnmount, ref, reactive, computed, watch, nextTick, defineAsyncComponent, useCssModule, inject, getCurrentInstance } from 'vue'\r\nimport $ from 'jquery'\r\nimport { Map, View } from 'ol' // 引入容器绑定模块和视图模块\r\nimport XYZ from 'ol/source/XYZ' // 引入XYZ地图格式\r\nimport Overlay from 'ol/Overlay'// 引入覆盖物模块\r\nimport 'ol/ol.css' // ol提供的css样式（必须引入）\r\nimport { ImageArcGISRest, OSM } from 'ol/source.js'\r\nimport VectorTileLayer from 'ol/layer/VectorTile.js'\r\nimport VectorTileSource from 'ol/source/VectorTile.js'\r\nimport TileGrid from 'ol/tilegrid/TileGrid.js'\r\nimport GeoJSON from 'ol/format/GeoJSON.js'\r\nimport ImageWMS from 'ol/source/ImageWMS.js'\r\n\r\nimport VectorSource from 'ol/source/Vector.js'\r\nimport { Fill, Stroke, Style, Icon } from 'ol/style.js'\r\nimport { Tile, Tile as TileLayer, Image as ImageLayer, Vector, Vector as VectorLayer } from 'ol/layer.js'\r\nimport TileWMS from 'ol/source/TileWMS'\r\nimport proj4 from 'proj4';\r\n\r\nimport { createXYZ } from 'ol/tilegrid.js'\r\nimport { getCenter, getWidth } from 'ol/extent.js'\r\nimport { get as getProjection, transformExtent, fromLonLat } from 'ol/proj.js'\r\nimport { register } from 'ol/proj/proj4.js'\r\nimport { transform } from 'ol/proj.js'\r\n\r\n\r\nproj4.defs(\r\n  'EPSG:3826',\r\n  '+proj=tmerc +lat_0=0 +lon_0=121 +k=0.9999 +x_0=250000 +y_0=0 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs +type=crs'\r\n);\r\nregister(proj4);\r\n\r\nconst mapCom = ref(null) // 地图容器\r\nconst map = ref(null) // 地图实例\r\n\r\n\r\nconst aLayer = new Tile({\r\n    preload: Infinity,\r\n    source: new XYZ({\r\n        url: 'https://wmts.nlsc.gov.tw/wmts/EMAP5/default/EPSG:3857/{z}/{y}/{x}'\r\n    }),\r\n    crossOrigin: 'anonymous',\r\n})\r\n\r\nconst newLayer = new TileLayer({\r\n    source: new TileWMS({\r\n        name: '順向坡分布',\r\n        url: 'https://dwgis1.ncdr.nat.gov.tw/server/services/MAP0627/Map2022EGDebrisSlide/MapServer/WMSServer',\r\n        params: {\r\n            'REQUEST': 'GetMap',\r\n            'SERVICE': 'WMS',\r\n            'VERSION': '1.1.1',\r\n            'LAYERS': '2',\r\n            'STYLES': '',\r\n            'FORMAT': 'image/png',\r\n            'BGCOLOR': '0xFFFFFF',\r\n            'TRANSPARENT': 'TRUE',\r\n            'SRS': 'EPSG:3826'\r\n        },\r\n        crossOrigin: 'anonymous',\r\n        projection: 'EPSG:3826',\r\n    }),\r\n})\r\n\r\nconst bLayer = new TileLayer({\r\n    source: new TileWMS({\r\n        // projection: 'EPSG:3857', // here is the source projection\r\n        url: 'https://ahocevar.com/geoserver/wms',\r\n        params: {\r\n            'LAYERS': 'ne:NE1_HR_LC_SR_W_DR',\r\n        },\r\n    }),\r\n})\r\n\r\nconst area = reactive({\r\n  India: [68.17665, 7.96553, 97.40256, 35.49401],\r\n  Argentina:[-73.41544, -55.25, -53.62835, -21.83231],\r\n  Nigeria: [2.6917, 4.24059, 14.57718, 13.86592],\r\n  Sweden: [11.02737, 55.36174, 23.90338, 69.10625],\r\n  Taiwan: [119.5, 20.5, 124.5, 25.5], // 台湾的 Extent\r\n})\r\n\r\n// 初始化地图\r\nfunction initMap() {\r\n    map.value = new Map({\r\n        extent: area.Taiwan,\r\n        target: mapCom.value,\r\n        layers: [\r\n            new TileLayer({\r\n                preload: Infinity,\r\n                source: new OSM(),\r\n            }),\r\n            // newLayer\r\n        ],\r\n        view: new View({\r\n            projection: 'EPSG:4326',\r\n            center: [120.41670777208755, 24.197957034875305],\r\n            zoom: 10,\r\n        }),\r\n    })\r\n}\r\n\r\nfunction show() {\r\n    // 获取图层的数据源\r\n    console.log(map.value.getLayers().getArray())\r\n    const source = map.value.getLayers().getArray();\r\n    // 获取图层的投影属性\r\n    const projection = source[1].getSource();\r\n\r\n    console.log(projection);\r\n}\r\n// features: (new GeoJSON({\r\n//     dataProjection: 'EPSG:3826',\r\n//     featureProjection: map.value.getView().getProjection(),\r\n// })).readFeatures(geojsonObject)\r\n// features: (new GeoJSON()).readFeatures(geojsonObject, {\r\n//     dataProjection: 'EPSG:3006',\r\n//     featureProjection: map.getView().getProjection()\r\n// })\r\n\r\n\r\nfunction add() {\r\n    map.value.addLayer(newLayer)\r\n}\r\n\r\nonMounted(() => {\r\n    // 在元素加载完之后再执行地图初始化\r\n    initMap()\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.map__x {\r\n    width: 100vw;\r\n    height: 100vh;\r\n    border: 1px solid #eee;\r\n}\r\n\r\n.popup {\r\n    width: 300px;\r\n    height: 100px;\r\n    background: #fff;\r\n    position: absolute;\r\n    top: -115px;\r\n    left: -150px;\r\n    box-sizing: border-box;\r\n    padding: 10px;\r\n\r\n    &::after {\r\n        content: '';\r\n        display: block;\r\n        position: absolute;\r\n        width: 20px;\r\n        height: 20px;\r\n        background: #fff;\r\n        bottom: -10px;\r\n        left: 50%;\r\n        transform: translateX(-50%) rotate(45deg);\r\n    }\r\n\r\n    .icon-close {\r\n        position: absolute;\r\n        top: 0px;\r\n        right: 8px;\r\n        cursor: pointer;\r\n    }\r\n\r\n    .content {\r\n        margin-top: 14px;\r\n    }\r\n}\r\n</style>\r\n"],"names":["ATTRIBUTION","OSM","XYZ","options","attributions","crossOrigin","url","OSM$1","proj4","register","mapCom","ref","map","Tile","newLayer","TileLayer","TileWMS","area","reactive","initMap","Map","View","show","projection","add","onMounted"],"mappings":"kLAaO,MAAMA,EACX,2GAsCF,MAAMC,UAAYC,CAAI,CAIpB,YAAYC,EAAS,CACnBA,EAAUA,GAAW,GAErB,IAAIC,EACAD,EAAQ,eAAiB,OAC3BC,EAAeD,EAAQ,aAEvBC,EAAe,CAACJ,CAAW,EAG7B,MAAMK,EACJF,EAAQ,cAAgB,OAAYA,EAAQ,YAAc,YAEtDG,EACJH,EAAQ,MAAQ,OACZA,EAAQ,IACR,iDAEN,MAAM,CACJ,aAAcC,EACd,wBAAyB,GACzB,UAAWD,EAAQ,UACnB,YAAaE,EACb,YAAaF,EAAQ,YACrB,QAASA,EAAQ,UAAY,OAAYA,EAAQ,QAAU,GAC3D,OAAQA,EAAQ,SAAW,OAAYA,EAAQ,OAAS,GACxD,2BAA4BA,EAAQ,2BACpC,iBAAkBA,EAAQ,iBAC1B,WAAYA,EAAQ,WACpB,IAAKG,EACL,MAAOH,EAAQ,MACf,WAAYA,EAAQ,UAC1B,CAAK,CACF,CACH,CAEA,MAAAI,EAAeN,iCC1DfO,EAAA,KACA,YACA,8HACA,EACAC,EAAAD,CAAA,EAEA,MAAAE,EAAAC,EAAA,IAAA,EACAC,EAAAD,EAAA,IAAA,EAGA,IAAAE,EAAA,CACA,QAAA,IACA,OAAA,IAAAX,EAAA,CACA,IAAA,mEACA,CAAA,EACA,YAAA,WACA,CAAA,EAEA,MAAAY,EAAA,IAAAC,EAAA,CACA,OAAA,IAAAC,EAAA,CACA,KAAA,QACA,IAAA,kGACA,OAAA,CACA,QAAA,SACA,QAAA,MACA,QAAA,QACA,OAAA,IACA,OAAA,GACA,OAAA,YACA,QAAA,WACA,YAAA,OACA,IAAA,WACA,EACA,YAAA,YACA,WAAA,WACA,CAAA,CACA,CAAA,EAEA,IAAAD,EAAA,CACA,OAAA,IAAAC,EAAA,CAEA,IAAA,qCACA,OAAA,CACA,OAAA,sBACA,CACA,CAAA,CACA,CAAA,EAEA,MAAAC,EAAAC,EAAA,CACA,MAAA,CAAA,SAAA,QAAA,SAAA,QAAA,EACA,UAAA,CAAA,UAAA,OAAA,UAAA,SAAA,EACA,QAAA,CAAA,OAAA,QAAA,SAAA,QAAA,EACA,OAAA,CAAA,SAAA,SAAA,SAAA,QAAA,EACA,OAAA,CAAA,MAAA,KAAA,MAAA,IAAA,CACA,CAAA,EAGA,SAAAC,GAAA,CACAP,EAAA,MAAA,IAAAQ,EAAA,CACA,OAAAH,EAAA,OACA,OAAAP,EAAA,MACA,OAAA,CACA,IAAAK,EAAA,CACA,QAAA,IACA,OAAA,IAAAd,CACA,CAAA,CAEA,EACA,KAAA,IAAAoB,EAAA,CACA,WAAA,YACA,OAAA,CAAA,mBAAA,kBAAA,EACA,KAAA,EACA,CAAA,CACA,CAAA,CACA,CAEA,SAAAC,GAAA,CAEA,QAAA,IAAAV,EAAA,MAAA,UAAA,EAAA,UAAA,EAGA,MAAAW,EAFAX,EAAA,MAAA,UAAA,EAAA,SAAA,EAEA,CAAA,EAAA,UAAA,EAEA,QAAA,IAAAW,CAAA,CACA,CAWA,SAAAC,GAAA,CACAZ,EAAA,MAAA,SAAAE,CAAA,CACA,CAEA,OAAAW,EAAA,IAAA,CAEAN,EAAA,CACA,CAAA","x_google_ignoreList":[0]}