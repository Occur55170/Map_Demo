{"version":3,"file":"opp-04b85d84.js","sources":["../../src/components/opp.vue"],"sourcesContent":["<script>\r\nimport { onMounted, ref, nextTick } from 'vue'\r\n\r\nimport { Map, View, Feature } from 'ol'\r\nimport 'ol/ol.css'\r\nimport { OSM } from 'ol/source.js'\r\nimport { Tile, Tile as TileLayer, Image as ImageLayer, Vector, Vector as VectorLayer } from 'ol/layer.js'\r\n\r\nimport baseMapList, { getBaseMapAll } from '@/config/baseMapList'\r\nimport { toPng } from \"html-to-image\"\r\nimport ImageStatic from 'ol/source/ImageStatic'\r\nimport TileWMS from 'ol/source/TileWMS'\r\nimport ImageWMS from 'ol/source/ImageWMS'\r\nimport { Circle, Polygon, Point } from 'ol/geom.js'\r\nimport XYZ from 'ol/source/XYZ'\r\nimport VectorSource from 'ol/source/Vector.js'\r\nimport { Icon, Fill, Stroke, Style } from 'ol/style.js'\r\n\r\nexport default {\r\n    props: {\r\n    },\r\n    setup(props, { emit }) {\r\n        let map\r\n        onMounted(async () => {\r\n            console.log(1)\r\n            map = new Map({\r\n                target: 'map',\r\n                layers: [\r\n                    new TileLayer({\r\n                        source: new OSM(),\r\n                    }),\r\n                    new TileLayer({\r\n                        title: '网格',\r\n                        source: new XYZ({\r\n                        visible: true,\r\n                        wrapX: true,\r\n                        url: 'http://t4.tianditu.com/DataServer?T=vec_w&x={x}&y={y}&l={z}&tk=49ea1deec0ffd88ef13a3f69987e9a63'\r\n                        })\r\n                    }),\r\n                ],\r\n                view: new View({\r\n                    projection: 'EPSG:4326',\r\n                    center: [121.326776, 24.655499],\r\n                    zoom: 9,\r\n                }),\r\n            })\r\n            addGif()\r\n        })\r\n\r\n        function addGif() {\r\n            const iconFeature = new Feature({\r\n                geometry: new Point([121.326776, 24.655499])\r\n            })\r\n\r\n            const vectorSource = new VectorSource({\r\n                features: [iconFeature]\r\n            })\r\n\r\n            const vectorLayer = new VectorLayer({\r\n                source: vectorSource\r\n            })\r\n            // 'https://openlayers.org/en/latest/examples/data/globe.gif'\r\n            // let url = 'https://openlayers.org/en/latest/examples/data/globe.gif'\r\n            let url = 'https://s3.ap-northeast-1.amazonaws.com/common.cwb.images/ncdr/forecast.png?AWSAccessKeyId=ASIAU6XV5PTRE2KIBH4U&Signature=RcnrEKAGbyjgQ3fPd603Ka9m3dk%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEKv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaDmFwLW5vcnRoZWFzdC0xIkcwRQIgNI3dIZR9iY6vHTC8hZo%2FPiW%2FzTUY4%2F3gVpw43zzom8ICIQDPWXFI8%2BxBtv9uLs4GAfK%2B9jbMr2BJjUFfUJnXjfGImCr5Agg0EAAaDDM0MDg5MTg5Mjk2MiIMSZroc7%2F2rZ%2BU5BjoKtYCfkvoSF5CQc2o8AYjfYDSb1wOzy9vAlu4heZCKlkE3R%2Bme8i2fQ2GOu%2Ftu02shIxbfnECm%2Fq0RqZHYsJmR%2BGUyYblZIyRQwkY3PCrN8ZmY0iiilDXJdr5xILEwSFS05bFntZk6VSYaZXpKW1buf8uGnT2wAR9uJ6525PH2HUSxI8t%2B6Ydlg%2BL9CFjlsjHPggp4mel4M2oCapWIEPybU0jreqd5Tq08mD9wGQyuDqNxTrnA8WGG56Jnpat2aKFgo9OrpV4ToLm2aiWkiQcBBFa4OZY8ImLEbLRn4wDC%2BM9cd%2BPzXh%2BB8K2%2F37bbD7OpwAbd%2BPuWP55nUTz1CXyjOJ0A5s3Mw0szPW2A6R%2FM%2BOKI1In%2B1A2LWxfcqQ6qJV5fhQGqiXj1GvladK8WA74oNZdXfMve0lE53R%2FTrrPbtkR5ox6WRcZvvPVqG7S%2BRhFIa2XpEY%2F%2BDSKMI%2Fcy6UGOp4BtdQiqoKXWK3mmCaZnHXgv8aw81%2BYRTmZBTXiKyLmHNkmIJrIh2bL1z5td14d0nmmItwv5Son%2FOtLRAWbctsPtvt8Vm9N938G3CL%2F5tL58iAt9me97s45jK6KHCqA2ob4TB1VXms%2BjhQMdOwY9fzQtSgVvkEESCVbfa27dsN9HvnB2toE4w4wj%2BZmBb6nfb6Yk9EGLDN3zA8URaUW0lI%3D&Expires=1689448552'\r\n            gifler(url).frames(\r\n                document.createElement('canvas'),\r\n                (ctx, frame) => {\r\n                    if (!iconFeature.getStyle()) {\r\n                        iconFeature.setStyle(\r\n                            new Style({\r\n                                image: new Icon({\r\n                                    img: ctx.canvas,\r\n                                    imgSize: [frame.width, frame.height],\r\n                                    opacity: 0.8\r\n                                })\r\n                            })\r\n                        )\r\n                    }\r\n                    ctx.clearRect(0, 0, frame.width, frame.height)\r\n                    ctx.drawImage(frame.buffer, frame.x, frame.y)\r\n                    map.render()\r\n                },\r\n                true\r\n            )\r\n            map.addLayer(vectorLayer)\r\n        }\r\n\r\n\r\n        return {\r\n            map,\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<template>\r\n    <div id=\"map\"></div>\r\n</template>\r\n\r\n<style lang=\"sass\" scoped>\r\n#imgMap\r\n    width: 100vw\r\n    height: 1000px\r\n</style>"],"names":["_sfc_main","props","emit","onMounted","OSM","XYZ","addGif","Point","vectorSource","VectorSource","iconFeature","vectorLayer","VectorLayer","url","Style","Icon","ctx","frame","map","_hoisted_1","_openBlock","_createElementBlock"],"mappings":"iNAkBA,MAAAA,EAAA,CACI,MAAA,GAEA,MAAAC,EAAA,CAAA,KAAAC,GAAA,OAEIC,EAAA,SAAA,sCAIQ,OAAA,QAEQ,OAAA,IAAAC,CACJ,CAAA,oBAGI,OAAA,IAAAC,EAAA,4HAKJ,CAAA,oEAKA,KAAA,CACJ,CAAA,IAEJC,EAAA,IAGJ,SAAAA,GAAA,gBAEQ,SAAA,IAAAC,EAAA,CAAA,WAAA,SAAA,CAAA,IAGJC,EAAA,IAAAC,EAAA,CACI,SAAA,CAAAC,CAAA,IAGJC,EAAA,IAAAC,EAAA,CACI,OAAAJ,IAIJ,IAAAK,EAAA,woCACA,OAAAA,CAAA,EAAA,OACI,SAAA,cAAA,QAAA,wBAGQH,EAAA,SACI,IAAAI,EAAA,CACI,MAAA,IAAAC,EAAA,CACI,IAAAC,EAAA,OACA,QAAA,CAAAC,EAAA,MAAAA,EAAA,MAAA,gBAIZ,EAEJD,EAAA,UAAA,EAAA,EAAAC,EAAA,MAAAA,EAAA,MAAA,EACAD,EAAA,UAAAC,EAAA,OAAAA,EAAA,EAAAA,EAAA,CAAA,cAGJ,EACJ,eAEJ,CAGA,MAAA,CACI,IAAAC,CACJ,CACJ,CACJ,EAISC,EAAA,CAAA,GAAA,KAAA,0BAAL,OAAAC,EAAA,EAAAC,EAAA,MAAAF,CAAA"}